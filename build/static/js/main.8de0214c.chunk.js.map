{"version":3,"sources":["tonva/index.ts","tonva/components/index.ts","tonva/components/nav.tsx","tonva/net/netToken.ts","tonva/components/fetchErrorView.tsx","tonva/components/reloadPage.tsx","tonva/net/guestApi.ts","tonva/net/caller.ts","tonva/tool/cacheIds.ts","tonva/tool/local.ts","tonva/components/page/pageHeader.tsx","tonva/components/page/page.tsx","tonva/net/appBridge.ts","tonva/uq/caller.ts","tonva/uq/entity.ts","tonva/components/edit/itemEdit.tsx","tonva/net/httpChannel.ts","tonva/net/httpChannelUI.ts","tonva/net/uqApi.ts","tonva/net/wsChannel.ts","tonva/res/res.ts","tonva/vm/controller.tsx","tonva/vm/view.tsx","tonva/vm/vpage.tsx","tonva/uq/index.ts","tonva/uq/query.ts","tonva/tool/uid.ts","tonva/components/image.tsx","tonva/tool/user.ts","tonva/net/host.ts","tonva/uq/action.ts","tonva/components/simple/LMR.tsx","tonva/components/simple/Badge.tsx","tonva/components/simple/FA.tsx","tonva/components/simple/IconText.tsx","tonva/components/simple/Muted.tsx","tonva/uq/tuid/idCache.ts","tonva/uq/tuid/tuid.ts","tonva/tool/localDb.ts","tonva/uq/tuid/reactBoxId.tsx","tonva/components/page/scrollView.tsx","tonva/components/loading.tsx","tonva/tool/env.ts","tonva/uq/tuid/index.ts","tonva/net/apiBase.ts","tonva/components/edit/imageItemEdit.tsx","tonva/res/formRes.ts","tonva/res/listRes.ts","tonva/res/entry/login.ts","tonva/res/entry/register.ts","tonva/tool/pageItems.ts","tonva/components/navigo.ts","tonva/components/page/tabs.tsx","tonva/components/resUploader.tsx","tonva/uq/uqMan.ts","tonva/uq/sheet.ts","tonva/uq/book.ts","tonva/uq/history.ts","tonva/uq/map.ts","tonva/uq/pending.ts","tonva/uq/tag/tagView.tsx","tonva/uq/tag/tag.ts","tonva/components/page/index.ts","tonva/components/schema/index.ts","tonva/components/rules/index.ts","tonva/components/dropDownActions/index.tsx","tonva/components/easyDate/index.tsx","tonva/components/media.tsx","tonva/components/searchBox.tsx","tonva/components/userIcon.tsx","tonva/uq/tuid/tuidsCache.ts","tonva/uq/uqsMan.ts","tonva/components/form/rules/index.ts","tonva/components/form/widgets/widget.tsx","tonva/components/form/widgets/textWidget.tsx","tonva/components/form/widgets/textareaWidget.tsx","tonva/components/form/widgets/passwordWidget.tsx","tonva/components/form/widgets/numberWidget.tsx","tonva/components/form/widgets/updownWidget.tsx","tonva/components/form/widgets/dateWidget.tsx","tonva/components/form/widgets/checkBoxWidget.tsx","tonva/components/form/widgets/selectWidget.tsx","tonva/components/form/widgets/radioWidget.tsx","tonva/components/form/widgets/rangeWidget.tsx","tonva/components/form/widgets/idWidget.tsx","tonva/components/form/widgets/unknown.tsx","tonva/components/form/widgets/buttonWidget.tsx","tonva/components/form/context.tsx","tonva/components/form/widgets/arrComponent.tsx","tonva/components/form/widgets/imageWidget.tsx","tonva/components/form/widgets/tagWidget.tsx","tonva/components/form/widgets/factory.tsx","tonva/components/form/form.tsx","tonva/components/form/field.tsx","tonva/components/edit/stringItemEdit.tsx","tonva/components/edit/radioItemEdit.tsx","tonva/components/edit/selectItemEdit.tsx","tonva/components/edit/idItemEdit.tsx","tonva/components/edit/tagItemEdit.tsx","tonva/components/edit/textAreaItemEdit.tsx","tonva/components/edit/edit.tsx","tonva/app/centerApi.ts","tonva/app/vMain.tsx","tonva/app/CAppBase.ts","tonva/app/start.ts","tonva/app/CBase.ts","tonva/components/list/base.tsx","tonva/components/list/clickable.tsx","tonva/components/list/static.tsx","tonva/components/list/selectable.tsx","tonva/components/list/index.tsx","tonva/components/propGrid/row.tsx","tonva/components/propGrid/propView.tsx","tonva/components/propGrid/PropGrid.tsx","tonva/entry/meInfo.tsx","serviceWorker.ts","tapp/appConfig.ts","tapp/appName.ts","tapp/CBase.ts","tapp/main.tsx","note/model.ts","note/views/VBasePage.tsx","note/views/VSelectContact.tsx","note/item/VNoteBase.tsx","note/item/VRelatives.tsx","note/item/VNoteView.tsx","note/item/VNoteItem.tsx","note/item/CNoteItem.tsx","note/item/VItemInput.tsx","note/task/CTaskNoteItem.ts","tool/isempty.ts","note/item/VNoteForm.tsx","note/text/VEdit.tsx","note/text/VTextView.tsx","note/text/VAdd.tsx","note/text/CTextNoteItem.ts","note/views/VActions.tsx","note/views/VTo.tsx","note/task/VTaskParams.tsx","note/task/VEdit.tsx","note/task/state/VTaskView.tsx","note/task/VEditTextItem.tsx","note/task/state/VCheckTask.tsx","note/task/state/VRateTask.tsx","note/views/VSent.tsx","note/folder/VFolder.tsx","note/folder/VFolderNoteItem.tsx","note/folder/VEdit.tsx","note/folder/VFolderRelatives.tsx","note/folder/VFolderView.tsx","note/folder/CFolderNoteItem.ts","note/CNote.ts","home/VHome.tsx","home/CHome.ts","relation/VAdd.tsx","relation/VRelation.tsx","relation/contact/VContact.tsx","relation/contact/VEditAssigned.tsx","relation/contact/CContact.ts","relation/CRelation.ts","me/VEditMe.tsx","me/VMe.tsx","me/CMe.ts","tapp/uqs.ts","discover/VDiscover.tsx","discover/CDiscover.ts","tapp/VTestMe.tsx","tapp/VTestAB.tsx","tapp/res/index.ts","tapp/res/zh.ts","tapp/res/en.ts","tapp/CApp.ts","index.tsx"],"names":["logMark","netToken","userId","token","setCenterToken","WSChannel","FetchErrorView","reApi","a","props","clearError","channel","url","options","resolve","reject","refetchApi","close","errContent","this","error","err","i","push","key","style","wordWrap","className","type","onClick","React","SystemNotifyPage","message","header","ReloadPage","timerHandler","reload","clearInterval","nav","seconds","undefined","state","setInterval","setState","title","msg","ConfirmReloadPage","back","confirm","isMobile","RegExp","test","navigator","userAgent","logs","stackKey","NavView","stack","htmlTitle","waitCount","waitTimeHandler","upgradeUq","start","isHistoryBack","navBack","tick","Date","now","console","log","length","len","window","self","top","postMessage","confirmClose","pop","fetchError","wait","set","addEventListener","isInAppRouting","isRouting","init","env","setTimeout","clearTimeout","unauthorized","showLogin","uq","version","show","view","disposer","clear","removeCeased","history","pushState","ceased","refresh","item","dispose","level","p","backLevel","popAndDispose","find","v","elWait","elError","testing","left","zIndex","name","map","index","visibility","position","ws","wsHost","local","LocalData","navigo","navSettings","language","culture","resUrl","hashParam","centerHost","arrs","windowOnError","event","source","lineno","colno","windowOnUnhandledRejection","ev","reason","windowOnClick","windowOnMouseMove","x","y","windowOnScroll","showPrivacyPage","privacy","getPrivacyContent","privacyPage","getPrivacy","html","content","__html","marked","dangerouslySetInnerHTML","waiting","Promise","race","serviceWorker","ready","registration","unregister","document","location","plus","webview","webView","resetAll","ok","showReloadPage","localStorage","lang","resOptions","district","Navigo","handler","onWsReceiveAny","handlerId","endWsReceive","receive","unitJsonPath","fetch","unitRes","json","res","unit","remove","el","getElementById","innerText","loadUnitJson","innerHTML","JSON","parse","envUnit","process","REACT_APP_UNIT","Number","get","isDevelopment","id","getPredefinedUnitName","unitName","guestApi","unitFromName","unitId","settings","origin","pathname","toLowerCase","endsWith","substr","host","hash","pos","getExHashPos","substring","resHost","resUrlFromHost","setCenterUrl","guest","Error","setGuest","exHash","getExHash","appInFrame","setAppInFrame","parent","wsBridge","loadPredefinedUnit","predefinedUnit","onerror","onunhandledrejection","onselectstart","oncontextmenu","startWait","user","notLogined","logined","endWait","on","absolute","navigate","showPage","onLogined","userApi","me","icon","nick","callback","logoutApis","stringify","saveLocalUser","showAppView","connect","defaultTop","loginTop","headers","Headers","indexOf","http","method","text","withBack","lv","loginView","default","footer","logout","logoutClear","cp","ChangePasswordPage","onError","showUpgradeUq","replace","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","apiId","sheetType","sheetId","sheet","includes","uh","appUrl","src","String","open","date","getTime","toTimeString","step","href","ret","r","parser","DOMParser","htmlDoc","parseFromString","elHtml","getElementsByTagName","newVersion","getAttribute","g","oem","observable","decodeGuestToken","CenterApiBase","Caller","params","_params","maxCount","arr","ids","dict","loadId","shift","delete","_loadIds","items","_loadId","setItem","e","Map","localDb","child","_user","_guest","_unit","forEach","d","PageHeader","afterBack","logoutClick","showLogout","debugLogout","b","right","center","ex","role","rightView","Page","observer","tabsView","tabsProps","TabsView","headerClassName","elFooter","onScroll","onScrollTop","onScrollBottom","children","renderHeader","renderFooter","uqTokens","logoutUqTokens","appsInFrame","page","param","val","isBridged","subFrameStarted","evt","data","subWin","setSubAppWindow","hidden","hideFrameBack","_","clone","initSubWin","onReceiveAppApiMessage","apiName","db","parts","split","uqOwner","uqName","appOwner","appName","uqTokenApi","onAppApiReturn","urlTest","action","uqTokenActions","realUrl","getUrlOrTest","appHash","slice","lastIndexOf","u","uid","getUnit","realUnit","onReceive","callCenterApiFromMessage","bridgeCenterApiReturn","startsWith","buildAppUq","uqToken","centerToken","at","opener","appUq","brideCenterApis","bridgeCenterApi","body","callId","from","callCenterapi","directCall","result","bca","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","uqApi","xcall","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","schema","rebuildSchema","buildEntities","setSchema","ver","uqVersion","en","ActionCaller","QueryQueryCaller","unpackReturns","buildParams","QueryPageCaller","pageStart","pageSize","chars","codeBackSlash","charCodeAt","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","jName","sys","cache","fields","arrFields","returns","face","fieldMaps","localMap","f","loadEntitySchema","buildFieldsTuid","loadValues","setJName","buildFieldTuid","buildArrFieldsTuid","value","fieldName","arrName","entities","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","buildDateTimeParam","_tuid","getIdFromObj","dt","Math","floor","toISOString","packRow","arrData","packArr","join","row","ch","escape","values","boxId","ln","unpackRow","unpackArr","ch0","c","fLen","to","reverseNT","n","isNaN","vals","ItemEdit","itemSchema","uiItem","label","_itemSchema","_uiItem","newValue","internalStart","internalEnd","divValue","labelHide","templet","Templet","widget","list","rules","nv","Array","isArray","verifyRule","rule","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","showError","post","urlPrefix","caller","buildOptions","path","h","append","encodeURI","innerFetch","keys","Object","k","innerFetchResult","buildError","retErr","that","timeOutHandler","statusText","ct","then","retJson","retError","catch","buildHeaders","CenterHttpChannel","UqHttpChannel","HttpChannelNavUI","channelUIs","channelNoUIs","channels","UqApi","basePath","access","showWaiting","channelUI","acc","ApiBase","UnitxApi","buildChannel","centerAppApi","CenterAppApi","unitxUq","centerChannel","centerChannelUI","loginedUserId","t","un","localCache","nowTick","appUqParams","call","loadAppUqs","uqs","decodeUserToken","account","verify","password","prop","subAppWindow","win","WsBase","wsBaseId","handlerSeed","anyHandlers","msgHandlers","seed","$type","wsBaseSeed","WebSocket","onopen","onmessage","wsMessage","onclose","netThis","send","$lang","$district","resLang","merge","l","languages","toUpperCase","setResOptions","resGlobal","setRes","target","str","setGlobalRes","Controller","_t","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","internalT","vp","render","onEvent","alert","openPage","registerReceiveHandler","beforeStart","afterStart","onClosePage","go","caption","yes","no","classNames","closePage","buttons","View","controller","isMe","vm","vCall","returnCall","imageClassName","textClassName","renderUser","replacePage","backPage","ceasePage","popToTopPage","VPage","retOnClosePage","_onClosePage","openPageElement","renderPage","onPageScroll","scroller","onPageScrollTop","onPageScrollBottom","QueryPager","query","firstSize","itemObservable","$page","idFieldName","appendPosition","sortOrder","order","_items","startIndex","getPageId","load","splice","newItem","newId","oldItem","oldId","PageItems","Query","more","startField","isPaged","size","array","deep","pageCaller","request","queryCaller","table","obj","ALPHABET","rtn","charAt","random","Image","altImage","alt","currentTarget","jwtDecode","hosts","centerhost","reshost","uqhost","unitxhost","httpArr","urlFromHost","isAbsoluteUrl","centerUrlFromHost","centerWsFromHost","fetchOptions","mode","tryLocal","getCenterHost","getResHost","promises","hostArr","findIndex","fetchUrl","debugHostUrl","localCheck","all","results","j","hostValue","debugHost","getUrlOrDebug","urlDebug","fetchLocalCheck","Action","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","pack","LMR","badge","color","badgeAlign","badgeVertical","cn","cursor","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","Muted","IdCache","tuidLocal","queue","loading","localArr","waitingIds","tuidInner","divName","initLocalArr","defer","isNumber","has","cacheTuids","moveToHead","removeItem","_id","getValue","useId","loadIds","tuidValues","cacheIdValues","tuids","unpackTuidIds","tuidValue","cacheValue","cacheTuidFieldValues","loadTuidIdsOrLocal","localedValues","filter","getItem","netIds","loadTuidIds","netRet","IdDivCache","div","Tuid","noCache","typeName","idName","cached","unique","isImport","TuidBox","id1","id2","equ","TuidInner","divs","cacheFields","idCache","removeAll","tuidDiv","TuidDiv","createBoxId","resetCache","assureObj","cacheIds","modifyIds","IdsCaller","valueFromId","GetCaller","cacheFieldsInValue","arrValues","mainFields","$create","$update","stampOnMain","unpackTuidIdsOfFields","SaveCaller","SavePropCaller","AllCaller","searchArr","owner","SearchCaller","LoadArrCaller","SaveArrCaller","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","year","getFullYear","month","getMonth","getDate","TuidImport","assureBox","loadMain","save","saveProp","search","loadArr","saveArr","posArr","hasDiv","ownerField","TuidBoxDiv","__ls","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","ks","unshift","saveIndex","max","ls","TuidContent","tuidName","s","uqStringify","ReactBoxId","isUndefined","boxName","nullUI","ttv","divObj","bi","logContent","boxIdContent","Scroller","scrollTo","scrollTop","offsetHeight","ScrollView","bottomTime","topTime","refDiv","onResize","removeEventListener","sh","scrollHeight","direct","Children","_$scroll","toString","eachChild","ref","Component","Loading","testingTags","pn","isTesting","tag","ms","args","global","handle","getHttpChannel","callFetch","put","ImageItemEdit","resId","onSaved","formRes","required","number","integer","min","zh","listRes","none","loginRes","registerRes","isFirst","pageItemAction","itemConverter","scrollToTop","scrollIntoView","topDiv","scrollToBottom","bottomDiv","changing","divId","loadResults","pageList","beforeLoad","loaded","allLoaded","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","onLoad","setPageStart","onLoaded","reverse","computed","useHash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_genericHooks","_historyUpdateMethod","timout","_onLocationChange","isPushStateAvailable","_cLoc","_listen","updatePageLinks","cleanUrl","match","names","reduce","decodeURIComponent","route","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","m","findMatchedRoutes","colonExp","matched","routeExp","fallbackURL","matched0","cleanGETParam","hooks","exHooks","before","shouldRoute","after","_getRoot","_historyUpdate","arg0","arg1","orderedRoutes","sort","compareUrlDepth","uses","_add","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","manageHooks","_callLeave","isHashedRoot","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","tagName","getLinkPath","preventDefault","status","pause","destroy","as","replaceState","cLocRoot","isHashChangeAPIAvailable","check","querySelectorAll","lastRouteResolved","leave","Tab","contentBuilder","notify","onShown","_content","selected","TabCaptionComponent","tabBg","sep","tabClick","tab","selectedTab","tabArr","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","display","ResUploader","fileInput","upload","formData","buildFormData","onFilesChange","files","fileName","maxSize","FormData","file","multiple","onChange","formatSize","pointLength","units","toFixed","ImageUploader","imgBaseSize","suffix","resUploader","onFileChange","fileError","uploaded","enableUploadButton","imageTypes","reader","FileReader","readAsDataURL","onload","srcImage","setSize","desImgSize","desImage","compress","img","width","height","srcImgWidth","srcImgHeight","w","scale","desImgWidth","round","desImgHeight","canvas","createElement","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","isChanged","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","defaultChecked","disabled","levelDiv","padding","AudioUploader","audioTypes","fileSize","uploading","UqMan","uqData","tvs","actions","sheets","queries","books","maps","histories","pendings","tags","tuidsCache","localAccess","localModifyMax","createBoxIdFromTVs","tuidArr","actionArr","sheetArr","queryArr","bookArr","mapArr","historyArr","pendingArr","tagArr","clearTuids","trim","TuidsCache","accesses","loadAccess","buildTuids","buildAccess","newTuid","entityName","fromType","fromObj","book","Book","Tag","History","pending","Pending","Sheet","newAction","newQuery","newBook","newMap","newHistory","newSheet","newPending","newTag","buildSheet","build","buildTuidBox","buildTuidDivBox","modifyMax","states","ops","op","discription","app","flow","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","PageStateItems","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","SheetCaller","count","getStateSheets","queryApiName","BookQueryCaller","schemaFrom","actionSchema","querySchema","AddCaller","DelCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","radioStyle","TagView","nameFromId","namesFromIds","renderRadio","renderView","checked","renderCheck","wrapClassName","inputs","inputName","onInputChange","input","coll","_view","lines","line","ext","mobileRegex","emailRegex","timeRes","md","ymd","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","appendTime","dPart","hm","EasyTime","SearchBox","allowEmptySearch","onSubmit","initKey","onSearch","inputSize","inputClassName","onFocus","placeholder","buttonText","maxLength","defaultValue","userCache","loader","UserView","noneImage","idProp","useUser","use","cacheTimer","clearCacheTimer","tuidCached","innerPullModify","tuidLists","queueModify","group","modify","UQsMan","tonvaAppName","collection","localData","buildTVs","uqsMan","uqAppData","retErrors","setTuidImportsLocal","_uqs","buildUQs","errors","uqTVs","lj","uqsData","promiseInits","uqFullName","lower","loadEntities","uqMan","Proxy","receiver","showReload","setInner","tuidImport","fromName","iName","setFrom","Rule","RuleCustom","func","defy","RulePredefined","RuleRequired","RuleNum","minMsg","maxMsg","template","checkMore","RuleInt","isInteger","Widget","context","fieldProps","_ui","readOnly","isChanging","changeValue","container","visible","form","inNode","requiredFlag","FieldContainer","renderBody","getUiItem","contextErrors","buildRules","removeErrorWidget","addErrorWidget","initData","fromElement","onChanging","onChanged","prev","allowChange","setDataValue","setElementValue","elDiscription","hasError","discriptionClassName","errorList","fieldClass","FieldClass","uiLabel","TextWidget","inputType","onKeyDown","internalOnKeyDown","keyCode","onEnter","blur","setError","onBlur","checkRules","checkContextRules","hasFocus","clearErrors","renderTemplet","renderErrors","TextAreaWidget","setValue","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","SelectWidget","select","option","RadioWidget","rowKey","isRow","RangeWidget","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","submit","observerRender","widgetType","button","ButtonClass","Context","uiSchema","subContexts","widgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","errorWidgets","ew","onButtonClick","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","clearContextErrors","checkHasError","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","ImageWidget","edit","imageSrc","end","TagWidget","widgetsFactory","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","valuesView","renderRadios","tagMulti","defaultArr","def","renderChecks","range","typeWidget","getItemSchema","getTypeWidget","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","DefaultFieldContainer","fieldLabelSize","labelView","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","contextType","StringItemEdit","preValue","verifyValue","onSave","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","onItemChanged","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","divLabel","ie","createItemEdit","requireFlag","centerApi","userName","VUnsupportedUnit","VUnitSelect","renderRow","onRowClick","appUnits","VErrorsPage","VStartError","CAppBase","config","appConfig","noUnit","elements","onRoute","userAppUnits","showUnsupport","appUnit","openVPage","resolveRoute","userFromId","CApp","html0","cApp","CBase","_cApp","CSub","_owner","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","selectedItems","compare","comp","selectItem","retItems","si","labelId","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","anySelected","some","List","listBase","buildBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","waitingMore","tabIndex","isLoading","staticRow","PropRow","PropBorder","borderTop","PropGap","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","PropView","buildRows","isGap","setValues","PropGrid","propView","userSetProp","Boolean","hostname","CUqBase","CUqSub","CUqApp","EnumNoteItemType","VMain","cHome","cRelation","cDiscover","cMe","numberFromId","VBasePage","renderContact","assigned","renderContactItem","contact","VSelectContact","buildRight","single","onToggleSelect","contacts","onNext","onContactSelect","onContactClick","itemIcons","task","folder","VNoteBase","renderFrom","noteItem","fromAssigned","renderEditTime","lineHeight","renderToCount","toCount","renderSpawnCount","spawnCount","onSendNote","loadRelation","showTo","onComment","onCommentSubmit","noteContent","onCommentChange","comment","AddComment","checkable","checkType","renderContentText","renderCheckItems","renderContentList","renderContentBase","dot","unread","trimRight","renderParagraphs","doneItems","uncheckedItems","checkedItems","ci","doneTop","checkedCount","renderCheckItem","data-key","create","update","onEdit","VRelatives","renderComments","comments","noteModel","renderComment","renderTo","renderFlow","renderSpawnItem","divOwner","renderSpawn","spawn","renderContain","contain","relativeCur","divUserName","VNoteView","renderVm","VNoteItem","divToCount","divspawnCount","renderTop","renderItemContent","CNoteItem","itemKey","buildObj","changedNoteContent","parseContent","backPageCount","oldType","SetNote","stringifyContent","setNote","updateChange","addNote","notes","note","commentId","EnumTaskState","VItemInput","lostFocusTimeoutHandler","onUpdateAction","isFocused","inputContent","onUpdate","inputRef","getComputedStyle","focus","VNoteForm","inputAdd","onTitleChange","onContentChange","onCheckableChanged","changed","onAddEnter","onCheckChange","onItemChange","onItemKeyDown","hideNote","onDelete","radios","getOptions","renderContentTextArea","renderContentCheckList","renderContentEditList","onButtonSave","btnSaveDisabled","renderExButtons","addItem","getSaveDisabled","VEdit","renderEdit","checkInputAdd","renderDeleteButton","VTextView","renderBottomCommands","renderRelatives","renderEditButton","renderSendToButton","renderCommentButton","VAdd","parentId","onSaveAndSendNote","AddNote","cnewNote","CTextNoteItem","VActions","onSend","toList","sendNoteTo","showSentPage","onAssign","showAssignTaskPage","VTo","VTaskParams","point","onSendTask","assignTask","checker","rater","onClickContacts","callSelectContact","onClickChecker","onClickRater","renderContacts","renderPoint","renderChecker","renderRater","renderBaseItem","renderParam","Fragment","VTaskView","divCaption","allowCheck","renderCaption","renderState","Start","isEnd","VTaskStart","onDone","DoneTask","showActionEndPage","renderStateSpan","VTaskDone","VTaskPass","VTaskFail","VTaskRated","VTaskCanceled","TaskViewFactory","stateViews","Done","Pass","Fail","Rated","Canceled","getView","enumTaskState","TaskView","VEditTextItemInput","inputText","onClickSave","VCheckTask","onDiscribeChange","updateCheckInfo","onDiscribeKeyDown","CheckSaveInfo","onCheck","pass","CheckTask","resultPage","checkInfo","eprops","setCheckInfo","vEdit","renderOrtherContent","VRateTask","rateValue","updateRateInfo","onRate","RateTask","renderValueRadio","CTaskNoteItem","getTaskView","checkInfoInput","rateInfoInput","rateValueInput","rateInfo","flowContent","renderListItem","noteId","Note","cObj","tos","AssignTask","SaveX","SetNoteX","VSent","VFolder","noteKey","renderNote","renderItem","onNoteClick","getNote","onClickItem","popFolder","showAddNotePage","folderId","notesPager","topContent","contentString","trimEnd","VFolderNoteItem","stopPropagation","onClickEllipsis","VFolderRelatives","VFolderView","CFolderNoteItem","EnumSpecFolder","GetNotes","setItemConverter","noteItemConverter","newnotes","newitems","cNoteItem","currentFoldItem","GetNote","renderListView","openFolder","sub","getCNoteItem","theItems","theItem","HideNote","cNoteItems","CNote","foldItemStack","queryResults","convertObj","newSub","foldItem","showFolder","SendNoteTo","cTaskNoteItem","VHome","cNode","CHome","newC","fromKey","onAddContact","AddContact","VRelation","onShowContact","VContact","onEditAlias","onEditAssigned","VEditAssigned","SaveContactAssign","autoFocus","CContact","CRelation","GetMyContacts","showContact","SetContactAssinged","VEditMe","VMe","onExit","changePassword","meInfo","userSpan","aboutRows","logOutRows","CMe","VDiscover","onTaskReport","onOtherReport","CDiscover","VTestMe","VTestAB","home","relation","discover","aboutTheApp","pleaseLogin","gaps","gapIndex","callTick","$Poked","poke","startHome","showMain","startAB","queryStr","startMe","initTabName","setSettings","App","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.8de0214c.chunk.js","sourcesContent":["export * from './tool';\nexport * from './net';\nexport * from './components';\nexport * from './entry';\nexport * from './uq';\nexport * from './app';\nexport * from './vm';\n","export * from './navigo';\nexport * from './nav';\nexport * from './page';\nexport * from './schema';\nexport * from './form';\nexport * from './edit';\nexport * from '../res/res';\nexport * from './loading';\nexport * from './image';\nexport * from './resUploader';\nexport * from './rules';\nexport * from './list';\nexport * from './dropDownActions';\nexport * from './easyDate';\nexport * from './propGrid';\nexport * from './simple';\nexport * from './media';\nexport * from './searchBox';\nexport * from './userIcon';\n\n","import * as React from 'react';\nimport {observable} from 'mobx';\nimport marked from 'marked';\nimport {User, Guest/*, UserInNav*/} from '../tool/user';\nimport {Page} from './page/page';\nimport {netToken} from '../net/netToken';\nimport FetchErrorView, { SystemNotifyPage } from './fetchErrorView';\nimport {FetchError} from '../net/fetchError';\nimport {appUrl, setAppInFrame, getExHash, getExHashPos} from '../net/appBridge';\nimport {LocalData, env} from '../tool';\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, WSChannel, appInFrame, host, resUrlFromHost} from '../net';\nimport { WsBase, wsBridge } from '../net/wsChannel';\nimport { resOptions } from '../res/res';\nimport { Loading } from './loading';\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from './navigo';\n\nimport 'font-awesome/css/font-awesome.min.css';\nimport '../css/va-form.css';\nimport '../css/va.css';\nimport '../css/animation.css';\nimport { FA } from './simple';\nimport { userApi } from '../net';\nimport { ReloadPage, ConfirmReloadPage } from './reloadPage';\n\nconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\n    'BlackBerry|Windows Phone|'  +\n    'Opera Mini|IEMobile|Mobile' , \n    'i');\nconst isMobile = regEx.test(navigator.userAgent);\n\n/*\nexport const mobileHeaderStyle = isMobile? {\n    minHeight:  '3em'\n} : undefined;\n*/\n//const logo = require('../img/logo.svg');\nlet logMark: number;\nconst logs:string[] = [];\n\nexport interface Props //extends React.Props<Nav>\n{\n    //view: JSX.Element | (()=>JSX.Element);\n    //start?: ()=>Promise<void>;\n    onLogined: ()=>Promise<void>;\n    notLogined?: ()=>Promise<void>;\n};\nlet stackKey = 1;\nexport interface StackItem {\n    key: number;\n    view: JSX.Element;\n    ceased: boolean;\n    confirmClose?: ()=>Promise<boolean>;\n    disposer?: ()=>void;\n}\nexport interface NavViewState {\n    stack: StackItem[];\n    wait: 0|1|2;\n    fetchError: FetchError\n}\n\nexport class NavView extends React.Component<Props, NavViewState> {\n    private stack: StackItem[];\n    private htmlTitle: string;\n    private waitCount: number = 0;\n    private waitTimeHandler?: NodeJS.Timer;\n\n    constructor(props:Props) {\n        super(props);\n        //this.back = this.back.bind(this);\n        //this.navBack = this.navBack.bind(this);\n        this.stack = [];\n        this.state = {\n            stack: this.stack,\n            wait: 0,\n            fetchError: undefined\n        };\n        nav.set(this);\n    }\n    async componentDidMount()\n    {\n\t\twindow.addEventListener('popstate', this.navBack);\n\t\tif (nav.isInAppRouting || !nav.isRouting) await nav.init();\n        await nav.start();\n    }\n\n    get level(): number {\n        return this.stack.length;\n    }\n\n    startWait() {\n        if (this.waitCount === 0) {\n            this.setState({wait: 1});\n            this.waitTimeHandler = env.setTimeout(\n                'NavView.startWait',\n                () => {\n                    this.waitTimeHandler = undefined;\n                    this.setState({wait: 2});\n                },\n                1000) as NodeJS.Timer;\n        }\n        ++this.waitCount;\n        this.setState({\n            fetchError: undefined,\n        });\n    }\n\n    endWait() {\n        env.setTimeout(\n            undefined, //'NavView.endWait',\n            () => {\n            /*\n            this.setState({\n                fetchError: undefined,\n            });*/\n            --this.waitCount;\n            if (this.waitCount === 0) {\n                if (this.waitTimeHandler !== undefined) {\n                    env.clearTimeout(this.waitTimeHandler);\n                    this.waitTimeHandler = undefined;\n                }\n                this.setState({wait: 0});\n            }\n        },100);\n    }\n\n    async onError(fetchError: FetchError)\n    {\n        let err = fetchError.error;\n        if (err !== undefined) {\n            if (err.unauthorized === true) {\n                await nav.showLogin(undefined);\n                return;\n            }\n            switch (err.type) {\n                case 'unauthorized':\n                    await nav.showLogin(undefined);\n                    return;\n                case 'sheet-processing':\n                    nav.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\n                    return;\n            }\n        }\n        this.setState({\n            fetchError: fetchError,\n        });\n    }\n\n    private upgradeUq = () => {\n        nav.start();\n    }\n\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        this.show(<Page header={false}>\n            <div>\n                UQ升级了，请点击按钮升级 <br />\n                <small className=\"text-muted\">{uq} ver-{version}</small>\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\n            </div>\n        </Page>)\n    }\n\n    show(view: JSX.Element, disposer?: ()=>void): number {\n        this.clear();\n        return this.push(view, disposer);\n    }\n\n    push(view: JSX.Element, disposer?: ()=>void): number {\n        this.removeCeased();\n        if (this.stack.length > 0) {\n            window.history.pushState('forward', null, null);\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key,\n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        this.refresh();\n        //console.log('push: %s pages', this.stack.length);\n        return key;\n    }\n\n    replace(view: JSX.Element, disposer?: ()=>void): number {\n        let item:StackItem = undefined;\n        let stack = this.stack;\n        if (stack.length > 0) {\n            item = stack.pop();\n            //this.popAndDispose();\n        }\n        let key = stackKey++;\n        this.stack.push({\n            key: key, \n            view: view, \n            ceased: false,\n            disposer: disposer\n        });\n        if (item !== undefined) this.dispose(item.disposer);\n        this.refresh();\n        //console.log('replace: %s pages', this.stack.length);\n        return key;\n    }\n\n    ceaseTop(level:number = 1) {\n        let p = this.stack.length - 1;\n        for (let i=0; i<level; i++, p--) {\n            if (p < 0) break;\n            let item = this.stack[p];\n            item.ceased = true;\n        }\n    }\n\n    pop(level:number = 1) {\n        let stack = this.stack;\n        let len = stack.length;\n        //console.log('pop start: %s pages level=%s', len, level);\n        if (level <= 0 || len <= 1) return;\n        if (len < level) level = len;\n        let backLevel = 0;\n        for (let i = 0; i < level; i++) {\n            if (stack.length === 0) break;\n            //stack.pop();\n            this.popAndDispose();\n            ++backLevel;\n        }\n        if (backLevel >= len) backLevel--;\n        this.refresh();\n        if (this.isHistoryBack !== true) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(backLevel);\n            //window.addEventListener('popstate', this.navBack);\n        }\n        //console.log('pop: %s pages', stack.length);\n    }\n\n    popTo(key: number) {\n        if (key === undefined) return;\n        if (this.stack.find(v => v.key === key) === undefined) return;\n        while (this.stack.length >0) {\n            let len = this.stack.length;\n            let top = this.stack[len-1];\n            if (top.key === key) break;\n            this.pop();\n        }\n    }\n\n    topKey():number {\n        let len = this.stack.length;\n        if (len === 0) return undefined;\n        return this.stack[len-1].key;\n    }\n\n    removeCeased() {\n        for (;;) {\n            let p=this.stack.length-1;\n            if (p < 0) break;\n            let top = this.stack[p];\n            if (top.ceased === false) break;\n            let item = this.stack.pop();\n            let {disposer} = item;\n            this.dispose(disposer);\n        }\n        this.refresh();\n    }\n\n    private popAndDispose() {\n        this.removeCeased();\n        let item = this.stack.pop();\n\t\tif (item === undefined) return;\n\t\t//if (nav.isRouting) {\n\t\t//\twindow.history.back();\n\t\t//}\n        let {disposer} = item;\n        this.dispose(disposer);\n        this.removeCeased();\n        return item;\n    }\n\n    private dispose(disposer:()=>void) {\n        if (disposer === undefined) return;\n        let item = this.stack.find(v => v.disposer === disposer);\n        if (item === undefined) disposer();\n    }\n\n    clear() {\n        let len = this.stack.length;\n        while (this.stack.length > 0) this.popAndDispose();\n        //this.refresh();\n        if (len > 1) {\n            //window.removeEventListener('popstate', this.navBack);\n            //window.history.back(len-1);\n            //window.addEventListener('popstate', this.navBack);\n        }\n    }\n\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        let top = stack[len-1];\n        top.confirmClose = confirmClose;\n    }\n\n    private isHistoryBack:boolean = false;\n    navBack = () => {\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\n        let tick = Date.now();\n        this.isHistoryBack = true;\n        this.back(true);\n        this.isHistoryBack = false;\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\n    }\n\n    back = async (confirm:boolean = true) => {\n        let stack = this.stack;\n        let len = stack.length;\n        if (len === 0) return;\n        if (len === 1) {\n            if (window.self !== window.top) {\n                window.top.postMessage({type:'pop-app'}, '*');\n            }\n            return;\n        }\n        let top = stack[len-1];\n        if (confirm===true && top.confirmClose) {\n            if (await top.confirmClose()===true) this.pop();\n        }\n        else {\n            this.pop();\n        }\n    }\n\n    confirmBox(message?:string): boolean {\n        return window.confirm(message);\n    }\n    clearError = () => {\n        this.setState({fetchError: undefined});\n    }\n    render() {\n        const {wait, fetchError} = this.state;\n        let stack = this.state.stack;\n        let top = stack.length - 1;\n        let elWait = null, elError = null;\n        switch (wait) {\n            case 1:\n                elWait = <div className=\"va-wait va-wait1\">\n                </div>;\n                break;\n            case 2:\n                elWait = <div className=\"va-wait va-wait2\">\n                    <Loading />\n                </div>;\n                break;\n        }\n        if (fetchError)\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\n        let test = nav.testing===true && \n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\n                <FA className=\"text-warning\" name=\"info-circle\" />\n            </span>;\n        return <>\n\t\t\t{stack.map((item, index) => {\n\t\t\t\tlet {key, view} = item;\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\n\t\t\t\t\t{view}\n\t\t\t\t</div>\n\t\t\t})}\n\t\t\t{elWait}\n\t\t\t{elError}\n\t\t\t{test}\n        </>;\n    }\n\n    private refresh() {\n        this.setState({stack: this.stack });\n    }\n}\n\nexport interface NavSettings {\n    oem?: string;\n    loginTop?: JSX.Element;\n    privacy?: string;\n}\n\nexport class Nav {\n    private nav:NavView;\n    private ws: WsBase;\n    private wsHost: string;\n    private local: LocalData = new LocalData();\n\tprivate navigo: Navigo;\n\tisRouting: boolean;\n\tisInAppRouting: boolean;\n\tnavSettings: NavSettings;\n    @observable user: User/*InNav*/ = undefined;\n    testing: boolean;\n    language: string;\n    culture: string;\n    resUrl: string;\n\n    constructor() {\n        let {lang, district} = resOptions;\n        this.language = lang;\n        this.culture = district;\n\t\tthis.testing = false;\n\t\tthis.navigo = new Navigo();\n\t\tthis.isRouting = false;\n\t\tthis.isInAppRouting = false;\n    }\n\n    get guest(): number {\n        let guest = this.local.guest;\n        if (guest === undefined) return 0;\n        let g = guest.get();\n        if (g === undefined) return 0;\n        return g.guest;\n    }\n\n    set(nav:NavView) {\n        //this.logo = logo;\n        this.nav = nav;\n\t}\n\t\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\n        if (this.ws === undefined) return;\n        return this.ws.onWsReceiveAny(handler);\n    }\n\n    unregisterReceiveHandler(handlerId:number) {\n        if (this.ws === undefined) return;\n        if (handlerId === undefined) return;\n        this.ws.endWsReceive(handlerId);\n    }\n\n    async onReceive(msg:any) {\n        if (this.ws === undefined) return;\n        await this.ws.receive(msg);\n    }\n\n\tprivate async loadUnitJson() {\n\t\ttry {\n\t\t\tlet unitJsonPath = this.unitJsonPath();\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\n\t\t\tlet res = await unitRes.json();\n\t\t\treturn res.unit;\n\t\t}\n\t\tcatch (err1) {\n\t\t\tthis.local.unit.remove();\n\t\t\treturn;\n\t\t}\n\t}\n\n    private async getPredefinedUnitName() {\t\t\n\t\tlet el = document.getElementById('unit');\n\t\tif (el) {\n\t\t\treturn el.innerText;\n\t\t}\n\t\tel = document.getElementById('unit.json');\n\t\tif (!el) {\n\t\t\treturn await this.loadUnitJson();\n\t\t}\n\t\ttry {\n            let json = el.innerHTML;\n            let res = JSON.parse(json);\n            return res.unit;\n        }\n        catch (err) {\n\t\t\treturn await this.loadUnitJson();\n        }\n    }\n\n    private async loadPredefinedUnit() {\n        let envUnit = process.env.REACT_APP_UNIT;\n        if (envUnit !== undefined) {\n            return Number(envUnit);\n        }\n        let unitName:string;\n        let unit = this.local.unit.get();\n        if (unit !== undefined) {\n            if (env.isDevelopment !== true) return unit.id;\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n            if (unit.name === unitName) return unit.id;\n        }\n        else {\n            unitName = await this.getPredefinedUnitName();\n            if (unitName === undefined) return;\n        }\n        let unitId = await guestApi.unitFromName(unitName);\n        if (unitId !== undefined) {\n            this.local.unit.set({id: unitId, name: unitName});\n        }\n        return unitId;\n    }\n\n    setSettings(settings?: NavSettings) {\n        this.navSettings = settings;\n    }\n\n    get oem():string {\n        return this.navSettings && this.navSettings.oem;\n    }\n\n    hashParam: string;\n    private centerHost: string;\n    private arrs = ['/test', '/test/'];\n    private unitJsonPath():string {\n        let {origin, pathname} = document.location;\n\t\tpathname = pathname.toLowerCase();\n        for (let item of this.arrs) {\n            if (pathname.endsWith(item) === true) {\n                pathname = pathname.substr(0, pathname.length - item.length);\n                break;\n            }\n        }\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\n            pathname = pathname.substr(0, pathname.length-1);\n        }\n        return origin + pathname + '/unit.json';\n    }\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\n\t\tdebugger;\n        console.error('windowOnError');\n        console.error(error);\n    }\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\n\t\tdebugger;\n        console.error('windowOnUnhandledRejection');\n        console.error(ev.reason);\n    }\n    private windowOnClick = (ev: MouseEvent) => {\n        console.error('windowOnClick');\n    }\n    private windowOnMouseMove = (ev: MouseEvent) => {\n        console.log('navigator.userAgent: ' + navigator.userAgent);\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\n    }\n    private windowOnScroll = (ev: Event) => {\n        console.log('scroll event');\n\t}\n\t\n\tasync init() {\n\t\tthis.testing = env.testing;\n\t\tawait host.start(this.testing);\n\t\tlet hash = document.location.hash;\n\t\tif (hash !== undefined && hash.length > 0) {\n\t\t\tlet pos = getExHashPos();\n\t\t\tif (pos < 0) pos = undefined;\n\t\t\tthis.hashParam = hash.substring(1, pos);\n\t\t}\n\t\tlet {url, ws, resHost} = host;\n\t\tthis.centerHost = url;\n\t\tthis.resUrl = resUrlFromHost( resHost);\n\t\tthis.wsHost = ws;\n\t\tsetCenterUrl(url);\n\n\t\tlet guest:Guest = this.local.guest.get();\n\t\tif (guest === undefined) {\n\t\t\tguest = await guestApi.guest();\n\t\t}\n\t\tif (!guest) {\n\t\t\tdebugger;\n\t\t\tthrow Error('guest can not be undefined');\n\t\t}\n\t\tnav.setGuest(guest);\n\n\t\tlet exHash = getExHash();\n\t\tlet appInFrame = setAppInFrame(exHash);\n\t\tif (exHash !== undefined && window !== window.parent) {\n\t\t\t// is in frame\n\t\t\tif (appInFrame !== undefined) {\n\t\t\t\tthis.ws = wsBridge;\n\t\t\t\tconsole.log('this.ws = wsBridge in sub frame');\n\t\t\t\t//nav.user = {id:0} as User;\n\t\t\t\tif (window.self !== window.parent) {\n\t\t\t\t\twindow.parent.postMessage({type:'sub-frame-started', hash: appInFrame.hash}, '*');\n\t\t\t\t}\n\t\t\t\t// 下面这一句，已经移到 appBridge.ts 里面的 initSubWin，也就是响应从main frame获得user之后开始。\n\t\t\t\t//await this.showAppView();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tlet predefinedUnit = await this.loadPredefinedUnit();\n\t\tappInFrame.predefinedUnit = predefinedUnit;\n\t}\n\n    async start() {\n        try {\n\t\t\twindow.onerror = this.windowOnError;\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\n            //window.addEventListener('click', this.windowOnClick);\n            //window.addEventListener('mousemove', this.windowOnMouseMove);\n            //window.addEventListener('touchmove', this.windowOnMouseMove);\n            //window.addEventListener('scroll', this.windowOnScroll);\n            if (isMobile === true) {\n                document.onselectstart = function() {return false;}\n                document.oncontextmenu = function() {return false;}\n            }\n            //window.setInterval(()=>console.error('tick every 5 seconds'), 5000);\n\t\t\tnav.clear();\n\t\t\tthis.startWait();\n            \n            let user: User = this.local.user.get();\n            if (user === undefined) {\n                let {notLogined} = this.nav.props;\n                if (notLogined !== undefined) {\n                    await notLogined();\n                }\n                else {\n                    await nav.showLogin(undefined);\n                }\n                return;\n            }\n\n            await nav.logined(user);\n        }\n        catch (err) {\n\t\t\tconsole.error(err);\n\t\t\tdebugger;\n        }\n        finally {\n            this.endWait();\n        }\n\t}\n\n\tresolveRoute() {\n\t\tthis.isRouting = true;\n\t\tthis.navigo.resolve();\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\n\t}\n\n\tnavigate(url:string, absolute?:boolean) {\n\t\tthis.clear();\n\t\treturn this.navigo.navigate(url, absolute);\n\t}\n\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tif (this.isRouting) {\n\t\t\tthis.navigate(url, absolute);\n\t\t}\n\t\telse {\n\t\t\tshowPage();\n\t\t}\n\t}\n\n    async showAppView() {\n        let {onLogined} = this.nav.props;\n        if (onLogined === undefined) {\n            nav.push(<div>NavView has no prop onLogined</div>);\n            return;\n        }\n        nav.clear();\n        await onLogined();\n        //console.log('logined: AppView shown');\n    }\n\n    setGuest(guest: Guest) {\n        this.local.guest.set(guest);\n        netToken.set(0, guest.token);\n    }\n\n    saveLocalUser() {\n        this.local.user.set(this.user);\n    }\n\n    async loadMe() {\n        let me = await userApi.me();\n        this.user.icon = me.icon;\n        this.user.nick = me.nick;\n    }\n\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\n        logoutApis();\n        console.log(\"logined: %s\", JSON.stringify(user));\n        this.user = user;\n        this.saveLocalUser();\n        netToken.set(user.id, user.token);\n        if (callback !== undefined) //this.loginCallbacks.has)\n            callback(user);\n            //this.loginCallbacks.call(user);\n        else {\n            await this.showAppView();\n        }\n    }\n\n    wsConnect() {\n        let ws:WSChannel = this.ws = new WSChannel(this.wsHost, this.user.token);\n        ws.connect();\n    }\n\n    loginTop(defaultTop:JSX.Element) {\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\n    }\n\n    privacyEntry() {\n        if (!this.getPrivacyContent()) return;\n        return <div className=\"text-center\">\n            <button className=\"btn btn-sm btn-link\"\n                onClick={this.showPrivacyPage}>\n                <small className=\"text-muted\">隐私政策</small>\n            </button>\n        </div>;\n    }\n\n    private getPrivacyContent():string {\n        if (!this.navSettings) return;\n        let {privacy} = this.navSettings;\n        return privacy;\n    }\n\n    showPrivacyPage = () => {\n        let privacy = this.getPrivacyContent();\n        if (privacy) {\n            this.privacyPage(privacy);\n        }\n        else {\n            nav.push(<Page header=\"隐私政策\">\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\n            </Page>);\n        }\n    }\n\n    private privacyPage = async (privacy:string) => {\n        let html = await this.getPrivacy(privacy);\n        let content = {__html: marked(html)};\n        nav.push(<Page header=\"隐私政策\">\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\n        </Page>);\n    }\n\n    private async getPrivacy(privacy:string):Promise<string> {\n        const headers = new  Headers({\n            \"Content-Type\":'text/plain'\n       })\n        let pos = privacy.indexOf('://');\n        if (pos > 0) {\n            let http = privacy.substring(0, pos).toLowerCase();\n            if (http === 'http' || http === 'https') {\n                try {\n                    let res = await fetch(privacy, {\n                        method:'GET',\n                        headers: headers,\n                    });\n                    let text = await res.text();\n                    return text;\n                }\n                catch (err) {\n                    return err.message;\n                }\n            }\n        }\n        return privacy;\n    }\n\n    async showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\n        let lv = await import('../entry/login');\n        let loginView = <lv.default \n            withBack={withBack} \n            callback={callback} />;\n        if (withBack !== true) {\n            this.nav.clear();\n            this.pop();\n        }\n        this.nav.push(loginView);\n    }\n\n    async showLogout(callback?: ()=>Promise<void>) {\n        let footer = <div className=\"text-center justify-content-center\">\n            <button className=\"btn btn-outline-danger\" onClick={this.resetAll}>升级软件</button>\n        </div>;\n        nav.push(<Page header=\"安全退出\" back=\"close\" footer={footer}>\n            <div className=\"my-5 mx-1 border border-info bg-white rounded p-3 text-center\">\n                <div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\n                <div className=\"mt-3 text-center\">\n                        <button className=\"btn btn-danger\" onClick={()=>this.logout(callback)}>安全退出</button>\n                </div>\n            </div>\n        </Page>);\n    }\n\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\n        appInFrame.unit = undefined;\n        this.local.logoutClear();\n        this.user = undefined; //{} as User;\n        logoutApis();\n        let guest = this.local.guest.get();\n        setCenterToken(0, guest && guest.token);\n        this.ws = undefined;\n        /*\n        if (this.loginCallbacks.has)\n            this.logoutCallbacks.call();\n        else {\n            if (notShowLogin === true) return;\n        }\n        await nav.start();\n        */\n        if (callback === undefined)\n            await nav.start();\n        else\n            await callback();\n    }\n\n    async changePassword() {\n        let cp = await import('../entry/changePassword');\n        nav.push(<cp.ChangePasswordPage />);\n    }\n\n    get level(): number {\n        return this.nav.level;\n    }\n    startWait() {\n        this.nav?.startWait();\n    }\n    endWait() {\n        this.nav?.endWait();\n    }\n    async onError(error: FetchError) {\n        await this.nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await this.nav.showUpgradeUq(uq, version);\n    }\n\n    show (view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.show(view, disposer);\n    }\n    push(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.push(view, disposer);\n    }\n    replace(view: JSX.Element, disposer?: ()=>void): void {\n        this.nav.replace(view, disposer);\n    }\n    pop(level:number = 1) {\n        this.nav.pop(level);\n    }\n    topKey():number {\n        return this.nav.topKey();\n    }\n    popTo(key:number) {\n        this.nav.popTo(key);\n    }\n    clear() {\n        this.nav?.clear();\n    }\n    navBack() {\n        this.nav.navBack();\n    }\n    ceaseTop(level?:number) {\n        this.nav.ceaseTop(level);\n    }\n    removeCeased() {\n        this.nav.removeCeased();\n    }\n    async back(confirm:boolean = true) {\n        await this.nav.back(confirm);\n    }\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.nav.regConfirmClose(confirmClose);\n    }\n    confirmBox(message?:string): boolean {\n        return this.nav.confirmBox(message);\n    }\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\n        return new Promise<void>((resolve, reject) => {\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\n            let uh = sheetId === undefined?\n                    appUrl(url, unitId) :\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\n            console.log('navToApp: %s', JSON.stringify(uh));\n            nav.push(<article className='app-container'>\n                <span id={uh.hash} onClick={()=>this.back()} /*style={mobileHeaderStyle}*/>\n                    <i className=\"fa fa-arrow-left\" />\n                </span>\n                {\n                    // eslint-disable-next-line \n                    <iframe src={uh.url} title={String(sheetId)} />\n                }\n            </article>, \n            ()=> {\n                resolve();\n            });\n        });\n    }\n\n    navToSite(url: string) {\n        // show in new window\n        window.open(url);\n    }\n\n    get logs() {return logs};\n    log(msg:string) {\n        logs.push(msg);\n    }\n    logMark() {\n        let date = new Date();\n        logMark = date.getTime();\n        logs.push('log-mark: ' + date.toTimeString());\n    }\n    logStep(step:string) {\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\n    }\n\n    showReloadPage(msg: string) {\n        let seconds = -1;\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\n\t\t/*\n\t\tif (seconds > 0) {\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\n\t\t}\n\t\t*/\n    }\n\n    reload = async () => {\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\n            setTimeout(resolve, 100);\n        });\n\n        if ('serviceWorker' in navigator) {\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\n            if (registration) registration.unregister();\n        }\n\t\twindow.document.location.reload();\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\n\t\tlet plus = (window as any).plus;\n\t\tif (plus) {\n\t\t\tlet webview = plus.webview;\n\t\t\tif (webview) {\n\t\t\t\tif (webview.reload) webview.reload(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlet webView = plus.webView;\n\t\t\t\tif (webView) {\n\t\t\t\t\tif (webView.reload) webView.reload(true);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//plus.webview.reload(true)\n\t\t}\n    }\n\n    resetAll = () => {\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\n            if (ok === true) {\n                this.showReloadPage('彻底升级');\n\t\t\t\tlocalStorage.clear();\n\t\t\t\t/*\n                this.local.readToMemory();\n                env.localDb.removeAll();\n\t\t\t\tthis.local.saveToLocalStorage();\n\t\t\t\t*/\n            }\n            else {\n                this.pop();\n            }\n            return;\n        }} />);\n    }\n\n    async checkVersion():Promise<string> {\n        let {href} = document.location;\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\n        let ret = await fetch(href);\n        let r = await ret.text();\n        let parser = new DOMParser();\n        let htmlDoc = parser.parseFromString(r, 'text/html');\n        let elHtml = htmlDoc.getElementsByTagName('html');\n        let newVersion = elHtml[0].getAttribute('data-version');\n        return newVersion;\n    }\n}\nexport const nav: Nav = new Nav();\n","\nimport {setCenterToken} from './uqApi';\nimport {WSChannel} from './wsChannel';\n\nexport const netToken = {\n    set(userId:number, token:string) {\n        setCenterToken(userId, token);\n        WSChannel.setCenterToken(token);\n    },\n    clear() {\n        setCenterToken(0, undefined);\n        WSChannel.setCenterToken(undefined);\n    }\n};\n","import * as React from 'react';\nimport {FetchError} from '../net/fetchError';\nimport { refetchApi } from '../net';\nimport { Page } from './page/page';\n\nexport interface FetchErrorProps extends FetchError {\n    clearError: ()=>void\n}\n\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\n    private reApi = async () => {\n        this.props.clearError();\n        const {channel, url, options, resolve, reject} = this.props;\n        await refetchApi(channel, url, options, resolve, reject);\n    }\n    private close = async () => {\n        this.props.clearError();\n    }\n    render() {\n        let {error, url} = this.props;\n        let errContent:any;\n        if (typeof error === 'object') {\n            let err = [];\n            for (let i in error) {\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\n            }\n            errContent = <ul>{err}</ul>;\n        }\n        else {\n            errContent = <div>{error}</div>;\n        }\n        return <div>\n            <article>\n\t\t\t\t<main className=\"va-error\">\n\t\t\t\t\t<div>网络出现问题</div>\n\t\t\t\t\t<div>点击重新访问</div>\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\n\t\t\t\t\t{errContent}\n\t\t\t\t\t<div className=\"p-3\">\n\t\t\t\t\t\t<button type='button' onClick={this.reApi}>重新API</button>\n\t\t\t\t\t\t<button type='button' onClick={this.close}>关闭</button>\n\t\t\t\t\t</div>\n\t\t\t\t</main>\n            </article>\n        </div>;\n    }\n}\n\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\n    return <Page header=\"系统提醒\">\n        <div className=\"px-3\">{message}</div>\n    </Page>;\n}","import * as React from 'react';\nimport { nav } from './nav';\nimport { Page } from './page/page';\n\ninterface Props {\n    message: string,\n    seconds: number\n}\n\ninterface State {\n    seconds: number\n}\n\nexport class ReloadPage extends React.Component<Props, State> {\n    private timerHandler:any;\n    constructor(props:Props) {\n\t\tsuper(props);\n\t\tlet {seconds} = props;\n\t\tif (seconds===undefined) return;\n        this.state = {seconds};\n\t\tif (seconds <= 0) return;\n        this.timerHandler = setInterval(() => {\n\t\t\tlet {seconds} = this.state;\n            seconds--;\n            if (seconds <= 0) {\n                this.reload();\n            }\n            else {\n                this.setState({seconds: seconds});\n            }\n        }, 1000);\n    }\n    private reload = () => {\n        clearInterval(this.timerHandler);\n        nav.reload();\n    }\n    render() {\n\t\tlet {seconds} = this.state;\n\t\tlet title:string, msg:string;\t\t\n\t\tif (seconds > 0) {\n\t\t\ttitle = '程序升级中...';\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\n\t\t}\n\t\telse {\n\t\t\ttitle = '程序需要升级';\n\t\t\tmsg = '请点击下面按钮重启';\n\t\t}\n        return <Page header={false}>\n            <div className=\"text-center p-5\">\n                <div className=\"text-info py-5\">\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\n\t\t\t\t\t<br/>\n\t\t\t\t\t{msg}\n                    <br/>\n                    <span className=\"small text-muted\">{this.props.message}</span>\n                </div>\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\n            </div>\n        </Page>;\n    }\n}\n\ninterface ConfirmReloadPageProps {\n    confirm: (ok: boolean)=>Promise<void>;\n}\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\n    return <Page header=\"升级软件\" back=\"close\">\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\n            <div className=\"text-center text-info\">\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\n            </div>\n            <div className=\"text-center mt-5\">\n                <button className=\"btn btn-danger mr-3\" onClick={()=>props.confirm(true)}>确认升级</button>\n            </div>\n        </div>\n    </Page>;\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\n}\n","import { decodeGuestToken } from '../tool/user';\nimport { CenterApiBase } from './uqApi';\n\nexport class GuestApi extends CenterApiBase {\n    async guest(): Promise<any> {\n        //let guest = nav.local.guest.get();\n        let ret = await this.get('', {});\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeGuestToken(ret);\n            case 'object':\n                let guest = decodeGuestToken(ret.token);\n                return guest;\n        }\n    }\n\n    async unitFromName(unitName:string): Promise<number> {\n        let ret = await this.get(unitName);\n        return ret && ret.unit;\n    }\n}\n\nexport const guestApi = new GuestApi('tv/guest/', undefined);\n","export abstract class Caller<T> {\n    protected readonly _params: T;\n    constructor(params: T, waiting: boolean) {\n        this._params = params;\n        this.waiting = waiting;\n    }\n    protected get params():any {return this._params;}\n    buildParams():any {return this.params;}\n    method: string  = 'POST';\n    abstract get path(): string;\n    get headers(): {[header:string]: string} {return undefined}\n    waiting: boolean;\n}\n","import {observable} from 'mobx';\n\nexport interface Id {\n    id: number;\n}\n\nexport abstract class CacheIds<T extends Id> {\n    constructor(maxCount:number = 100) {\n        this.maxCount = maxCount;\n    }\n    private maxCount:number;\n    private arr:T[] = [];\n    @observable dict = new Map<number, T>();\n\n    loadIds(ids:number[]) {\n        let arr:number[] = [];\n        for (let id of ids) {\n            if (id === null) continue;\n            let item = this.dict.get(id);\n            if (item === undefined) {\n                arr.push(id);\n                item = {id:id} as T;\n                this.dict.set(id, item);\n            }\n        }                \n        this.loadId(arr);\n    }\n\n    get(id:number):T {\n        if (id === undefined || id === null) return null;\n        let item = this.dict.get(id);\n        if (item === undefined) {\n            this.dict.set(id, {id:id} as T);\n            this.loadId([id]);\n            item = this.dict.get(id);\n        }\n        return item;\n    }\n    private setItem(id:number, item:T) {\n        if (item === undefined) {\n            this.dict.set(id, null);\n            this.arr.push({id: id} as T);\n        }\n        else {\n            this.dict.set(id, item);\n            this.arr.push(item);\n        }\n        if (this.arr.length > this.maxCount) {\n            item = this.arr.shift();\n            this.dict.delete(item.id);\n        }\n    }\n    private async loadId(ids:number[]) {\n        let items = await this._loadIds(ids);\n        if (items === undefined) {\n            for (let id of ids) {\n                if (id === null) continue;\n                let item = await this._loadId(id);\n                this.setItem(id, item);\n            }\n        }\n        else {\n            for (let id of ids) {\n                let item = items.find(v => v.id === id);\n                this.setItem(id, item);\n            }\n        }\n    }\n\n    protected abstract async _loadIds(ids:number[]):Promise<T[]>;\n    protected abstract async _loadId(id:number):Promise<T>;\n}\n","import { env } from './env';\n\nexport class LocalData {\n    user = env.localDb.child('user');\n    guest = env.localDb.child('guest');\n    unit = env.localDb.child('unit');\n\n    private _user:string;\n    private _guest:string;\n    private _unit:string;\n    readToMemory() {\n        this._user = this.user.get();\n        this._guest = this.guest.get();\n        this._unit = this.unit.get();\n    }\n    saveToLocalStorage() {\n        this.user.set(this._user);\n        this.guest.set(this._guest);\n        this.unit.set(this._unit);\n    }\n\n    logoutClear() {\n        [\n            this.user,\n            this.unit,\n        ].forEach(d => d.remove());\n    }\n}\n","import * as React from 'react';\nimport {nav} from '../nav';\n\nexport interface PageHeaderProps {\n    back?: 'back' | 'close' | 'none';\n    center: string | JSX.Element;\n    right?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n    className?: string;\n\tafterBack?: () => void;\n\tex?: JSX.Element;\n}\n\nexport class PageHeader extends React.Component<PageHeaderProps> {\n    private back = async () => {\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\n\t\tlet {afterBack} = this.props;\n\t\tif (afterBack) afterBack();\n    }\n    openWindow() {\n        window.open(document.location.href);\n    }\n    private logoutClick = () => {\n        nav.showLogout(this.logout);\n    }\n    private logout = async () => {\n        let {logout} = this.props;\n        if (typeof logout === 'function') {\n            await logout(); \n        }\n        await nav.logout(undefined);\n    }\n    render() {\n        let b = nav.level > 1 || window.self !== window.top;\n        let {right, center, logout, className, ex} = this.props;\n        let back:any, debugLogout:any;\n        if (logout !== undefined && window.self === window.top) {\n            if ((typeof logout === 'boolean' && logout === true)\n                || typeof logout === 'function')\n            {\n                let {user} = nav;\n                if (user !== undefined) {\n                    let {nick, name} = user;\n                    debugLogout = <div className=\"d-flex align-items-center\">\n                        <small className=\"text-light\">{nick || name}</small>\n                        {\n                            // eslint-disable-next-line\n                            <div className=\"ml-2 py-2 px-3 cursor-pointer\"\n                                role=\"button\"\n                                onClick={this.logoutClick}>\n                                <i className=\"fa fa-sign-out fa-lg\" />\n                            </div>\n                        }\n                    </div>;\n                }\n            }\n        }\n        if (b) {\n            switch (this.props.back) {\n                case 'none':\n                    back = undefined;\n                    break;\n                default:\n                case 'back':\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\n                    break;\n                case 'close':\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\n                    break;\n            }\n        }\n        if (window.self !== window.top) {\n            console.log(document.location.href);\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\n        }\n        if (back === undefined && typeof center === 'string') {\n            center = <div className=\"px-3\">{center}</div>;\n        }\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\n\t\tlet header = <header className={className}>\n\t\t\t<nav>\n\t\t\t\t{back}\n\t\t\t\t{/*pop 弹出window暂时停止作用 */}\n\t\t\t\t<div>{center}</div>\n\t\t\t\t{rightView}\n\t\t\t</nav>\n\t\t\t{ex}\n\t\t</header>;\n        return <>\n\t\t\t<section className=\"tv-page-header\">{header}</section>\n\t\t\t{header}\n\t\t</>;\n\t\t/*\n\t\t\t<header className={className}>\n\t\t\t<section>\n\t\t\t\t<header>\n\t\t\t\t\t{back}\n\t\t\t\t\t<div>{center}</div>\n\t\t\t\t\t{rightView}\n\t\t\t\t</header>\n\t\t\t</section>\n            {back}\n            <div>{center}</div>\n            {rightView}\n        </header>;*/\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport {PageHeader} from './pageHeader';\nimport { TabsProps, TabsView } from './tabs';\nimport { ScrollProps, ScrollView } from './scrollView';\n\nexport interface IVPage {\n\tcontent():JSX.Element;\n\theader():JSX.Element;\n\tfooter():JSX.Element;\n}\n\n\nexport interface PageProps extends ScrollProps {\n    back?: 'close' | 'back' | 'none';\n    header?: boolean | string | JSX.Element;\n    right?: JSX.Element;\n    footer?: JSX.Element;\n    logout?: boolean | (()=>Promise<void>);\n\theaderClassName?: string;\n\tclassName?: string;\n\tafterBack?: () => void;\n\ttabsProps?: TabsProps;\n}\n\n@observer\nexport class Page extends React.Component<PageProps> {\n\tprivate tabsView: TabsView;\n    constructor(props: PageProps) {\n\t\tsuper(props);\n\t\tlet {tabsProps} = props;\n\t\tif (tabsProps) {\n\t\t\tthis.tabsView = new TabsView(tabsProps);\n\t\t}\n\t}\n\n\tprivate renderHeader() {\n\t\tconst {back, header, right, headerClassName, afterBack} = this.props;\n\t\tlet pageHeader = header !== false && <PageHeader \n\t\t\tback={back} \n\t\t\tcenter={header as any}\n\t\t\tright={right}\n\t\t\tlogout={this.props.logout}\n\t\t\tclassName={headerClassName}\n\t\t\tafterBack={afterBack}\n\t\t\t/>;\n\t\treturn pageHeader;\n\t}\n\n\tprivate renderFooter() {\n\t\tconst {footer} = this.props;\n\t\tif (footer) {\n\t\t\tlet elFooter = <footer>{footer}</footer>;\n\t\t\treturn <>\n\t\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\n\t\t\t\t{elFooter}\n\t\t\t</>;\n\t\t}\n\t}\n\n    render() {\n\t\tif (this.tabsView) {\n\t\t\treturn React.createElement(this.tabsView.content);\n\t\t}\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className} = this.props;\n\t\treturn <ScrollView\n\t\t\tonScroll={onScroll}\n\t\t\tonScrollTop={onScrollTop}\n\t\t\tonScrollBottom={onScrollBottom}\n\t\t\tclassName={className}\n\t\t>\n\t\t\t{this.renderHeader()}\n\t\t\t<main>{children}</main>\n\t\t\t{this.renderFooter()}\n\t\t</ScrollView>;\n\t}\n}\n","import _ from 'lodash';\nimport {nav} from '../components';\nimport {uid} from '../tool/uid';\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken} from './uqApi';\nimport {setSubAppWindow} from './wsChannel';\nimport { host } from './host';\n\nexport interface UqToken {\n    name: string;\n    db: string;\n    url: string;\n    token: string;\n}\nconst uqTokens:{[uqName:string]: UqToken}  = {};\nexport function logoutUqTokens() {\n    for (let i in uqTokens) {\n        uqTokens[i] = undefined;\n    }\n}\n\nexport interface AppInFrame {\n    hash: string;\n    unit: number;       // unit id\n    page?: string;\n    param?: string[];\n    predefinedUnit?: number;  // 比如像Cart这样的应用，直接让用户访问的，就需要在unit.json里面定义unitName\n}\nconst appsInFrame:{[key:string]:AppInFrame} = {};\n\nclass AppInFrameClass implements AppInFrame {\n    hash: string;\n    private _unit: number;\n    get unit(): number {return this._unit;}       // unit id\n    set unit(val:number) { this._unit=val;}\n    page?: string;\n    param?: string[];\n}\n\nexport let appInFrame:AppInFrame = new AppInFrameClass();\n/* {\n    hash: undefined,\n    get unit():number {return } undefined, //debugUnitId,\n    page: undefined;\n    param: undefined,\n}*/\n\nexport function isBridged():boolean {\n    return window.self !== window.parent;\n}\n\nwindow.addEventListener('message', async function(evt) {\n    var message = evt.data;\n    switch (message.type) {\n        case 'sub-frame-started':\n            subFrameStarted(evt);\n            break;\n        case 'ws':\n            //wsBridge.receive(message.msg);\n            await nav.onReceive(message.msg);\n            break;\n        case 'init-sub-win':\n            await initSubWin(message);\n            break;\n        case 'pop-app':\n            window.console.log('///\\\\\\\\\\\\ pop-app');\n            nav.navBack();\n            break;\n        case 'center-api':\n            await callCenterApiFromMessage(evt.source as Window, message);\n            break;\n        case 'center-api-return':\n            bridgeCenterApiReturn(message);\n            break;\n        case 'app-api':\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\n            (evt.source as Window).postMessage({\n                type: 'app-api-return', \n                apiName: message.apiName,\n                db: ret.db,\n                url: ret.url,\n                token: ret.token} as any, \"*\");\n            break;\n        case 'app-api-return':\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\n            console.log('await onAppApiReturn(message);');\n            await onAppApiReturn(message);\n            break;\n        default:\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\n            window.console.log('message: %s', JSON.stringify(message));\n            break;\n    }\n});\n\nfunction subFrameStarted(evt:any) {\n    var message = evt.data;\n    let subWin = evt.source as Window;\n    setSubAppWindow(subWin);\n    hideFrameBack(message.hash);\n    let msg:any = _.clone(nav.user);\n    msg.type = 'init-sub-win';\n    subWin.postMessage(msg, '*');\n}\nfunction hideFrameBack(hash:string) {\n    let el = document.getElementById(hash);\n    if (el !== undefined) el.hidden = true;\n}\nasync function initSubWin(message:any) {\n    console.log('initSubWin: set nav.user', message);\n    let user = nav.user = message; // message.user;\n    setCenterToken(user.id, user.token);\n    await nav.showAppView();\n}\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\n    let appInFrame = appsInFrame[hash];\n    if (appInFrame === undefined) return {name:apiName, db:undefined, url:undefined, token:undefined};\n    //let unit = getUnit();\n    let {unit, predefinedUnit} = appInFrame;\n    unit = unit || predefinedUnit;\n    if (!unit) {\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\n    }\n    let parts = apiName.split('/');\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\n    let ret = await uqTokenApi.uq(param);\n    let {db, url, token} = ret;\n    return {name: apiName, db:db, url: url, token: token};\n}\n\nasync function onAppApiReturn(message:any) {\n    let {apiName, db, url, urlTest, token} = message;\n    let action = uqTokenActions[apiName];\n    if (action === undefined) {\n        throw new Error('error app api return');\n        //return;\n    }\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\n    //action.url = realUrl;\n    //action.token = token;\n    action.resolve({\n        name: apiName,\n        db: db,\n        url: realUrl,\n        token: token,\n    } as UqToken);\n}\n\nexport function setAppInFrame(appHash: string):AppInFrame {\n    if (appHash) {\n        let parts = appHash.split('-');\n        let len = parts.length;\n        if (len > 0) {\n            let p = 1;\n            appInFrame.hash = parts[p++];\n            if (len>0) appInFrame.unit = Number(parts[p++]);\n            if (len>1) appInFrame.page = parts[p++];\n            if (len>2) appInFrame.param = parts.slice(p++);\n        }\n    }\n    return appInFrame;\n}\n\nexport function getExHashPos():number {\n    let hash = document.location.hash;\n    if (hash !== undefined && hash.length > 0) {\n        let pos = hash.lastIndexOf('#tv-');\n        if (pos < 0) pos = hash.lastIndexOf('#tvdebug-');\n        return pos;\n    }\n    return -1;\n}\n\nexport function getExHash():string {\n    let pos = getExHashPos();\n    if (pos < 0) return undefined;\n    return document.location.hash.substring(pos);\n}\n\nexport function appUrl(url: string, unitId: number, page?:string, param?:any[]):{url:string; hash:string} {\n    let u:string;\n    for (;;) {\n        u = uid();\n        let a = appsInFrame[u];\n        if (a === undefined) {\n            appsInFrame[u] = {hash:u, unit:unitId};\n            break;\n        }\n    }\n    url += '#tv-' + u + '-' + unitId;\n    if (page !== undefined) {\n        url += '-' + page;\n        if (param !== undefined) {\n            for (let i=0; i<param.length; i++) {\n                url += '-' + param[i];\n            }\n        }\n    }\n    return {url: url, hash: u};\n}\n\nfunction getUnit():number {\n\tlet {unit, predefinedUnit} = appInFrame;\n    let realUnit = unit || predefinedUnit;\n    if (realUnit === undefined) {\n        throw new Error('no unit defined in unit.json or not logined in');\n\t}\n    return realUnit;\n}\n\ninterface UqTokenAction {\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\n    reject: (reason?: any) => void;\n}\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string, appOwner:string, appName:string):Promise<void> {\n    if (!isBridged()) {\n        let unit = getUnit();\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName, appOwner, appName});\n        if (uqToken.token === undefined) uqToken.token = centerToken;\n        let {db, url, urlTest} = uqToken;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        console.log('realUrl: %s', realUrl);\n        uqToken.url = realUrl;\n        uqTokens[uq] = uqToken;\n        return uqToken;\n    }\n    console.log(\"**** before buildAppUq ****\", appInFrame);\n    let bp = uqTokenActions[uq];\n    if (bp !== undefined) return;\n    return new Promise<void>((resolve, reject) => {\n        uqTokenActions[uq] = {\n            resolve: async (at:any) => {\n                let {db, url, token} = await at;\n                uqTokens[uq] = {\n                    name: uq,\n                    db: db,\n                    url: url,\n                    token: token,\n                };\n                uqTokenActions[uq] = undefined;\n                console.log(\"**** after buildAppUq ****\", appInFrame);\n                resolve();\n            },\n            reject: reject,\n        };\n        (window.opener || window.parent).postMessage({\n            type: 'app-api',\n            apiName: uq,\n            hash: appInFrame.hash,\n        }, \"*\");\n    });\n}\n\nexport function appUq(uq:string):UqToken {\n    let uts = uqTokens;\n    return uts[uq];\n}\n\ninterface BridgeCenterApi {\n    id: string;\n    resolve: (value?:any)=>any;\n    reject: (reason?:any)=>void;\n}\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\n    return await new Promise<any>(async (resolve, reject) => {\n        let callId:string;\n        for (;;) {\n            callId = uid();\n            let bca = brideCenterApis[callId];\n            if (bca === undefined) {\n                brideCenterApis[callId] = {\n                    id: callId,\n                    resolve: resolve,\n                    reject: reject,\n                }\n                break;\n            }\n        }\n        (window.opener || window.parent).postMessage({\n            type: 'center-api',\n            callId: callId,\n            url: url,\n            method: method,\n            body: body\n        }, '*');\n    });\n}\n\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\n    let {callId, url, method, body} = message;\n    let result = await callCenterapi.directCall(url, method, body);\n    from.postMessage({\n        type: 'center-api-return',\n        callId: callId,\n        result: result,\n    }, '*');\n}\n\nfunction bridgeCenterApiReturn(message:any) {\n    let {callId, result} = message;\n    let bca = brideCenterApis[callId];\n    if (bca === undefined) return;\n    brideCenterApis[callId] = undefined;\n    bca.resolve(result);\n}\n","//import _ from 'lodash';\nimport { Caller } from '../net';\nimport { Entity } from './entity';\nimport { Action } from './action';\nimport { Query } from './query';\n\ninterface UqResponseSchema {\n    uq: any;\n    entity: any;\n}\n\nexport abstract class EntityCaller<T> extends Caller<T> {\n    private tries: number;\n    protected _entity: Entity;\n\n    constructor(entity: Entity, params:T, waiting: boolean = true) {\n        super(params, waiting);\n        this.tries = 0;\n        this._entity = entity;\n    }\n\n    protected get entity(): Entity {return this._entity;}\n\n    //大多的entityCaller都不需要这个\n    //buildParams() {return this.entity.buildParams(this.params);}\n    \n    async request(): Promise<any> {\n        await this.entity.loadSchema();\n        let ret = await this.innerRequest();\n        return ret;\n    }\n\n    protected async innerCall(): Promise<any> {\n        return await this.entity.uqApi.xcall(this);\n    }\n\n    async innerRequest(): Promise<any> {\n        let jsonResult = await this.innerCall();\n        let {$uq, $modify, res} = jsonResult;\n        this.entity.uq.pullModify($modify);\n        if ($uq === undefined) {\n            //if (res === undefined) debugger;\n            let ret = this.xresult(res);\n            //if (ret === undefined) debugger;\n            return ret;\n        }\n        return await this.retry($uq);\n    }\n\n    xresult(res:any):any {return res}\n\n    get headers(): {[header:string]: string} {\n        let {ver, uq} = this.entity;\n        let {uqVersion} = uq;\n        return {\n            uq: `${uqVersion}`,\n            en: `${ver}`,\n        }\n    }\n\n    private async retry(schema: UqResponseSchema) {\n        ++this.tries;\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\n        this.rebuildSchema(schema);\n        return await this.innerRequest();\n    }\n\n    private rebuildSchema(schema: UqResponseSchema) {\n        let {uq, entity} = schema;\n        if (uq !== undefined) this.entity.uq.buildEntities(uq);\n        if (entity !== undefined) {\n\t\t\tthis.entity.setSchema(entity);\n\t\t}\n    }\n}\n\nexport abstract class ActionCaller extends EntityCaller<any> {\n    protected get entity(): Action {return this._entity as Action;}\n}\n\nexport class QueryQueryCaller extends EntityCaller<any> {\n    protected get entity(): Query {return this._entity as Query};\n    get path():string {return `query/${this.entity.name}`;}\n    xresult(res:any) {\n        let data = this.entity.unpackReturns(res);\n        return data;\n    }\n    buildParams() {return this.entity.buildParams(this.params);}\n}\n\nexport class QueryPageCaller extends EntityCaller<any> {\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\n\tprotected get entity(): Query {return this._entity as Query};\n\t//results: {[name:string]:any[]};\n\tget path():string {return `query-page/${this.entity.name}`;}\t\n    buildParams() {\n        let {pageStart, pageSize, params} = this.params;\n        let p:any;\n        if (params === undefined) {\n            p = {key: ''};\n        }\n        else {\n            p = this.entity.buildParams(params);\n        }\n        /*\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        */\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return p;\n    };\n    xresult(res:any): {[name:string]:any[]} {\n        let ret = this.entity.unpackReturns(res);\n\t\t//return this.results.$page;// as any[];\n\t\treturn ret;\n    }\n}\n","import { UqApi } from '../net';\nimport { LocalCache } from '../tool';\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\nimport { Tuid } from './tuid';\n\nconst tab = '\\t';\nconst ln = '\\n';\nconst chars = '\\\\ntbfvr';\nconst codeBackSlash = chars.charCodeAt(0);\nconst codeN = chars.charCodeAt(1);\nconst codeT = chars.charCodeAt(2);\nconst codeB = chars.charCodeAt(3);\nconst codeF = chars.charCodeAt(4);\nconst codeV = chars.charCodeAt(5);\nconst codeR = chars.charCodeAt(6);\n\nconst codes = '\\n\\t\\b\\f\\v\\r';\nconst codeBN = codes.charCodeAt(0);\nconst codeBT = codes.charCodeAt(1);\nconst codeBB = codes.charCodeAt(2);\nconst codeBF = codes.charCodeAt(3);\nconst codeBV = codes.charCodeAt(4);\nconst codeBR = codes.charCodeAt(5);\n\nexport abstract class Entity {\n    private jName: string;\n    schema: any;\n    ver: number = 0;\n    sys?: boolean;\n    readonly uq: UqMan;\n    readonly name: string;\n    readonly typeId: number;\n    readonly cache: LocalCache;\n    readonly uqApi: UqApi;\n    abstract get typeName(): string;\n    get sName():string {return this.jName || this.name}\n    fields: Field[];\n    arrFields: ArrFields[];\n    returns: ArrFields[];\n\n    constructor(uq:UqMan, name:string, typeId:number) {\n        this.uq = uq;\n        this.name = name;\n        this.typeId = typeId;\n        this.sys = this.name.indexOf('$') >= 0;\n        this.cache = this.uq.localMap.item(this.name); // new EntityCache(this);\n        this.uqApi = this.uq.uqApi;\n    }\n\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\n\n    //getApiFrom() {return this.entities.uqApi;}\n\n    private fieldMaps: {[arr:string]: FieldMap} = {};\n    fieldMap(arr?:string): FieldMap {\n        if (arr === undefined) arr = '$';\n        let ret = this.fieldMaps[arr];\n        if (ret === undefined) {\n            let fields:Field[];\n            if (arr === '$') fields = this.fields;\n            else if (this.arrFields !== undefined) {\n                let arrFields = this.arrFields.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            else if (this.returns !== undefined) {\n                let arrFields = this.returns.find(v => v.name === arr);\n                if (arrFields !== undefined) fields = arrFields.fields;\n            }\n            if (fields === undefined) return {};\n            ret = {};\n            for (let f of fields) ret[f.name] = f;\n            this.fieldMaps[arr] = ret;\n        }\n        return ret;\n    }\n\n    public async loadSchema():Promise<void> {\n        if (this.schema !== undefined) return;\n        let schema = this.cache.get();\n        if (!schema) {\n            schema = await this.uq.loadEntitySchema(this.name);\n        }\n        this.setSchema(schema);\n\t\tthis.buildFieldsTuid();\n\t\tawait this.loadValues();\n\t}\n\t\n\tprotected async loadValues():Promise<any> {}\n\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\n    public clearSchema() {\n        this.schema = undefined;\n    }\n\n    public setSchema(schema:any) {\n        if (schema === undefined) return;\n        let {name, version} = schema;\n        this.ver = version || 0;\n\t\tthis.setJName(name);\n        this.cache.set(schema);\n\t\tthis.schema = schema;\n\t\tthis.buildFieldsTuid();\n\t}\n\t\n\tprotected setJName(name:string) {\n        if (name !== this.name) this.jName = name;\n\t}\n\n    public buildFieldsTuid() {\n        let {fields, arrs, returns} = this.schema;\n        this.uq.buildFieldTuid(this.fields = fields);\n        this.uq.buildArrFieldsTuid(this.arrFields = arrs, fields);\n        this.uq.buildArrFieldsTuid(this.returns = returns, fields);\n    }\n\n    schemaStringify():string {\n        return JSON.stringify(this.schema, (key:string, value:any) => {\n            if (key === '_tuid') return undefined;\n            return value;\n        }, 4);\n    }\n\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\n        if (this.schema === undefined) return;\n        let {fields, arrs} = this.schema;\n        let entities = this.uq;\n        function getTuid(fn:string, fieldArr:Field[]) {\n            if (fieldArr === undefined) return;\n            let f = fieldArr.find(v => v.name === fn);\n            if (f === undefined) return;\n            return entities.getTuid(f.tuid);\n        }\n        let fn = fieldName.toLowerCase();\n        if (arrName === undefined) return getTuid(fn, fields);\n        if (arrs === undefined) return;\n        let an = arrName.toLowerCase();\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\n        if (arr === undefined) return;\n        return getTuid(fn, arr.fields);\n    }\n\n    buildParams(params:any):any {\n        let result:any = {};\n        let fields = this.fields;\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\n        let arrs = this.arrFields;\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let {name, fields} = arr;\n                let paramsArr:any[] = params[name];\n                if (paramsArr === undefined) continue;\n                let arrResult:any[] = [];\n                result[name] = arrResult;\n                for (let pa of params) {\n                    let rowResult = {};\n                    this.buildFieldsParams(rowResult, fields, pa);\n                    arrResult.push(rowResult);\n                }\n            }\n        }\n        return result;\n    }\n\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\n        for (let field of fields) {\n            let {name, type} = field;            \n            let d = params[name];\n            let val:any;\n            if (type === 'datetime') {\n                val = this.buildDateTimeParam(d);\n            }\n            else {\n                switch (typeof d) {\n                    default: val = d; break;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) val = d.id;\n                        else val = tuid.getIdFromObj(d);\n                        break;\n                }\n            }\n            result[name] = val;\n        }\n    }\n\n    buildDateTimeParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'object': dt = (val as Date); break;\n            case 'string':\n            case 'number': dt = new Date(val); break;\n        }\n        return Math.floor(dt.getTime()/1000);\n    }\n\n    buildDateParam(val:any) {\n        let dt: Date;\n        switch (typeof val) {\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\n            case 'undefined': return '';\n            case 'string': return val;\n            case 'object': dt = (val as Date); break;\n            case 'number': dt = new Date(val); break;\n        }\n        let ret = dt.toISOString();\n        let p = ret.indexOf('T');\n        return p>0? ret.substr(0, p) : ret;\n    }\n\n    pack(data:any):string {\n        let ret:string[] = [];\n        let fields = this.fields;\n        if (fields !== undefined) this.packRow(ret, fields, data);\n        let arrs = this.arrFields; \n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n\t\t\t\tlet {name, fields} = arr;\n\t\t\t\tlet arrData = data[name];\n\t\t\t\tif (!arrData) arrData = data[name.toLowerCase()];\n                this.packArr(ret, fields, arrData);\n            }\n        }\n        return ret.join('');\n    }\n\n    private escape(row:any, field:Field):any {\n        let d = row[field.name];\n        switch (field.type) {\n            case 'datetime':\n                return this.buildDateTimeParam(d);\n            default:\n                switch (typeof d) {\n                    default: return d;\n                    case 'object':\n                        let tuid = field._tuid;\n                        if (tuid === undefined) return d.id;\n                        return tuid.getIdFromObj(d);\n                    case 'string':\n                        let len = d.length;\n                        let r = '', p = 0;\n                        for (let i=0;i<len;i++) {\n                            let c:number = d.charCodeAt(i), ch:string;\n                            switch(c) {\n\t\t\t\t\t\t\t\tdefault: continue;\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\n                                case codeBT: ch = '\\\\t'; break;\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\n\t\t\t\t\t\t\tp = i+1;\n                        }\n                        return r + d.substring(p);\n                    case 'undefined': return '';\n                }\n        }\n    }\n\n    private packRow(result:string[], fields:Field[], data:any) {\n        let len = fields.length;\n        if (len === 0) return;\n        let ret = '';\n        ret += this.escape(data, fields[0]);\n        for (let i=1;i<len;i++) {\n            let f = fields[i];\n            ret += tab + this.escape(data, f);\n        }\n        result.push(ret + ln);\n    }\n\n    private packArr(result:string[], fields:Field[], data:any[]) {\n        if (data !== undefined) {\n            for (let row of data) {\n                this.packRow(result, fields, row);\n            }\n        }\n        result.push(ln);\n    }\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\n        for (let f of fields as Field[]) {\n            let {name, _tuid} = f;\n            if (_tuid === undefined) continue;\n            let id = values[name];\n            //_tuid.useId(id);\n            values[name] = _tuid.boxId(id);\n        }\n    }\n\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\n        if (fields === undefined) return values as any[];\n        //if (this.fields === undefined) return values as any[];\n        let ret:any[] = []\n        for (let ln of values) {\n            if (!ln) continue;\n            let len = ln.length;\n            let p = 0;\n            while (p<len) {\n                let ch = ln.charCodeAt(p);\n                if (ch === 10) {\n                    ++p;\n                    break;\n                }\n                let row = {};\n                p = this.unpackRow(row, fields, ln, p);\n                ret.push(row);\n            }\n        }\n        return ret;\n    }\n\n    unpackSheet(data:string):any {\n        let ret = {} as any; //new this.newMain();\n        //if (schema === undefined || data === undefined) return;\n        let fields = this.fields;\n        let p = 0;\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\n        let arrs = this.arrFields; //schema['arrs'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    unpackReturns(data:string):{[name:string]:any[]} {\n        if (data === undefined) debugger;\n        let ret = {} as any;\n        //if (schema === undefined || data === undefined) return;\n        //let fields = schema.fields;\n        let p = 0;\n        //if (fields !== undefined) p = unpackRow(ret, schema.fields, data, p);\n        let arrs = this.returns; //schema['returns'];\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                //let creater = this.newRet[arr.name];\n                p = this.unpackArr(ret, arr, data, p);\n            }\n        }\n        return ret;\n    }\n\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\n        for (;p<len;p++) {\n            ch0 = ch;\n            ch = data.charCodeAt(p);\n            if (ch === 9) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                c = p+1;\n                ++i;\n                if (i>=fLen) {\n                    p = data.indexOf('\\n', c);\n                    if (p >= 0) ++p;\n                    else p = len;\n                    return p;\n                }\n            }\n            else if (ch === 10) {\n                let f = fields[i];\n                let {name} = f;\n                if (ch0 !== 8) {\n                    if (p>c) {\n                        let v = data.substring(c, p);\n                        ret[name] = this.to(ret, v, f);\n                    }\n                }\n                else {\n                    ret[name] = null;\n                }\n                ++p;\n                ++i;\n                return p;\n            }\n        }\n        let f = fields[i];\n        let {name} = f;\n        if (ch0 !== 8) {\n            let v = data.substring(c);\n            ret[name] = this.to(ret, v, f);\n        }\n        return len;\n    }\n\n    private to(ret:any, v:string, f:Field):any {\n        switch (f.type) {\n\t\t\tdefault: return v;\n\t\t\tcase 'text':\n\t\t\tcase 'char':\n\t\t\t\treturn this.reverseNT(v);\n            case 'datetime':\n            case 'time':\n\t\t\tcase 'timestamp':\n                let n = Number(v);\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\n                return date;\n            case 'date':\n                let parts = v.split('-');\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\n            case 'tinyint':\n            case 'smallint':\n            case 'int':\n            case 'bigint':\n            case 'dec':\n                return Number(v);\n            case 'id':\n                let id = Number(v);\n                let {_tuid} = f;\n                if (_tuid === undefined) return id;\n                return _tuid.boxId(id);\n        }\n\t}\n\t\n\tprivate reverseNT(text:string):string {\n\t\tif (text === undefined) return;\n\t\tif (text === null) return;\n\t\tlet len = text.length;\n\t\tlet r = '';\n\t\tlet p = 0;\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet c = text.charCodeAt(i);\n\t\t\tif (c === codeBackSlash) {\n\t\t\t\tif (i===len-1) break;\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\n\t\t\t\tlet ch:string;\n\t\t\t\tswitch (c1) {\n\t\t\t\t\tdefault: continue;\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\n\t\t\t\t}\n\t\t\t\tr += text.substring(p, i) + ch;\n\t\t\t\tp = i+2;\n\t\t\t\t++i;\n\t\t\t}\n\t\t}\n\t\tr += text.substring(p, len);\n\t\treturn r;\n\t}\n\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\n        let vals:any[] = [], len = data.length;\n        let {name, fields} = arr;\n        while (p<len) {\n            let ch = data.charCodeAt(p);\n            if (ch === 10) {\n                ++p;\n                break;\n            }\n            let val = {} as any; //new creater();\n            vals.push(val);\n            p = this.unpackRow(val, fields, data, p);\n        }\n        ret[name] = vals;\n        return p;\n    }\n}\n","import * as React from 'react';\nimport { ItemSchema, UiItem, UiSelectBase } from '../schema';\nimport { nav } from '../nav';\nimport { observable } from 'mobx';\nimport { FieldRule } from '../form/rules';\nimport { Image } from '../image';\n\nexport abstract class ItemEdit {\n\tprotected name: string;\n\tprotected _itemSchema: ItemSchema;\n    get itemSchema(): ItemSchema {return this._itemSchema}\n    protected _uiItem:UiItem;\n    get uiItem():UiItem {return this._uiItem}\n    value: any;\n    label: string;\n\n    @observable protected error: string;\n    @observable protected isChanged: boolean = false;\n    protected newValue: any;\n\n    constructor(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) {\n        this._itemSchema = itemSchema;\n        this._uiItem = uiItem\n        this.value = value;\n        let {name} = itemSchema;\n        this.name = name;\n        this.label = label;\n\t}\n\t\n\tinit() {\t\t\n\t}\n\n    async start():Promise<any> {\n        return await this.internalStart();\n    }\n\n    protected abstract internalStart():Promise<any>;\n\n    async end():Promise<any> {\n        await this.internalEnd()\n    }\n\n\trenderContent() {\t\t\n        let {name, type} = this._itemSchema;\n        let divValue:any;\n        let uiItem = this._uiItem;\n        let label:string, labelHide:boolean;\n        if (uiItem === undefined) {\n            label = name;\n        }\n        else {\n\t\t\tlabel = uiItem.label;\n\t\t\tlabelHide = uiItem.labelHide;\n            let templet = uiItem.Templet;\n            if (templet !== undefined) {\n                if (typeof templet === 'function') {\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\n\t\t\t\t}\n                else {\n\t\t\t\t\tdivValue = {templet};\n\t\t\t\t}\n            }\n            else if (this.value !== undefined) {\n                switch (uiItem.widget) {\n                    case 'radio':\n                    case 'select':\n                        let {list} = uiItem as UiSelectBase;\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\n                        break;\n                    case 'id':\n                        divValue = <b>no templet for {name}={this.value}</b>\n                        break;\n                }\n            }\n        }\n        if (divValue === undefined) {\n            switch (type) {\n                default:\n                    divValue = this.value? \n\t\t\t\t\t\t<b>{this.value}</b> \n\t\t\t\t\t\t:\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\n                    break;\n                case 'image':\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\n                    break;\n            }\n\t\t}\n\t\treturn divValue;\n\t}\n\n    protected async internalEnd():Promise<void> {nav.pop()}\n\n    protected verifyValue() {\n        if (this.uiItem === undefined) return;\n        let {rules} = this.uiItem;\n        if (rules === undefined) return;\n        let nv = this.newValue;\n        function verifyRule(rule:FieldRule, value: any):string {\n            let error = rule(nv);\n            if (error !== undefined) {\n                if (typeof error !== 'object')\n                    return error;\n                else\n                    return JSON.stringify(error);\n            }\n        }\n        if (Array.isArray(rules)) {\n            for (let rule of rules) {\n                let error = verifyRule(rule as FieldRule, nv);\n                if (error !== undefined) {\n                    this.error = error;\n                    break;\n                }\n            }\n        }\n        else {\n            this.error = verifyRule(rules as FieldRule, nv);\n        }\n    }\n}\n","import {bridgeCenterApi, isBridged} from './appBridge';\nimport {FetchError} from './fetchError';\nimport {HttpChannelUI} from './httpChannelUI';\nimport {nav} from '../components/nav';\nimport { Caller } from './caller';\nimport { env } from '../tool';\n\n/*\nexport async function httpGet(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.get('', params);\n    return ret;\n}\n\nexport async function httpPost(url:string, params?:any):Promise<any> {\n    let channel = new HttpChannel(false, url, undefined, undefined);\n    let ret = await channel.post('', params);\n    return ret;\n}\n*/\n\nconst methodsWithBody = ['POST', 'PUT'];\n\nexport abstract class HttpChannel {\n    private timeout: number;\n    protected ui?: HttpChannelUI;\n    protected hostUrl: string;\n    protected apiToken: string;\n\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\n        this.hostUrl = hostUrl;\n        this.apiToken = apiToken;\n        this.ui = ui;\n        this.timeout = env.isDevelopment === true? 500000:50000;\n    }\n\n    private startWait = (waiting: boolean) => {\n        if (waiting === true) {\n            if (this.ui !== undefined) this.ui.startWait();\n        }\n    }\n\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\n        if (this.ui !== undefined) this.ui.endWait();\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\n    }\n\n    private showError = async (error:FetchError) => {\n        if (this.ui !== undefined) await this.ui.showError(error);\n    }\n\n    used() {\n        this.post('', {});\n    }\n\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\n        let options = this.buildOptions();\n        let {headers, path, method} = caller;\n        if (headers !== undefined) {\n            let h = options.headers;\n            for (let i in headers) {\n                h.append(i, encodeURI(headers[i]));\n            }\n        }\n        options.method = method;\n        let p = caller.buildParams();\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\n            options.body = JSON.stringify(p)\n        }\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\n    }\n\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\n        let ret = await this.innerFetch(url, options, waiting);\n        return ret.res;\n    }\n\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\n        if (params) {\n            let keys = Object.keys(params);\n            if (keys.length > 0) {\n                let c = '?';\n                for (let k of keys) {\n                    let v = params[k];\n                    if (v === undefined) continue;\n                    url += c + k + '=' + params[k];\n                    c = '&';\n                }\n            }\n        }\n        let options = this.buildOptions();\n        options.method = 'GET';\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'POST';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'PUT';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\n        let options = this.buildOptions();\n        options.method = 'DELETE';\n        options.body = JSON.stringify(params);\n        return await this.innerFetchResult(url, options, waiting);\n    }\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\n        let that = this;\n        this.startWait(waiting);\n        let path = url;\n        function buildError(err: any, ex?: string) {\n            switch (typeof err) {\n                case 'string':\n                    if (ex !== undefined) err += ' ' + ex;\n                    break;\n                case 'object':\n                    let keys = Object.keys(err);\n                    let retErr:any = {\n                        ex: ex,\n                    };\n                    for (let key of keys) {\n                        retErr[key] = err[key];\n                    }\n                    err = retErr;\n                    break;\n            }\n            return {\n                channel: that,\n                url: path,\n                options: options,\n                resolve: resolve,\n                reject: reject,\n                error: err,\n            }\n        }\n        try {\n            console.log('%s-%s %s', options.method, path, options.body || '');\n            let now = Date.now();\n            let timeOutHandler = env.setTimeout(\n                undefined, //'httpChannel.fetch',\n                () => {\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\n                },\n                this.timeout);\n            let res = await fetch(encodeURI(path), options);\n            if (res.ok === false) {\n                env.clearTimeout(timeOutHandler);\n                console.log('ok false endWait');       \n                that.endWait();\n                console.log('call error %s', res.statusText);\n                throw res.statusText;\n            }\n            let ct = res.headers.get('content-type');\n            if (ct && ct.indexOf('json')>=0) {\n                return res.json().then(async retJson => {\n                    env.clearTimeout(timeOutHandler);\n                    that.endWait();\n                    if (retJson.ok === true) {\n                        if (typeof retJson !== 'object') {\n                            debugger;\n                        }\n                        else if (Array.isArray(retJson) === true) {\n                            debugger;\n                        }\n                        return resolve(retJson);\n                    }\n                    let retError = retJson.error;\n                    if (retError === undefined) {\n                        await that.showError(buildError('not valid tonva json'));\n                    }\n                    else {\n                        await that.showError(buildError(retError, 'retJson.error'));\n                        reject(retError);\n                    }\n                }).catch(async error => {\n                    await that.showError(buildError(error, 'catch res.json()'));\n                });\n            }\n            else {\n                let text = await res.text();\n                env.clearTimeout(timeOutHandler);\n                console.log('text endWait');\n                that.endWait();\n                resolve(text);\n            }\n        }\n        catch(error) {\n            this.endWait(url, reject);\n            if (typeof error === 'string') {\n                let err = error.toLowerCase();\n                if (err.startsWith('unauthorized') === true) {\n                    nav.logout();\n                    return;\n                }\n            }\n            console.error('fecth error (no nav.showError): ' + url);\n            // await this.showError(buildError(error, 'catch outmost'));\n        };\n    }\n\n    protected abstract async innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\n\n    async callFetch(url:string, method:string, body:any):Promise<any> {\n        let options = this.buildOptions();\n        options.method = method;\n        options.body = body;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(url, options, true, resolve, reject);\n        });\n    }\n\n    private buildOptions(): {method:string; headers:Headers; body:any} {\n        let headers = this.buildHeaders();\n        let options = {\n            headers: headers,\n            method: undefined as any,\n            body: undefined as any,\n            // cache: 'no-cache',\n        };\n        return options;\n    }\n\n    protected buildHeaders():Headers {\n        let {language, culture} = nav;\n        let headers = new Headers();\n        //headers.append('Access-Control-Allow-Origin', '*');\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\n        let lang = language;\n        if (culture) lang += '-' + culture;\n        headers.append('Accept-Language', lang);\n        if (this.apiToken) { \n            headers.append('Authorization', this.apiToken); \n        }\n        return headers;\n    }\n}\n\nexport class CenterHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        if (this.apiToken === undefined && isBridged())\n            return await bridgeCenterApi(u, options.method, options.body);\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n\nexport class UqHttpChannel extends HttpChannel {\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\n        let u = this.hostUrl + url;\n        return await new Promise<any>(async (resolve, reject) => {\n            await this.fetch(u, options, waiting, resolve, reject);\n        });\n    }\n}\n","import {nav} from '../components/nav';\nimport {FetchError} from './fetchError';\n\nexport interface HttpChannelUI {\n    startWait():void;\n    endWait():void;\n    showError(error:FetchError):Promise<void>;\n    showUpgradeUq(uq:string, version:number):Promise<void>;\n}\n\nexport class HttpChannelNavUI implements HttpChannelUI {\n    startWait() {\n        nav.startWait();\n    }\n    endWait() {\n        nav.endWait();\n    }\n    async showError(error:FetchError):Promise<void> {\n        nav.endWait();\n        /*\n        if (error.name === 'SyntaxError') {\n            error = {\n                name: error.name,\n                message: error.message,\n            }\n        }*/\n        await nav.onError(error);\n    }\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\n        await nav.showUpgradeUq(uq, version);\n    }\n}\n\n","import _ from 'lodash';\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\nimport {HttpChannelNavUI} from './httpChannelUI';\nimport {appUq, logoutUqTokens, buildAppUq} from './appBridge';\nimport {ApiBase} from './apiBase';\nimport { host } from './host';\nimport { LocalMap, env } from '../tool';\nimport {decodeUserToken} from '../tool/user';\n\nlet channelUIs:{[name:string]: HttpChannel} = {};\nlet channelNoUIs:{[name:string]: HttpChannel} = {};\n\nexport function logoutApis() {\n    channelUIs = {};\n    channelNoUIs = {};\n    logoutUnitxApis();\n    logoutUqTokens();\n}\n\ninterface UqLocal {\n    user: number;\n    unit: number;\n    value: any;\n    tick?: number;\n    isNet?: boolean;\n}\ninterface UqLocals {\n    user: number;\n    unit: number;\n    uqs: {[uq:string]: UqLocal};\n}\n/*\nconst uqLocalEntities = 'uqLocalEntities';\nclass CacheUqLocals {\n    private local:UqLocals;\n\n    async loadAccess(uqApi: UqApi):Promise<any> {\n        try {\n            let {uqOwner, uqName} = uqApi;\n            if (this.local === undefined) {\n                let ls = null; // localStorage.getItem(uqLocalEntities);\n                if (ls !== null) {\n                    this.local = JSON.parse(ls);\n                }\n            }\n            if (this.local !== undefined) {\n                let {user, uqs} = this.local;\n                if (user !== loginedUserId || uqs === undefined) {\n                    this.local = undefined;\n                }\n                else {\n                    for (let i in uqs) {\n                        let ul = uqs[i];\n                        ul.isNet = undefined;\n                    }\n                }\n            }\n            if (this.local === undefined) {\n                this.local = {\n                    user: loginedUserId,\n                    unit: undefined,\n                    uqs: {}\n                };\n            }\n\n            let ret: any;\n            let un = uqOwner+'/'+uqName;\n            let uq = this.local.uqs[un];\n            if (uq !== undefined) {\n                let {value} = uq;\n                ret = value;\n            }\n            if (ret === undefined) {\n                ret = await uqApi.__loadAccess();\n                //this.saveLocal(un, ret);\n            }\n            return _.cloneDeep(ret);\n        }\n        catch (err) {\n            this.local = undefined;\n            localStorage.removeItem(uqLocalEntities);\n            throw err;\n        }\n    }\n\n    private saveLocal(uqName:string, accessValue: any) {\n        this.local.uqs[uqName] = {\n            value: accessValue,\n            isNet: true,\n        }\n        let str = JSON.stringify(this.local);\n        localStorage.setItem(uqLocalEntities, str);\n    }\n\n    async checkAccess(uqApi: UqApi):Promise<boolean> {\n        if (this.local === undefined) return false;\n        let {uqOwner, uqName} = uqApi;\n        let un = uqOwner+'/'+uqName;\n        let uq = this.local.uqs[un];\n        if (uq === undefined) return false;\n        let {isNet, value} = uq;\n        if (isNet === true) return true;\n        let ret = await uqApi.__loadAccess();\n        let isMatch = _.isMatch(value, ret);\n        if (isMatch === false) {\n            this.saveLocal(un, ret);\n            return false;\n        }\n        uq.isNet = true;\n        return true;\n    }\n}\n\nconst localUqs = new CacheUqLocals;\n*/\nexport class UqApi extends ApiBase {\n    private access:string[];\n    appOwner:string;\n    appName:string;\n    uqOwner: string;\n    uqName: string;\n    uq: string;\n\n    constructor(basePath:string, appOwner:string, appName:string, uqOwner:string, uqName:string, access:string[], showWaiting?: boolean) {\n        super(basePath, showWaiting);\n        this.appOwner = appOwner;\n        this.appName = appName;\n        if (uqName) {\n            this.uqOwner = uqOwner;\n            this.uqName = uqName;\n            this.uq = uqOwner + '/' + uqName;\n        }\n        this.access = access;\n        this.showWaiting = showWaiting;\n    }\n\n    //setUqVersion(uqVersion:number) {this.uqVersion = undefined}\n\n    async init() {\n        await buildAppUq(this.uq, this.uqOwner, this.uqName, this.appOwner, this.appName);\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channels: {[name:string]: HttpChannel};\n        let channelUI: HttpChannelNavUI;\n        if (this.showWaiting === true || this.showWaiting === undefined) {\n            channels = channelUIs;\n            channelUI = new HttpChannelNavUI();\n        }\n        else {\n            channels = channelNoUIs;\n        }\n        let channel = channels[this.uq];\n        if (channel !== undefined) return channel;\n        let uqToken = appUq(this.uq); //, this.uqOwner, this.uqName);\n        if (!uqToken) {\n            //debugger;\n            await this.init();\n            uqToken = appUq(this.uq);\n        }\n        let {url, token} = uqToken;\n        this.token = token;\n        channel = new UqHttpChannel(url, token, channelUI);\n        return channels[this.uq] = channel;\n    }\n\n    /*async update():Promise<string> {\n        return await this.get('update');\n    }*/\n\n    /*\n    async __loadAccess():Promise<any> {\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n    */\n    async loadAccess():Promise<any> {\n        //return await localUqs.loadAccess(this);\n        let acc = this.access === undefined?\n            '' :\n            this.access.join('|');\n        let ret = await this.get('access', {acc:acc});\n        return ret;\n    }\n\n    /*async loadEntities():Promise<any> {\n        return await this.get('entities');\n    }*/\n\n    /*\n    async checkAccess():Promise<boolean> {\n        return await localUqs.checkAccess(this);\n    }\n    */\n\n    async schema(name:string):Promise<any> {\n        return await this.get('schema/' + name);\n    }\n\n    async queueModify(start:number, page:number, entities:string) {\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\n    }\n\n    /*async schemas(names:string[]):Promise<any[]> {\n        return await this.post('schema', names);\n    }*/\n\n    /*\n    async tuidGet(name:string, id:number):Promise<any> {\n        return await this.get('tuid/' + name + '/' + id);\n    }\n\n    async tuidGetAll(name:string):Promise<any[]> {\n        return await this.get('tuid-all/' + name + '/');\n    }\n\n    async tuidSave(name:string, params:any):Promise<any> {\n        return await this.post('tuid/' + name, params);\n    }\n\n    async tuidSearch(name:string, arr:string, owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        let ret = await this.post('tuids/' + name, {\n            arr: arr,\n            owner: owner,\n            key: key,\n            pageStart: pageStart,\n            pageSize: pageSize\n        });\n        return ret;\n    }\n    async tuidArrGet(name:string, arr:string, owner:number, id:number):Promise<any> {\n        return await this.get('tuid-arr/' + name + '/' + owner + '/' + arr + '/' + id);\n    }\n    async tuidArrGetAll(name:string, arr:string, owner:number):Promise<any[]> {\n        return await this.get('tuid-arr-all/' + name + '/' + owner + '/' + arr + '/');\n    }\n    async tuidArrSave(name:string, arr:string, owner:number, params:any):Promise<any> {\n        return await this.post('tuid-arr/' + name + '/' + owner + '/' + arr + '/', params);\n    }\n    async tuidArrPos(name:string, arr:string, owner:number, id:number, order:number):Promise<any> {\n        return await this.post('tuid-arr-pos/' + name + '/' + owner + '/' + arr + '/', {\n            id: id,\n            $order: order\n        });\n    }\n\n    async tuidIds(name:string, arr:string, ids:number[]):Promise<any[]> {\n        try {\n            let url = 'tuidids/' + name + '/';\n            if (arr !== undefined) url += arr;\n            else url += '$';\n            let ret = await this.post(url, ids);\n            return ret;\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n    */\n    /*async sheetSave(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name, data);\n    }*/\n\n    /*async sheetAction(name:string, data:object) {\n        return await this.put('sheet/' + name, data);\n    }*/\n\n    /*async stateSheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/states', data);\n    }*/\n\n    /*async stateSheetCount(name:string):Promise<any> {\n        return await this.get('sheet/' + name + '/statecount');\n    }*/\n\n    /*async mySheets(name:string, data:object) {\n        return await this.post('sheet/' + name + '/my-sheets', data);\n    }*/\n\n    /*async getSheet(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/get/' + id);\n    }*/\n\n    /*async sheetArchives(name:string, data:object):Promise<any> {\n        return await this.post('sheet/' + name + '/archives', data);\n    }\n\n    async sheetArchive(name:string, id:number):Promise<any> {\n        return await this.get('sheet/' + name + '/archive/' + id);\n    }*/\n\n    /*async action(name:string, data:object):Promise<any> {\n        return await this.post('action/' + name, data);\n    }\n\n    async actionReturns(name:string, data:object):Promise<any[][]> {\n        return await this.post('action/' + name + '/returns', data);\n    }\n\n    async page(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p:any;\n        switch (typeof params) {\n            case 'undefined': p = {key: ''}; break;\n            default: p = _.clone(params); break;\n        }\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        return await this.post('query-page/' + name, p);\n    }\n\n    async query(name:string, params:any):Promise<any> {\n        let ret = await this.post('query/' + name, params);\n        return ret;\n    }\n    */\n/*\n    async history(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n\n    async book(name:string, pageStart:any, pageSize:number, params:any):Promise<string> {\n        let p = _.clone(params);\n        p['$pageStart'] = pageStart;\n        p['$pageSize'] = pageSize;\n        let ret = await this.post('history/' + name, p);\n        return ret;\n    }\n*/\n    /*async user():Promise<any> {\n        return await this.get('user');\n    }*/\n}\n\nlet channels:{[unitId:number]: HttpChannel} = {};\n\nexport function logoutUnitxApis() {\n    channels = {};\n}\n\nexport class UnitxApi extends UqApi {\n    private unitId:number;\n    constructor(unitId:number) {\n        super('tv/', undefined, undefined, undefined, undefined, undefined, true);\n        this.unitId = unitId;\n    }\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        let channel = channels[this.unitId];\n        if (channel !== undefined) return channel;\n        return channels[this.unitId] = await this.buildChannel();\n    }\n\n    private async buildChannel():Promise<HttpChannel> {\n        let channelUI = new HttpChannelNavUI();\n        let centerAppApi = new CenterAppApi('tv/', undefined);\n        let ret = await centerAppApi.unitxUq(this.unitId);\n        let {token, db, url, urlTest} = ret;\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\n        this.token = token;\n        return new UqHttpChannel(realUrl, token, channelUI);\n    }\n}\n\nlet centerHost:string;\n\nexport function setCenterUrl(url:string) {\n    console.log('setCenterUrl %s', url);\n    centerHost = url;\n    //centerToken = undefined;\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nexport let centerToken:string|undefined = undefined;\n\nlet loginedUserId:number = 0;\nexport function setCenterToken(userId:number, t?:string) {\n    loginedUserId = userId;\n    centerToken = t;\n    console.log('setCenterToken %s', t);\n    centerChannel = undefined;\n    centerChannelUI = undefined;\n}\n\nlet centerChannelUI:HttpChannel;\nlet centerChannel:HttpChannel;\nfunction getCenterChannelUI():HttpChannel {\n    if (centerChannelUI !== undefined) return centerChannelUI;\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\n}\nfunction getCenterChannel():HttpChannel {\n    if (centerChannel !== undefined) return centerChannel;\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\n}\n\nexport abstract class CenterApiBase extends ApiBase {\n    /*\n    constructor(path: string, showWaiting?: boolean) {\n        super(path, showWaiting);\n    }*/\n\n    protected async getHttpChannel(): Promise<HttpChannel> {\n        return (this.showWaiting === true || this.showWaiting === undefined)?\n            getCenterChannelUI():\n            getCenterChannel();\n    }\n}\n\nconst uqTokensName = 'uqTokens';\nexport class UqTokenApi extends CenterApiBase {\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\n\n    async uq(params: {unit:number, uqOwner:string, uqName:string, appOwner:string, appName:string}):Promise<any> {\n        let {uqOwner, uqName} = params;\n        let un = uqOwner+'/'+uqName;\n        let localCache = this.localMap.child(un);\n        try {\n            let uqToken:UqLocal = localCache.get();\n            if (uqToken !== undefined) {\n                let {unit, user} = uqToken;\n                if (unit !== params.unit || user !== loginedUserId) {\n                    localCache.remove();\n                    uqToken = undefined;\n                }\n            }\n            let nowTick = Math.floor(Date.now() / 1000);\n            if (uqToken !== undefined) {\n                let {tick, value} = uqToken;\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\n                    return _.clone(value);\n                }\n            }\n            let appUqParams:any = _.clone(params);\n            appUqParams.testing = host.testing;\n            let ret = await this.get('app-uq', appUqParams);\n            if (ret === undefined) {\n                let {unit, uqOwner, uqName} = params;\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\n                throw err;\n            }\n\n            uqToken = {\n                unit: params.unit,\n                user: loginedUserId,\n                tick: nowTick,\n                value: ret,\n            }\n            localCache.set(uqToken);\n            return _.clone(ret);\n        }\n        catch (err) {\n            localCache.remove();\n            throw err;\n        }\n    }\n}\n\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\n\nexport class CallCenterApi extends CenterApiBase {\n    directCall(url:string, method:string, body:any):Promise<any> {\n        return this.call(url, method, body);\n    }\n}\nexport const callCenterapi = new CallCenterApi('', undefined);\n\nexport interface UqAppData {\n    appName: string;\n    appOwner: string;\n    id: number;\n    version: string;        // AppUI version\n    uqs: UqData[];\n}\n\nexport interface UqData {\n    id: number;\n    uqOwner: string;\n    uqName: string;\n    access: string;\n    newVersion: boolean;\n}\n\nexport interface UqServiceData {\n    id: number;\n    db: string;\n    url: string;\n    urlTest: string;\n    token: string;\n}\n\n//const appUqsName = 'appUqs';\n\nexport class CenterAppApi extends CenterApiBase {\n    //private local: LocalCache = env.localDb.item(appUqsName);\n    //private cachedUqs: UqAppData;\n    async uqs(appOwner:string, appName:string):Promise<UqAppData> {\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n        return ret;\n        /*\n        let ret:UqAppData;\n        let appUqs = this.local.get();\n        if (appUqs) {\n            let {appOwner:rAppOwner, appName:rAppName} = appUqs;\n            if (appOwner === rAppOwner && appName === rAppName) ret = appUqs;\n        }\n        if (ret === undefined) {\n            ret = await this.uqsPure(appOwner, appName);\n            ret.appName = appName;\n            ret.appOwner = appOwner;\n            //localStorage.setItem(JSON.stringify(obj));\n            this.local.set(ret);\n        }\n        //return this.cachedUqs = _.cloneDeep(ret);\n        return ret;\n        */\n    }\n    private async uqsPure(appOwner:string, appName:string):Promise<UqAppData> {\n        return await this.get('tie/app-uqs', {appOwner:appOwner, appName:appName});\n    }\n    /*\n    private async isOkCheckUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.uqsPure(appOwner, appName);\n        let {id:cachedId, uqs:cachedUqs} = this.local.get(); //.cachedUqs;\n        let {id:retId, uqs:retUqs} = ret;\n        if (cachedId !== retId) return false;\n        if (cachedUqs.length !== retUqs.length) return false;\n        let len = cachedUqs.length;\n        for (let i=0; i<len; i++) {\n            if (_.isMatch(cachedUqs[i], retUqs[i]) === false) return false;\n        }\n        return true;\n    }\n    async checkUqs(appOwner:string, appName:string):Promise<boolean> {\n        let ret = await this.isOkCheckUqs(appOwner, appName);\n        if (ret === false) {\n            this.local.remove();\n            nav.start();\n        }\n        return ret;\n    }\n    */\n    async unitxUq(unit:number):Promise<UqServiceData> {\n        return await this.get('tie/unitx-uq', {unit:unit});\n    }\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\n        return await this.post('tie/change-password', param);\n    }\n}\n\nexport async function loadAppUqs(appOwner:string, appName:string): Promise<UqAppData> {\n    let centerAppApi = new CenterAppApi('tv/', undefined);\n    //let unit = meInFrame.unit;\n    let ret = await centerAppApi.uqs(appOwner, appName);\n    //await centerAppApi.checkUqs(appOwner, appName);\n    /*\n    .then(v => {\n        if (v === false) {\n            localStorage.removeItem(appUqs);\n            nav.start();\n        }\n    });\n    */\n    return ret;\n}\n\n//import { nav } from '../ui';\n\nexport interface RegisterParameter {\n    nick:string, \n    user:string, \n    pwd:string,\n    country:number, \n    mobile:number, \n    mobileCountry:number,\n    email:string,\n    verify:string,\n};\n\nexport class UserApi extends CenterApiBase {\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\n        //(params as any).device = nav.local.device.get();\n        let ret = await this.get('user/login', params);\n        switch (typeof ret) {\n            default: return;\n            case 'string': return decodeUserToken(ret);\n            case 'object':\n                let token = ret.token;\n                let user = decodeUserToken(token);\n                let {nick, icon} = ret;\n                if (nick) user.nick = nick;\n                if (icon) user.icon = icon;\n                return user;\n        }\n        // !== undefined) return decodeToken(token);\n    }\n    async register(params: RegisterParameter): Promise<any>\n    {\n        return await this.post('user/register', params);\n    }\n\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\n    }\n\n    async checkVerify(account:string, verify:string) {\n        return await this.post('user/check-verify', {account:account, verify:verify});\n    }\n\n    async isExists(account:string) {\n        return await this.get('user/is-exists', {account:account});\n    }\n\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\n        return await this.post('user/reset-password', {account:account, password, verify, type});\n    }\n    \n    async userSetProp(prop:string, value:any) {\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\n    }\n\n    async me():Promise<any> {\n        return await this.get('tie/me');\n    }\n\n    async user(id:number): Promise<any> {\n        return await this.get('tie/user', {id:id});\n\t}\n\t\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\n\t\treturn await this.get('tie/user-from-key', {key});\n\t}\n}\n\nexport const userApi = new UserApi('tv/', undefined);\n","\nlet subAppWindow:Window;\nfunction postWsToSubApp(msg:any) {\n    if (subAppWindow === undefined) return;\n    subAppWindow.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport function setSubAppWindow(win:Window) {\n    subAppWindow = win;\n}\n\nexport function postWsToTop(msg:any) {\n    window.top.postMessage({\n        type: 'ws',\n        msg: msg\n    }, '*');\n}\n\nexport abstract class WsBase {\n    wsBaseId:string;\n    private handlerSeed = 1;\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.anyHandlers[seed] = handler;\n        return seed;\n    }\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\n        let seed = this.handlerSeed++;\n        this.msgHandlers[seed] = {type:type, handler: handler};\n        return seed;\n    }\n    endWsReceive(handlerId:number) {\n        delete this.anyHandlers[handlerId];\n        delete this.msgHandlers[handlerId];\n    }\n    async receive(msg:any) {\n        let {$type} = msg;\n        for (let i in this.anyHandlers) {\n            await this.anyHandlers[i](msg);\n        }\n        for (let i in this.msgHandlers) {\n            let {type, handler} = this.msgHandlers[i];\n            if (type !== $type) continue;\n            await handler(msg);\n        }\n    }\n}\n\nlet wsBaseSeed = 1;\nexport class WsBridge extends WsBase {\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\n}\n\nexport const wsBridge = new WsBridge();\n\nexport class WSChannel extends WsBase {\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\n    static centerToken:string;\n    private wsHost: string;\n    private token: string;\n    private ws: WebSocket;\n\n    constructor(wsHost: string, token: string) {\n        super();\n        this.wsHost = wsHost;\n        this.token = token;\n    }\n\n    static setCenterToken(token?: string) {\n        WSChannel.centerToken = token;\n    }\n    \n    connect():Promise<void> {\n        //this.wsHost = wsHost;\n        //this.token = token || WSChannel.centerToken;\n        if (this.ws !== undefined) return;\n        let that = this;\n        return new Promise((resolve, reject) => {\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\n            console.log('connect webSocket %s', this.wsHost);\n            ws.onopen = (ev) => {\n                console.log('webSocket connected %s', this.wsHost);\n                that.ws = ws;\n                resolve();\n            };\n            ws.onerror = (ev) => {\n                reject('webSocket can\\'t open!');\n            };\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\n            ws.onclose = (ev) => {\n                that.ws = undefined;\n                console.log('webSocket closed!');\n            }\n        });\n    }\n    close() {\n        if (this.ws !== undefined) {\n            this.ws.close();\n            this.ws = undefined;\n        }\n    }\n    private async wsMessage(event:any):Promise<void> {\n        try {\n            console.log('websocket message: %s', event.data);\n            let msg = JSON.parse(event.data);\n            postWsToSubApp(msg);\n            await this.receive(msg);\n        }\n        catch (err) {\n            console.log('ws msg error: ', err);\n        }\n    }\n    sendWs(msg:any) {\n        let netThis = this;\n        this.connect().then(() => {\n            netThis.ws.send(msg);\n        });\n    }\n}\n","import _ from 'lodash';\n\nexport interface KeyValueRes {\n    [key:string]: any;\n}\n\nexport interface Res<T extends KeyValueRes> {\n    [lang:string]: T | {[district:string]: T};\n}\n\nexport const resOptions:{\n\tlang: string;\n\t$lang: string;\n\tdistrict: string;\n\t$district: string;\n} = {\n\tlang: undefined,\n\t$lang: undefined,\n\tdistrict: undefined,\n\t$district: undefined,\n}\n\nexport function setResOptions(lang:string, district:string) {\n\tresOptions.lang = lang;\n\tresOptions.$lang = '$' + lang;\n    resOptions.district = district;\n    resOptions.$district = '$' + district;\n}\n\n(function() {\n    let lang: string, district: string;\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\n        || navigator.language; // ||   // All browsers\n    //navigator.userLanguage; // IE <= 10\n    if (!language) {\n        lang = 'zh';\n        district = 'CN';\n    }\n    else {\n        let parts = language.split('-');\n        lang = parts[0];\n        if (parts.length > 1) district = parts[1].toUpperCase();\n    }\n    setResOptions(lang, district);\n}());\n\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\n    let {lang, district} = resOptions;\n    let ret:T = {} as T;\n    if (res === undefined) return ret;\n    _.merge(ret, res._);\n    let l = res[lang];\n    if (l === undefined) return ret;\n    _.merge(ret, l._);\n    let d = l[district];\n    if (d === undefined) return ret;\n    _.merge(ret, d);\n    let {entity} = ret;\n    if (entity !== undefined) {\n        for (let i in entity) {\n            entity[i.toLowerCase()] = entity[i];\n        }\n    }\n    return ret;\n}\n\nconst resGlobal:any = {};\nexport function setRes(target: any, res: any):(str:string)=>any {\n\tif (res === undefined) return;\n\tlet {$lang, $district} = resOptions;\n\t_.merge(target, res);\n\tif ($lang !== undefined) {\n\t\tlet l = res[$lang];\n\t\tif (l !== undefined) {\n\t\t\t_.merge(target, l);\n\t\t\tlet d = l[$district];\n\t\t\tif (d !== undefined) {\n\t\t\t\t_.merge(target, d);\n\t\t\t}\n\t\t}\n\t}\n\treturn function(str:string) {\n\t\treturn target[str] || str;\n\t}\n}\nexport function setGlobalRes(res: any) {\n\tsetRes(resGlobal, res);\n}\nexport function t(str:string):any {\n\treturn resGlobal[str] || str;\n}\n","import * as React from 'react';\nimport _ from 'lodash';\nimport {nav, Page, resOptions} from '../components';\nimport { User, env } from '../tool';\nimport { VPage } from './vpage';\nimport { View } from './view';\n\nexport interface ConfirmOptions {\n    caption?: string;\n    message: string | JSX.Element;\n    classNames?: string;\n    ok?: string;\n    yes?: string;\n    no?: string;\n}\n\nexport abstract class Controller {\n    readonly res: any;\n\treadonly x: any;\n\tprivate _t: any = {};\n\treadonly t: (str:string)=>any;\n    icon: string|JSX.Element;\n    label:string;\n    readonly isDev:boolean = env.isDevelopment;\n    get user():User {return nav.user}\n    get isLogined():boolean {\n        let {user} = nav;\n        if (user === undefined) return false;\n        return user.id > 0;\n    }\n    constructor(res:any) {\n        this.res = res || {};\n\t\tthis.x = this.res.x || {};\n\t\tthis.t = (str:string):any => this.internalT(str) || str;\n\t}\n\n\tinit(param?: any) {}\n\n\tinternalT(str:string):any {\n\t\treturn this._t[str];\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tif (res === undefined) return;\n\t\tlet {$lang, $district} = resOptions;\n\t\t_.merge(this._t, res);\n\t\tif ($lang !== undefined) {\n\t\t\tlet l = res[$lang];\n\t\t\tif (l !== undefined) {\n\t\t\t\t_.merge(this._t, l);\n\t\t\t\tlet d = l[$district];\n\t\t\t\tif (d !== undefined) {\n\t\t\t\t\t_.merge(this._t, d);\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t}\n\n    private receiveHandlerId:number;\n    private disposer:()=>void;\n\n    private dispose = () => {\n        // message listener的清理\n        nav.unregisterReceiveHandler(this.receiveHandlerId);\n        this.onDispose();\n    }\n\n    protected onDispose() {\n    }\n\n\tisMe(id:any):boolean {\n\t\tif (id === null) return false;\n\t\tlet {user} = this;\n\t\tlet userId = user.id;\n\t\tswitch (typeof id) {\n\t\t\tdefault: return false;\n\t\t\tcase 'string': return Number(id) === userId;\n\t\t\tcase 'number': return id === userId;\n\t\t\tcase 'object': return id.id === userId;\n\t\t}\n\t}\n\n    protected async openVPage<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:(ret:any)=>void):Promise<void> {\n        await (new vp((this as any) as C)).open(param, afterBack);\n    }\n\n    protected renderView<C extends Controller>(view: new (controller: C)=>View<C>, param?:any) {\n        return (new view((this as any) as C)).render(param);\n    }\n\n    async event(type:string, value:any) {\n        await this.onEvent(type, value);\n    }\n\n    protected async onEvent(type:string, value:any) {\n    }\n\n    protected msg(text:string) {\n        alert(text);\n    }\n    protected errorPage(header:string, err:any) {\n        this.openPage(<Page header=\"App error!\">\n            <pre>\n                {typeof err === 'string'? err : err.message}\n            </pre>\n        </Page>);\n    }\n\n    protected onMessage(message:any):Promise<void> {\n        return;\n    }\n\n    private onMessageReceive = async (message:any):Promise<void> => {\n        await this.onMessage(message);\n    }\n\n    protected async beforeStart():Promise<boolean> {\n        /*\n        console.log('this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);');\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n        console.log('return true');\n        */\n        return true;\n\t}\n\tprotected async afterStart():Promise<void> {\n\t}\n    protected registerReceiveHandler() {\n        this.receiveHandlerId = nav.registerReceiveHandler(this.onMessageReceive);\n    }\n\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\n    async start(param?:any, ...params:any[]):Promise<void> {\n        this.disposer = this.dispose;\n\t\tthis.registerReceiveHandler();\n        let ret = await this.beforeStart();\n        if (ret === false) return;\n\t\tawait this.internalStart(param, ...params);\n\t\tawait this.afterStart();\n    }\n\n    get isCalling():boolean {return this._resolve_$ !== undefined}\n\n    private _resolve_$:((value:any) => void)[];\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<T> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await this.start(param, ...params);\n        });\n    }\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\n        return new Promise<any> (async (resolve, reject) => {\n            this._resolve_$.push(resolve);\n            await (new vp(this as any)).open(param);\n        });\n    }\n\n    returnCall(value:any) {\n        if (this._resolve_$ === undefined) return;\n        let resolve = this._resolve_$.pop();\n        if (resolve === undefined) {\n            alert('the Controller call already returned, or not called');\n            return;\n        }\n        resolve(value);\n    }\n\n    openPage(page:JSX.Element, onClosePage?: ()=>void) {\n\t\tlet disposer: ()=>void;\n\t\tif (onClosePage !== undefined) {\n\t\t\tdisposer = () => {\n\t\t\t\tif (this.disposer) this.disposer();\n\t\t\t\tonClosePage();\n\t\t\t}\n\t\t}\n\n        nav.push(page, disposer);\n        this.disposer = undefined;\n    }\n\n    replacePage(page:JSX.Element) {\n        nav.replace(page, this.disposer);\n        this.disposer = undefined;\n    }\n\n    backPage() {\n        nav.back();\n    }\n\n    closePage(level?:number) {\n        nav.pop(level);\n    }\n\n    ceasePage(level?:number) {\n        nav.ceaseTop(level);\n\t}\n\t\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tnav.go(showPage, url, absolute);\n\t}\n\n    removeCeased() {\n        nav.removeCeased();\n    }\n\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        nav.regConfirmClose(confirmClose);\n\t}\n\n\tprivate topPageKey:any;\n\tprotected startAction() {\n\t\tthis.topPageKey = nav.topKey();\n\t}\n\tpublic popToTopPage() {\n\t\tnav.popTo(this.topPageKey);\n\t}\n\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\n            let {caption, message, ok, yes, no, classNames} = options;\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\n                this.closePage();\n                resolve(res);\n            }\n            let buttons:any[] = [];\n            if (ok !== undefined) {\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary mr-3\" onClick={()=>close('ok')}>{ok}</button>);\n            }\n            if (yes !== undefined) {\n                buttons.push(<button key=\"yes\" className=\"btn btn-success mr-3\" onClick={()=>close('yes')}>{yes}</button>);\n            }\n            if (no !== undefined) {\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger mr-3\" onClick={()=>close('no')}>{no}</button>);\n            }\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\n                    <div className=\"d-flex align-items-center justify-content-center\">\n                        {message}\n                    </div>\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\n                        {buttons}\n                    </div>\n                </div>\n            </Page>);\n            nav.regConfirmClose(async ():Promise<boolean> => {\n                resolve(undefined);\n                return true;\n            });\n        });\n    }\n}\n","import * as React from 'react';\nimport { Page, Image, UserView } from '../components';\nimport { env, User } from '../tool';\nimport { Controller } from './controller';\nimport { VPage } from './vpage';\n\nexport abstract class View<C extends Controller> {\n    protected controller: C;\n    protected readonly res: any;\n\tprotected readonly x: any;\n\tprotected readonly t: (str:string)=>any;\n\n    constructor(controller: C) {\n        this.controller = controller;\n        this.res = controller.res;\n\t\tthis.x = controller.x;\n\t\tthis.t = controller.t;\n    }\n\n\tprotected get isDev() {return  env.isDevelopment}\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\n    abstract render(param?:any): JSX.Element;\n\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\n        return (new vm(this.controller)).render(param);\n    }\n\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\n        await (new vp(this.controller)).open(param, afterBack);\n    }\n\n    protected async event(type:string, value?:any) {\n        await this.controller.event(type, value);\n\t}\n\t\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\n\t\tthis.controller.go(showPage, url, absolute);\n\t}\n\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\n        return await this.controller.vCall(vp, param);\n    }\n\n    protected returnCall(value:any) {\n        this.controller.returnCall(value);\n    }\n\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c mr-2'} />\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderUserText(user:any) {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick} = user;\n\t\t\treturn <>{nick || name}</>;\n\t\t}\n\t\treturn <UserView user={user} render={renderUser} />\n\t}\n\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\n\t\tlet {user} = this.controller;\n\t\tif (!user) return;\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\n\t}\n\n    protected openPage(view: React.StatelessComponent<any>, param?:any) {\n        let type = typeof param;\n        if (type === 'object' || type === 'undefined') {\n            this.controller.openPage(React.createElement(view, param));\n        }\n        else {\n            this.controller.openPage(<Page header=\"param type error\">\n                View.openPage param must be object, but here is {type}\n            </Page>);\n        }\n    }\n\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\n        this.controller.replacePage(React.createElement(view, param));\n    }\n\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\n        this.controller.openPage(page, onClosePage);\n    }\n\n    protected replacePageElement(page: JSX.Element) {\n        this.controller.replacePage(page);\n    }\n\n    protected backPage() {\n        this.controller.backPage();\n    }\n\n    protected closePage(level?:number) {\n        this.controller.closePage(level);\n    }\n\n    protected ceasePage(level?:number) {\n        this.controller.ceasePage(level);\n    }\n\n    protected removeCeased() {\n        this.controller.removeCeased();\n    }\n\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\n        this.controller.regConfirmClose(confirmClose);\n\t}\n\n\tprotected popToTopPage() {\n\t\tthis.controller.popToTopPage();\n\t}\n}\n","import * as React from 'react';\nimport { Page, Scroller, TabsProps } from \"../components\";\nimport { View } from \"./view\";\nimport { Controller } from \"./controller\";\n\nexport abstract class VPage<C extends Controller> extends View<C> {\n\tprotected retOnClosePage: any;\n\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\n\t\tthis.init(param);\n\t\tlet _onClosePage: ()=>void;\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\n\t\treturn;\n\t}\n\n\trender(param?:any):JSX.Element {\n\t\tthis.init(param);\n\t\treturn this.renderPage();\n\t}\n\n\tinit(param?:any):void {return;}\n\n\theader():string|boolean|JSX.Element {return null;}\n\tright():JSX.Element {return null;}\n\tcontent():JSX.Element {return null;}\n\tfooter():JSX.Element {return null;}\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\n\tprotected renderPage():JSX.Element {\n\t\tlet header = this.header();\n\t\tif (!header) header = false;\n\t\treturn <Page\n\t\t\theader={header} right={this.right()} footer={this.footer()}\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\n\t\t\tback={this.back}\n\t\t\theaderClassName={this.headerClassName}\n\t\t\tclassName={this.className}\n\t\t\tafterBack={()=>this.afterBack()}\n\t\t\ttabsProps={this.tabsProps}\n\t\t\tlogout={this.logout()}\n\t\t>\n\t\t\t{this.content()}\n\t\t</Page>;\n\t}\n\n\tprotected onPageScroll(e:any) {}\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\n\tprotected afterBack():void {}\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\n\tprotected get headerClassName(): string {return null;}\n\tprotected get className(): string {return null;}\n\tprotected get tabsProps(): TabsProps {return null;}\n}\n","export * from './uqMan';\nexport * from './entity';\nexport * from './action';\nexport * from './query';\nexport * from './sheet';\nexport * from './tuid';\nexport * from './book';\nexport * from './map';\nexport * from './history';\nexport * from './pending';\nexport * from './uqsMan';\nexport * from './tag/tag';\n","import _ from 'lodash';\nimport {observable, IObservableArray} from 'mobx';\nimport { PageItems } from '../tool';\nimport {Field, ArrFields} from './uqMan';\nimport {Entity} from './entity';\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\n\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\n\nexport class QueryPager<T extends any> extends PageItems<T> {\n\tprivate query: Query;\n\tprivate $page: any;\n\tprotected idFieldName: any;\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\n        super(itemObservable);\n        this.query = query;\n        if (pageSize !== undefined) this.pageSize = pageSize;\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\n\t}\n\n\tsetReverse() {\n\t\tthis.appendPosition = 'head';\n\t}\n\n    protected async onLoad() {\n\t\tif (this.$page) return;\n        let {schema} = this.query;\n        if (schema === undefined) {\n\t\t\tawait this.query.loadSchema();\n\t\t\tschema = this.query.schema;\n\t\t}\n\t\tif (schema === undefined) return;\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\n\t\tif ($page === undefined) return;\n\t\tthis.sortOrder = $page.order;\n\t\tlet fields = $page.fields;\n\t\tif (fields !== undefined) {\n\t\t\tlet field = fields[0];\n\t\t\tif (field) this.idFieldName = field.name;\n\t\t}\n    }\n\n    protected async loadResults(param:any, pageStart:number, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.query.page(param, pageStart, pageSize);\n\t\treturn ret;\n\t}\n\tprotected getPageId(item:T) {\n\t\tif (item === undefined) return;\n\t\tif (typeof item === 'number') return item;\n\t\tlet start = (item as any)[this.idFieldName];\n\t\tif (start === null) return;\n\t\tif (start === undefined) return;\n\t\tif (typeof start === 'object') {\n\t\t\tlet id = start.id;\n\t\t\tif (id !== undefined) return id;\n\t\t}\n\t\treturn start;\n\t}\n\tasync refreshItems(item:T) {\n\t\tlet index = this._items.indexOf(item);\n\t\tif (index < 0) return;\n\t\tlet startIndex:number;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\tstartIndex = index - 1;\n\t\t}\n\t\telse {\n\t\t\tstartIndex = index + 1;\n\t\t}\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\n\t\tlet pageSize = 1;\n        let ret = await this.load(\n\t\t\tthis.param, \n\t\t\tpageStart,\n\t\t\tpageSize);\n\t\tlet len = ret.length;\n\t\tif (len === 0) {\n\t\t\tthis._items.splice(index, 1);\n\t\t\treturn;\n\t\t}\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet newItem = ret[i];\n\t\t\tif (!newItem) continue;\n\t\t\tlet newId = newItem[this.idFieldName];\n\t\t\tif (newId === undefined || newId === null) continue;\n\t\t\tif (typeof newId === 'object') newId = newId.id;\n\t\t\tlet oldItem = this._items.find(v => {\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\n\t\t\t\treturn oldId = newId;\n\t\t\t});\n\t\t\tif (oldItem) {\n\t\t\t\t_.merge(oldItem, newItem);\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport class Query extends Entity {\n    get typeName(): string { return 'query';}\n    private pageStart: any;\n    private pageSize:number;\n    private params:any;\n    private more: boolean;\n    private startField: Field;\n    @observable list:IObservableArray; // = observable.array([], {deep: false});\n    returns: ArrFields[];\n    isPaged: boolean;\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        let {returns} = schema;\n        //this.returns = returns;\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\n    }\n\n    resetPage(size:number, params:any) {\n        this.pageStart = undefined;\n        this.pageSize = size;\n        this.params = params;\n        this.more = false;\n        this.list = undefined;\n    }\n    get hasMore() {return this.more;}\n    async loadPage():Promise<void> {\n        if (this.pageSize === undefined) {\n            throw new Error('call resetPage(size:number, params:any) first');\n        }\n        let pageStart:any;\n        if (this.pageStart !== undefined) {\n            switch (this.startField.type) {\n                default: pageStart = this.pageStart; break;\n                case 'date':\n                case 'time':\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\n            }\n        }\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\n\t\tlet page = ret.$page;\n        /*\n        await this.loadSchema();\n        let res = await this.tvApi.page(this.name, pageStart, this.pageSize+1, this.params);\n        let data = await this.unpackReturns(res);\n        let page = data['$page'] as any[];\n        */\n        this.list = observable.array([], {deep: false});\n        if (page !== undefined) {\n            if (page.length > this.pageSize) {\n                this.more = true;\n                page.pop();\n                let ret = this.returns.find(r => r.name === '$page');\n                this.startField = ret.fields[0];\n                this.pageStart = page[page.length-1][this.startField.name];\n            }\n            else {\n                this.more = false;\n            }\n            this.list.push(...page);\n        }\n        //this.loaded = true;\n    }\n\n    protected pageCaller(params: any, showWaiting: boolean = true): QueryPageCaller {\n        return new QueryPageCaller(this, params, showWaiting);\n    }\n\n    async page(params:any, pageStart:any, pageSize:number, showWaiting: boolean = true):Promise<{[name:string]:any[]}> {\n        /*\n        await this.loadSchema();\n        let res = await this.uqApi.page(this.name, pageStart, pageSize+1, this.buildParams(params));\n        */\n        let p = {pageStart:pageStart, pageSize:pageSize, params:params};\n        let res = await this.pageCaller(p, showWaiting).request();\n        //let data = this.unpackReturns(res);\n        //return data.$page;// as any[];\n        return res;\n    }\n    protected queryCaller(params: any, showWaiting: boolean = true): QueryQueryCaller {\n        return new QueryQueryCaller(this, params, showWaiting);\n    }\n    async query(params:any, showWaiting:boolean = true):Promise<any> {\n        /*\n        await this.loadSchema();\n        let res = await this.uqApi.query(this.name, this.buildParams(params));\n        */\n        let res = await this.queryCaller(params, showWaiting).request();\n        //let data = this.unpackReturns(res);\n        //return data;\n        return res;\n    }\n    async table(params:any, showWaiting:boolean = true): Promise<any[]> {\n        let ret = await this.query(params, showWaiting);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.table(params, showWaiting);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any, showWaiting:boolean = true):Promise<any> {\n        let ret = await this.obj(params, showWaiting);\n        for (let i in ret) return ret[i];\n    }\n}\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\nconst ID_LENGTH = 8;\n\nexport function uid():string {\n    let len = ALPHABET.length;\n    let rtn = '';\n    for (let i = 0; i < ID_LENGTH; i++) {\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\n    }\n    return rtn;\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\n\nexport interface ImageProps {\n    src: string;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n}\n\n// src = .src, 表示fontawesome Icon\nexport function Image(props: ImageProps) {\n\tlet {className, style, src, altImage} = props;\n\tlet icon:string;\n    if (src) {\n\t\tif (src.indexOf('.') !== 0) {\n\t\t\tif (src.startsWith(':') === true) {\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\n\t\t\t}\n\t\t\treturn <img src={src} className={className} alt=\"img\"\n\t\t\t\tstyle={style}\n\t\t\t\tonError={evt=>{\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n\t\t\t\t}} />;\n\t\t}\n\t\ticon = src.substr(1);\n\t}\n\telse {\n\t\ticon = 'file-o'\n\t}\n\treturn <span className={classNames(className, 'image-none')} style={style}>\n\t\t<i className={'fa fa-' + icon} />\n\t</span>;\n}\n","import jwtDecode from 'jwt-decode';\n\nexport interface Unit {\n    id: number;\n    name: string;\n}\n\nexport interface Guest {\n    id: number;             // id = 0\n    guest: number;\n    token: string;\n}\n\nexport interface User extends Guest {\n    id: number;\n    name: string;\n    nick?: string;\n    icon?: string;\n}\n\nexport function decodeUserToken(token: string): User {\n    let ret:any = jwtDecode(token);\n    let user: User = {\n        id: ret.id,\n        name: ret.name,\n        guest: ret.guest,\n        token: token,\n    };\n    return user;\n}\n\nexport function decodeGuestToken(token: string): Guest {\n    let ret:any = jwtDecode(token);\n    let guest: Guest = {\n        id: 0,\n        guest: ret.guest,\n        token: token,\n    };\n    return guest;\n}\n","import { env } from '../tool';\n\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\nconst uqDebugBuilderHost = 'localhost:3009';\ninterface HostValue {\n    value: string;\n    local: boolean;\n}\nconst hosts:{[name:string]:HostValue} = {\n    centerhost: {\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \n        local: false\n    },\n    reshost: {\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\n        local: false\n    },\n    uqhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    unitxhost: {\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \n        local: false\n    },\n    \"uq-build\": {\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \n        local: false\n    }\n}\n\nconst httpArr = ['https://', 'http://'];\nfunction isAbsoluteUrl(url:string):boolean {\n    for (let str of httpArr) {\n        if (url.startsWith(str) === true) return true;\n    }\n    return false;\n}\n\nfunction urlFromHost(host:string):string {\n    if (isAbsoluteUrl(host) === true) {\n        if (host.endsWith('/')) return host;\n        return host + '/';\n    }\n    return `http://${host}/`;\n}\n\nfunction centerUrlFromHost(host:string):string {\n    return urlFromHost(host);\n}\nfunction centerWsFromHost(host:string) {\n    let https = 'https://';\n    if (host.startsWith(https) === true) {\n        host = host.substr(https.length);\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\n        return 'wss://' + host + '/tv/';\n    }\n    return `ws://${host}/tv/`\n}\nexport function resUrlFromHost(host:string) {\n\tif (!host) return;\n    let url = urlFromHost(host);\n    return url + 'res/';\n}\n\nconst fetchOptions = {\n    method: \"GET\",\n    mode: \"no-cors\", // no-cors, cors, *same-origin\n    headers: {\n        \"Content-Type\": \"text/plain\"\n    },\n};\n\nclass Host {\n    testing: boolean;\n    url: string;\n    ws: string;\n    resHost: string;\n\n    async start(testing:boolean) {\n        this.testing = testing;\n        if (env.isDevelopment === true) {\n            await this.tryLocal();\n        }\n        let host = this.getCenterHost();\n        this.url = centerUrlFromHost(host);\n        this.ws = centerWsFromHost(host);\n        this.resHost = this.getResHost();\n    }\n\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\n    private async tryLocal() {\n        let promises:PromiseLike<any>[] = [];\n        let hostArr:string[] = [];\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            let {value} = hostValue;\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\n        }\n\n        for (let host of hostArr) {\n            let fetchUrl = this.debugHostUrl(host);\n            promises.push(localCheck(fetchUrl));\n        }\n        let results = await Promise.all(promises);\n        let len = hostArr.length;\n        for (let i=0; i<len; i++) {\n            let local = results[i];\n            let host = hostArr[i];\n            for (let j in hosts) {\n                let hostValue = hosts[j];\n                if (hostValue.value === host) {\n                    hostValue.local = local;\n                }\n            }\n        }\n        /*\n        let p = 0;\n        for (let i in hosts) {\n            let hostValue = hosts[i];\n            hostValue.local = results[p];\n            ++p;\n        }\n        */\n    }\n\n    private getCenterHost():string {\n        let {value, local} = hosts.centerhost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return centerHost;\n    }\n\n    private getResHost():string {\n        let {value, local} = hosts.reshost;\n        let hash = document.location.hash;\n        if (hash.includes('sheet_debug') === true) {\n            return value;\n        }\n        if (env.isDevelopment === true) {\n            if (local === true) return value;\n        }\n        return resHost;\n    }\n\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\n        if (env.isDevelopment === false) return url;\n        let host = hosts[debugHost];\n        if (host === undefined) return url;\n        let {value, local} = host;\n        if (local === false) return url;\n        return `http://${value}/`;\n    }\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\n\t\tlet path:string;\n\t\tif (!urlTest) {\n\t\t\turlTest = url;\n\t\t\tif (!urlTest) {\n\t\t\t\tconsole.error('no server set for ' + db);\n\t\t\t\tdebugger;\t\t\t\t\n\t\t\t}\n\t\t}\n        if (this.testing === true) {\n            if (urlTest !== '-') url = urlTest;\n            path = 'uq/test/' + db + '/';\n        }\n        else {\n            path = 'uq/prod/' + db + '/';\n        }\n\t\turl = this.getUrlOrDebug(url);\n\t\tif (url.endsWith('/') === false) {\n\t\t\turl += '/';\n\t\t}\n        return url + path;\n    }\n\n    async localCheck(urlDebug: string):Promise<boolean> {\n        return await localCheck(urlDebug);\n    }\n}\n\nexport const host:Host = new Host();\n\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\n// 网上找了上面的fetch timeout代码。\n// 尽管timeout了，fetch仍然继续，没有cancel\n\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\n//const timeout = 2000;\nconst timeout = 200;\n\nfunction fetchLocalCheck(url:string):Promise<any> {\n    return new Promise((resolve, reject) => {\n      fetch(url, fetchOptions as any)\n      .then(v => {\n          v.text().then(resolve).catch(reject);\n      })\n      .catch(reject);\n      const e = new Error(\"Connection timed out\");\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\n    });\n}\n\nasync function localCheck(url:string):Promise<boolean> {\n    try {\n        await fetchLocalCheck(url);\n        return true;\n    }\n    catch (err) {\n        return false;\n    }\n}\n\n/*\nexport interface IUqForChannel {\n    uq: string;\n    uqVersion: number;\n}\n*/","import { Entity } from './entity';\nimport { ActionCaller } from './caller';\n\nexport class Action extends Entity {\n    get typeName(): string { return 'action';}\n    async submit(data:object, waiting: boolean = true) {\n\t\tlet caller = new ActionSubmitCaller(this, data)\n\t\tlet ret = await caller.request();\n\t\treturn ret;\n    }\n    async submitReturns(data:object):Promise<{[ret:string]:any[]}> {\n       return await new SubmitReturnsCaller(this, data).request();\n    }\n    async submitConvert(data:object) {\n        return await new SubmitConvertCaller(this, data).request();\n    }\n}\n\nexport class ActionSubmitCaller extends ActionCaller {\n    get path():string {return 'action/' + this.entity.name;}\n    buildParams():any {\n\t\treturn {data: this.entity.pack(this.params)}\n\t}\n}\n\nclass SubmitReturnsCaller extends ActionSubmitCaller {\n    get path():string {return 'action/' + this.entity.name + '/returns';}\n    xresult(res:any):any {\n        let {returns} = this.entity;\n        let len = returns.length;\n        let ret:{[r:string]:any[]} = {};\n        for (let i=0; i<len; i++) {\n            let retSchema = returns[i];\n            ret[retSchema.name] = res[i];\n        }\n        return ret;\n    }\n}\n\nclass SubmitConvertCaller extends ActionSubmitCaller {\n    get path():string {return 'action-convert/' + this.entity.name;}\n    buildParams():any {\n        return {\n            data: this.params\n        };\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-lmr.css';\n\nexport interface LMRProps {\n    className?: string | string[];\n    left?: string|JSX.Element;\n    right?: string|JSX.Element;\n    onClick?: ()=>void;\n}\n\n@observer\nexport class LMR extends React.Component<LMRProps> {\n    render() {\n        let {className, left, children, right, onClick} = this.props;\n        let l, r;\n        if (left !== undefined) l = <header>{left}</header>;\n        if (right !== undefined) r = <footer>{right}</footer>;\n        let cursor;\n        if (onClick !== undefined) cursor = 'cursor-pointer';\n        return <div className={classNames('va-lmr', className, cursor)} onClick={onClick}>\n            {l}\n            <div>{children}</div>\n            {r}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\nimport '../../css/va-badge.css';\n\nexport interface BadgeProps {\n    className?: string;\n    badge?: string|number;\n    size?: 'xs' | 'sm' | 'lg';\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\n    badgeAlign?: 'left'|'center'|'right';\n    badgeVertical?: 'top'|'middle'|'bottom';\n}\n\n@observer\nexport class Badge extends React.Component<BadgeProps> {\n    render() {\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\n        let cn = classNames(\n            className,\n            'va-badge',\n            size && 'va-badge-'+size,\n            'va-badge-' + (color||'secondary'),\n            badgeAlign && 'va-badg-'+badgeAlign,\n            badgeVertical && 'va-badg-'+badgeVertical,\n        );\n        let b;\n        if (badge) b = <b>{badge}</b>;\n        return <div className={cn}>\n            {children}\n            {b}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface FAProps {\n    name: string;\n    className?: string;\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\n    spin?: boolean;\n    fixWidth?: boolean;\n    border?: boolean;\n    pull?: 'left'|'right';\n    pulse?: boolean;\n    rotate?: 90|180|270;\n    flip?: 'horizontal'|'vertical';\n    inverse?: boolean;\n}\n\nexport class FA extends React.Component<FAProps> {\n    render() {\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\n        let cn = classNames(className, 'fa',\n            name && ('fa-' + name),\n            size && 'fa-'+size,\n            fixWidth && 'fa-fw',\n            border && 'fa-border',\n            pull && 'fa-pull-' + pull,\n            spin && 'fa-spin',\n            pulse && 'fa-pulse',\n            rotate && 'fa-rotate-' + rotate,\n            flip && 'fa-flip-' + flip,\n            inverse && 'fa-inverse',\n        );\n        return <i className={cn} />\n    }\n}\n\nexport interface StackedFAProps {\n    className?: string;\n    size?: 'lg',\n}\nexport class StackedFA extends React.Component<StackedFAProps> {\n    render() {\n        let {className, size, children} = this.props;\n        let cn = classNames(\n            'fa-stack',\n            className,\n            size && 'fa-' + size);\n        return <span className={cn}>\n            {children}\n        </span>;\n    }\n}\n","import * as React from 'react';\nimport {FA} from './FA';\n\nexport interface IconTextProps {\n    icon: string;\n    iconClass?: string;\n    text: string;\n    textClass?: string;\n}\n\nexport class IconText extends React.Component<IconTextProps> {\n    render() {\n        let {icon, iconClass, text, textClass} = this.props;\n        return <div className=\"py-2\">\n            <FA className={iconClass} name={icon} fixWidth={true} />\n            <span className={textClass}>{text}</span>\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport const Muted = (props:any) => \n<small className={classNames('text-muted', props.className)} style={props.style}>\n    {props.children}\n</small>;\n","import { observable } from 'mobx';\nimport { isNumber } from 'util';\nimport _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { BoxId } from './boxId';\nimport { TuidInner, TuidDiv } from './tuid';\n\nconst maxCacheSize = 1000;\n\nexport class IdCache {\n    private queue: number[] = [];               // 每次使用，都排到队头\n\tprivate cache = observable.map({}, {deep: false});    // 已经缓冲的\n\tprivate loading:boolean = false;\n\n    protected localArr:LocalArr;\n    protected waitingIds: number[] = [];          // 等待loading的\n    protected tuidInner: TuidInner;\n\n    constructor(tuidLocal: TuidInner) {\n        this.tuidInner = tuidLocal;\n        this.initLocalArr();\n    }\n\n    protected initLocalArr() {\n        this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    useId(id:number, defer?:boolean) {\n        if (!id) return;\n        if (isNumber(id) === false) return;\n        if (this.cache.has(id) === true) {\n            this.moveToHead(id);\n            return;\n        }\n        this.tuidInner.cacheTuids(defer===true?70:20);\n        this.cache.set(id, id);\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\n            this.moveToHead(id);\n            return;\n        }\n\n        if (this.queue.length >= maxCacheSize) {\n            // 缓冲已满，先去掉最不常用的\n            let r = this.queue.shift();\n            if (r === id) {\n                // 如果移除的，正好是现在用的，则插入\n                this.queue.push(r);\n                return;\n            }\n\n            //let rKey = String(r);\n            if (this.cache.has(r) === true) {\n                // 如果移除r已经缓存\n                this.cache.delete(r);\n            }\n            else {\n                // 如果移除r还没有缓存\n                let index = this.waitingIds.findIndex(v => v === r);\n                this.waitingIds.splice(index, 1);\n            }\n        }\n        this.waitingIds.push(id);\n        this.queue.push(id);\n        return;\n    }\n\n    private moveToHead(id:number) {\n        let index = this.queue.findIndex(v => v === id);\n        this.queue.splice(index, 1);\n        this.queue.push(id);\n    }\n\n    getValue(id:number) {\n        return this.cache.get(id);\n    }\n\n    remove(id:number) {\n        this.cache.delete(id);\n        let index = this.queue.findIndex(v => v === id);\n\t\tthis.queue.splice(index, 1);\n\t\tthis.localArr.removeItem(id);\n    }\n\n    valueFromId(id:number|BoxId):any {\n        let _id:number;\n        switch (typeof id) {\n            case 'object': _id = (id as BoxId).id; break;\n            case 'number': _id = id as number; break;\n            default: return;\n        }\n        return this.getValue(_id);\n    }\n\n    resetCache(id:number) {\n        this.remove(id);\n        this.useId(id);\n    }\n\n    cacheValue(val:any):boolean {\n        if (val === undefined) return false;\n        let id = this.getIdFromObj(val);\n        if (id === undefined) return false;\n        let index = this.waitingIds.findIndex(v => v === id);\n        if (index>=0) this.waitingIds.splice(index, 1);\n        this.cache.set(id, val);\n        return true;\n    }\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\n\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n\t\tlet tuidValues = await this.loadIds();\n\t\tif (tuidValues === undefined || tuidValues.length === 0) {\n\t\t\tthis.waitingIds.splice(0, this.waitingIds.length);\n\t\t\treturn;\n\t\t}\n        this.cacheIdValues(tuidValues);\n    }\n\n    private cacheIdValues(tuidValues: any[]) {\n        if (tuidValues === undefined) return;\n        let tuids = this.unpackTuidIds(tuidValues);\n        for (let tuidValue of tuids) {\n            if (this.cacheValue(tuidValue) === false) continue;\n            this.cacheTuidFieldValues(tuidValue);\n        }\n    }\n    async modifyIds(ids:any[]):Promise<void> {\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\n        let localedValues = tuidValues.filter(v => {\n            let p = v.indexOf('\\t');\n            if (p<0) p = v.length;\n            let id = Number(v.substr(0, p));\n            let val = this.localArr.getItem(id);\n            return (val !== undefined);\n        });\n        if (localedValues.length === 0) return;\n        this.cacheIdValues(localedValues);\n    }\n    protected divName:string = undefined;\n    protected async loadIds(): Promise<any[]> {\n\t\tif (this.loading === true) return;\n\t\tthis.loading = true;\n\t\tlet ret = await this.loadTuidIdsOrLocal(this.waitingIds);\n\t\tthis.loading = false;\n        return ret;\n    }\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.tuidInner.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\n    }\n\n    async assureObj(id:number):Promise<void> {\n        let val = this.cache.get(id);\n        switch (typeof val) {\n            case 'object': return val;\n            case 'number': this.cache.set(id, id); break;\n        }\n        let ret = await this.loadTuidIdsOrLocal([id]);\n        this.cacheIdValues(ret);\n    }\n\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\n        let ret:string[] = [];        \n        let netIds:number[] = [];\n        for (let id of ids) {\n            let value = this.localArr.getItem(id);\n            //if (value === undefined)\n            // 值不存在或者是空字符串，重新获取\n            if (!value)\n                netIds.push(id);\n            else\n                ret.push(value);\n        }\n        let len = netIds.length;\n        if (len > 0) {\n            let netRet = await this.tuidInner.loadTuidIds(this.divName, netIds);\n            for (let i=0; i<len; i++) {\n                //有些id可能没有内容，不会返回\n                //let id = netIds[i]; \n                let row:string = netRet[i];\n                if (!row) continue;\n                let p = row.indexOf('\\t');\n                if (p < 0) p = row.length;\n                let id = Number(row.substr(0, p));\n\t\t\t\t_.remove(netIds, v => v === id);\n                ret.push(row);\n                this.localArr.setItem(id, row);\n            }\n            len = netIds.length;\n            for (let i=0; i<len; i++) {\n                this.localArr.setItem(netIds[i], '');\n            }\n        }\n        return ret;\n    }\n}\n\nexport class IdDivCache extends IdCache {\n    private div: TuidDiv;\n    protected divName:string;\n\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\n        super(tuidLocal);\n        this.div = div;\n        this.divName = div.name;\n        this.localArr = tuidLocal.cache.arr(tuidLocal.name + '.ids.' + this.divName);\n    }\n\n    protected initLocalArr() {\n        // 这个不需要，必须去掉\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\n    }\n\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\n    protected unpackTuidIds(values:string[]):any[] {\n        return this.div.unpackTuidIds(values);\n    }\n    protected cacheTuidFieldValues(tuidValue: any) {\n        this.div.cacheTuidFieldValues(tuidValue);\n    }\n\n    /*\n    async cacheIds():Promise<void> {\n        if (this.waitingIds.length === 0) return;\n        let tuidValues = await this.loadIds();\n        if (tuidValues !== undefined) {\n            let tuids = this.tuidLocal.unpackTuidIds(tuidValues);\n            for (let tuidValue of tuids) {\n                if (this.cacheValue(tuidValue) === false) continue;\n                this.tuidLocal.cacheTuidFieldValues(tuidValue);\n                this.afterCacheValue(tuidValue);\n            }\n        }\n    }\n    */\n}\n","import _ from 'lodash';\nimport { LocalArr } from '../../tool';\nimport { Entity } from '../entity';\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\nimport { EntityCaller } from '../caller';\nimport { BoxId } from './boxId';\nimport { IdCache, IdDivCache } from './idCache';\n\nexport interface TuidSaveResult {\n    id: number;\n    inId: number;\n}\n\nexport abstract class Tuid extends Entity {\n    protected noCache: boolean;\n    readonly typeName:string = 'tuid';\n    protected idName: string;\n    cached: boolean;\n    unique: string[];\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {id} = schema;\n        this.idName = id;\n    }\n\n    buildTuidBox(): TuidBox {\n        return new TuidBox(this);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    stopCache():void {this.noCache = true}\n    abstract useId(id:number):void;\n    abstract boxId(id:number):BoxId;\n    abstract valueFromId(id:number):any;\n\tabstract resetCache(id:number|BoxId):void;\n    abstract async assureBox<T> (id:number|BoxId): Promise<T>;\n    static equ(id1:BoxId|number, id2:BoxId|number): boolean {\n        if (id1 === undefined) return false;\n        if (id2 === undefined) return false;\n        if (typeof id1 === 'object') {\n            return id1.equ(id2);\n        }\n        if (typeof id2 === 'object') {\n            return id2.equ(id1);\n        }\n        return id1 === id2;\n    }\n    cacheIds() {}\n    async modifyIds(ids:any[]) {}\n    isImport = false;\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\n    abstract div(name:string):TuidDiv;\n    abstract async loadMain(id:number|BoxId):Promise<any>;\n\tabstract async load(id:number|BoxId):Promise<any>;\n    abstract async all():Promise<any[]>;\n\tabstract async save(id:number, props:any):Promise<TuidSaveResult>;\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\n    abstract async search(key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\n    abstract async loadArr(arr:string, owner:number, id:number):Promise<any>;\n    abstract async saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\n\tabstract async posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\n\tabstract async no():Promise<{date:Date, no:string}>;\n}\n\nexport class TuidInner extends Tuid {\n    private divs: {[div:string]: TuidDiv};\n    protected cacheFields: Field[];\n    protected idCache: IdCache;\n    protected localArr:LocalArr;\n    constructor(uq:UqMan, name:string, typeId:number) {\n        super(uq, name, typeId);\n        this.idCache = new IdCache(this);\n        this.localArr = this.cache.arr(this.name + '.whole');\n        if (uq.newVersion === true) this.localArr.removeAll();\n    }\n\n    public setSchema(schema:any) {\n        super.setSchema(schema);\n        let {arrs} = schema;\n        if (arrs !== undefined) {\n            this.divs = {};\n            for (let arr of arrs) {\n                let {name} = arr;\n                let tuidDiv = new TuidDiv(this.uq, this, name);\n                this.divs[name] = tuidDiv;\n                tuidDiv.setSchema(arr);\n                tuidDiv.buildFieldsTuid();\n            }\n        }\n    }\n    \n    useId(id:number, defer?:boolean) {\n        if (this.noCache === true) return;\n        if (!id) return;\n        this.idCache.useId(id, defer);\n    }\n    boxId(id:number):BoxId {\n        if (!id) return;\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        let {createBoxId} = this.uq;\n        if (!createBoxId) return {id: id} as BoxId;\n        return createBoxId(this, id);\n    }\n    valueFromId(id:number) {return this.idCache.getValue(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tif (typeof id === 'object') id = id.id;\n\t\tthis.idCache.resetCache(id);\n\t}\n    async assureBox<T> (id:number|BoxId):Promise<T> {\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    cacheIds() {\n        this.idCache.cacheIds();\n        if (this.divs === undefined) return;\n        for (let i in this.divs) this.divs[i].cacheIds();\n    }\n    async modifyIds(ids:any[]) {\n        await this.idCache.modifyIds(ids);\n    }\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\n    get hasDiv():boolean {return this.divs!==undefined}\n    div(name:string):TuidDiv {\n        return this.divs && this.divs[name];\n    }\n    async loadTuidIds(divName:string, ids:number[]):Promise<any[]> {\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, false).request();\n        if (ret.length > 0) this.cached = true;\n        return ret;\n    }\n    async loadMain(id:number|BoxId):Promise<any> {\n        if (typeof id === 'object') id = id.id;\n        await this.idCache.assureObj(id);\n        return this.idCache.valueFromId(id);\n    }\n    async load(id:number|BoxId):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let cacheValue = this.idCache.valueFromId(id); \n        //if (typeof cacheValue === 'object') return cacheValue;\n        if (typeof id === 'object') id = id.id;\n        let valuesText = undefined; //this.localArr.getItem(id);\n        let values: any;\n        if (valuesText) {\n            values = JSON.parse(valuesText);\n        }\n        else {\n            values = await new GetCaller(this, id).request();\n            if (values !== undefined) {\n                // this.localArr.setItem(id, JSON.stringify(values));\n            }\n        }\n        if (values === undefined) return;\n        for (let f of this.schema.fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.uq.getTuid(tuid);\n            if (t === undefined) continue;\n            let n = f.name;\n            values[n] = t.boxId(values[n]);\n        }\n        this.idCache.cacheValue(values);\n        this.cacheTuidFieldValues(values);\n        return values;\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let {fields, arrs} = this.schema;\n        this.cacheFieldsInValue(values, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs as ArrFields[]) {\n                let {name, fields} = arr;\n                let arrValues = values[name];\n                if (arrValues === undefined) continue;\n                let tuidDiv = this.div(name);\n                for (let row of arrValues) {\n                    //row._$tuid = tuidDiv;\n                    //row.$owner = this.boxId(row.owner);\n                    tuidDiv.cacheValue(row);\n                    this.cacheFieldsInValue(row, fields);\n                }\n            }\n        }\n    }\n\n    public buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\n\t\tif (mainFields === undefined) debugger;\n\t\tthis.cacheFields = mainFields || this.fields;\n\t\tif (stampOnMain === true) {\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\n\t\t}\n        this.uq.buildFieldTuid(this.cacheFields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\n        if (id !== undefined) {\n            this.idCache.remove(id);\n            this.localArr.removeItem(id);\n        }\n        return ret;\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\n\t\tthis.idCache.remove(id);\n\t\tawait this.idCache.assureObj(id);\n\t}\n    async all():Promise<any[]> {\n        let ret: any[] = await new AllCaller(this, {}).request();\n        return ret;\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\n        return ret;\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        //let api = this.uqApi;\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\n        let ret = await new SearchCaller(this, params).request();\n        let {fields} = this.schema;\n        for (let row of ret) {\n            this.cacheFieldsInValue(row, fields);\n        }\n        return ret;\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        if (id === undefined || id === 0) return;\n        //let api = this.uqApi;\n        //return await api.tuidArrGet(this.name, arr, owner, id);\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any) {\n        //let params = _.clone(props);\n        //params[\"$id\"] = id;\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\n    }\n\n    async posArr(arr:string, owner:number, id:number, order:number) {\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\n\t}\n\tasync no():Promise<{date:Date, no:string}> {\n\t\treturn await new TuidNoCaller(this, undefined).request();\n\t}\n}\n\nabstract class TuidCaller<T> extends EntityCaller<T> {\n    protected get entity(): Tuid {return this._entity as Tuid};\n}\n\n// 包含main字段的load id\n// 当前为了兼容，先调用的包含所有字段的内容\nclass GetCaller extends TuidCaller<number> {\n    method = 'GET';\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\n}\n\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\n    get path():string {\n        let {divName} = this.params;\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\n    }\n    buildParams():any {return this.params.ids}\n    xresult(res:any):any {\n        return (res as string).split('\\n');\n    }\n}\n\n\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\n    get path():string {return `tuid/${this.entity.name}`}\n    buildParams():any {\n        let {fields, arrs} = this.entity.schema;\n        let {id, props} = this.params;\n        let params:any = {$id: id};\n        this.transParams(params, props, fields);\n        if (arrs !== undefined) {\n            for (let arr of arrs) {\n                let arrName = arr.name;\n                let arrParams = [];\n                let arrFields = arr.fields;\n                let arrValues = props[arrName];\n                if (arrValues !== undefined) {\n                    for (let arrValue of arrValues) {\n                        let row = {};\n                        this.transParams(row, arrValue, arrFields);\n                        arrParams.push(row);\n                    }\n                }\n                params[arrName] = arrParams;\n            }\n        }\n        return params;\n    }\n    private transParams(values:any, params:any, fields:Field[]) {\n        if (params === undefined) return;\n        for (let field of fields) {\n            let {name, tuid, type} = field;\n            let val = params[name];\n            if (tuid !== undefined) {\n                if (typeof val === 'object') {\n                    if (val !== null) val = val.id;\n                }\n            }\n            else {\n                switch (type) {\n                    case 'date':\n                        val = this.entity.buildDateParam(val); \n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                    case 'datetime':\n                        val = this.entity.buildDateTimeParam(val);\n                        //val = new Date(val).toISOString();\n                        //val = (val as string).replace('T', ' ');\n                        //val = (val as string).replace('Z', '');\n                        break;\n                }\n            }\n            values[name] = val;\n        }\n    }\n}\n\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\n    get path():string {return `tuids/${this.entity.name}`}\n}\n\nclass AllCaller extends TuidCaller<{}> {\n    method = 'GET';\n    get path():string {return `tuid-all/${this.entity.name}`}\n}\n\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\n    method = 'GET';\n    get path():string {\n        let {arr, owner, id} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\n    }\n}\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\n}\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, props} = this.params;\n        let params = _.clone(props);\n        params['$id'] = id;\n        return params;\n    }\n}\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\n    get path():string {\n        let {arr, owner} = this.params;\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\n    }\n    buildParams():any {\n        let {id, order} = this.params;\n        return { bid: id, $order: order}\n    }\n}\nclass TuidNoCaller extends TuidCaller<{}> {\n    get path():string {\n        return `tuid-no/${this.entity.name}/`;\n    }\n    buildParams():any {\n\t\tlet d = new Date();\n\t\tlet year = d.getFullYear();\n\t\tlet month = d.getMonth() + 1;\n\t\tlet date = d.getDate();\n        return {year, month, date};\n    }\n}\n\nexport class TuidImport extends Tuid {\n    private tuidLocal: TuidInner;\n\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\n        super(uq, name, typeId);\n        this.from = from;\n    }\n\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\n    \n    readonly from: SchemaFrom;\n    isImport = true;\n\n    useId(id:number) {this.tuidLocal.useId(id);}\n    boxId(id:number):BoxId {return this.tuidLocal.boxId(id);}\n    valueFromId(id:number) {return this.tuidLocal.valueFromId(id)}\n\tresetCache(id:number|BoxId):void {\n\t\tthis.tuidLocal.resetCache(id);\n\t}\n    async assureBox<T>(id:number):Promise<T> {\n        await this.tuidLocal.assureBox(id);\n\t\treturn this.tuidLocal.valueFromId(id);\n    }\n    get hasDiv():boolean {return this.tuidLocal.hasDiv}\n    div(name:string):TuidDiv {return this.tuidLocal.div(name)}\n    async loadMain(id:number|BoxId):Promise<any> {\n        let ret = await this.tuidLocal.loadMain(id);\n        return ret;\n    }\n    async load(id:number|BoxId):Promise<any> {\n        return await this.tuidLocal.load(id);\n    }\n    async save(id:number, props:any):Promise<TuidSaveResult> {\n        return await this.tuidLocal.save(id, props);\n\t}\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\n\t}\n    async all():Promise<any[]> {\n        return await this.tuidLocal.all();\n    }\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.search(key, pageStart, pageSize);\n    }\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\n    }\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\n        return await this.tuidLocal.loadArr(arr, owner, id);\n    }\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\n        await this.tuidLocal.saveArr(arr, owner, id, props);\n    }\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\n        await this.tuidLocal.posArr(arr, owner, id, order);\n    }\n\tasync no():Promise<{date:Date, no:string}> {\n\t\treturn await this.tuidLocal.no();\n\t}\n}\n\n// field._tuid 用这个接口\n// Tuid, TuidDiv 实现这个接口\nexport class TuidBox {\n    tuid: Tuid;\n    ownerField:Field = undefined;\n    constructor(tuid: Tuid) {\n        this.tuid = tuid;\n    }\n\n    boxId(id:number):BoxId {\n        return this.tuid.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.tuid.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.tuid.useId(id);\n    }\n    async showInfo() {\n        alert('showInfo not implemented');\n    }\n}\n\n\nexport class TuidDiv extends TuidInner /* Entity*/ {\n    readonly typeName:string = 'div';\n    protected cacheFields: Field[];\n    protected tuid: TuidInner;\n    protected idName: string;\n    protected idCache: IdDivCache;\n\n    //ui: React.StatelessComponent<any>;\n    //res: any;\n\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\n        super(uq, name, 0);\n        this.tuid = tuid;\n        this.idName = 'id';\n        this.idCache = new IdDivCache(tuid, this);\n    }\n\n    get owner() {return this.tuid}\n\n    /*\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.buildFieldsTuid();\n    }*/\n\n    /*\n    setUIRes(ui:any, res:any) {\n        this.ui = ui && ui.content;\n        this.res = res;\n    }\n    */\n\n    buildFieldsTuid() {\n        super.buildFieldsTuid();\n        let {mainFields} = this.schema;\n        if (mainFields === undefined) debugger;\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\n    }\n\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\n        return new TuidBoxDiv(this.tuid, this, ownerField);\n    }\n\n    getIdFromObj(obj:any):number {return obj[this.idName]}\n    cacheValue(value:any):void {\n        this.idCache.cacheValue(value);\n    }\n\n    useId(id:number, defer?:boolean):void {\n        if (this.noCache === true) return;\n        this.idCache.useId(id, defer);\n    }\n\n    /*\n    boxId(id:number):BoxId {\n        if (typeof id === 'object') return id;\n        this.useId(id);\n        //return new BoxDivId(this.tuid, this, id);\n        return this.tuid.boxDivId(this, id);\n    }\n    */\n    valueFromId(id:number):any {\n        return this.idCache.getValue(id)\n    }\n\n    async assureBox<T>(id:number):Promise<T> {\n\t\tawait this.idCache.assureObj(id);\n\t\treturn this.idCache.getValue(id);\n    }\n\n    async cacheIds() {\n        await this.idCache.cacheIds();\n    }\n\n    cacheTuidFieldValues(values:any) {\n        let fields = this.schema.fields;\n        this.cacheFieldsInValue(values, fields);\n    }\n\n    unpackTuidIds(values:string[]):any[] {\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\n    }\n}\n\nexport class TuidBoxDiv extends TuidBox {\n    ownerField: Field;\n    private div: TuidDiv;\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\n        super(tuid);\n        this.div = div;\n        this.ownerField = ownerField;\n    }\n\n    boxId(id:number):BoxId {\n        return this.div.boxId(id);\n    }\n    getIdFromObj(obj:any):number {\n        return this.div.getIdFromObj(obj);\n    }\n    useId(id:number):void {\n        return this.div.useId(id);\n    }\n}\n","import _ from 'lodash';\n\nclass _LocalStorage {\n    getItem(key:string) {\n        return localStorage.getItem(key)\n    }\n    setItem(key:string, value:string) {\n        localStorage.setItem(key, value);\n    }\n    removeItem(key:string) {\n        localStorage.removeItem(key);\n    }\n}\n\nconst __ls = new _LocalStorage(); // new Ls;\n\nexport class LocalCache {\n    private readonly local: Local;\n    //private value: T;\n    readonly key: string|number;\n\n    constructor(local:Local, key:string|number) {\n        this.local = local;\n        this.key = key;\n    }\n    get():any {\n        try {\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\n            //if (this.value !== undefined) return this.value;\n            let text = this.local.getItem(this.key);\n            if (text === null) return;\n            if (text === undefined) return undefined;\n            //return this.value = \n            return JSON.parse(text);\n        }\n        catch (err) {\n            this.local.removeItem(this.key);\n            return;\n        }\n    }\n    set(value:any) {\n\t\tlet t = JSON.stringify(value, (key, value) => {\n\t\t\tif (key !== '_tuid') return value;\n\t\t});\n\t\tthis.local.setItem(this.key, t);\n    }\n    remove(local?:Local) {\n        if (local === undefined) {\n            this.local.removeItem(this.key);\n        }\n        else {\n            this.local.removeLocal(local);\n        }\n    }\n    child(key:string|number):LocalCache {\n        return this.local.child(key);\n    }\n    arr(key:string|number):LocalArr {\n        return this.local.arr(key);\n    }\n    map(key:string|number):LocalMap {\n        return this.local.map(key);\n    }\n}\n\nabstract class Local {\n    private readonly caches: {[key:string]:LocalCache};\n    private readonly locals: {[key:string]:Local};\n    protected readonly name: string;\n    constructor(name: string) {\n        this.name = name;\n        this.caches = {};\n        this.locals = {};\n    }\n\n    protected abstract keyForGet(key:string|number):string;\n    protected abstract keyForSet(key:string|number):string;\n    protected abstract keyForRemove(key:string|number):string;\n    abstract removeAll():void;\n    getItem(key:string|number):string {\n        let k = this.keyForGet(key);\n        if (k === undefined) return;\n        return __ls.getItem(k);\n    }\n    setItem(key:string|number, value: string):void {\n        let k = this.keyForSet(key);\n        __ls.setItem(k, value);\n    }\n    removeItem(key:string|number):void {\n        let k = this.keyForSet(key);\n        if (k === undefined) return;\n        localStorage.removeItem(k);\n    }\n    arr(key:string|number):LocalArr {\n        let sk = String(key);\n        let arr = this.locals[sk] as LocalArr;\n        if (arr === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = arr = new LocalArr(k);\n        }\n        return arr;\n    }\n    map(key:string|number):LocalMap {\n        let sk = String(key);\n        let map = this.locals[sk] as LocalMap;\n        if (map === undefined) {\n            let k = this.keyForSet(key);\n            this.locals[sk] = map = new LocalMap(k);\n        }\n        return map;\n    }\n    removeLocal(local:Local) {\n        let sk = local.name;\n        let k = this.keyForRemove(sk);\n        if (k === undefined) return;\n        let arr = this.locals[sk];\n        if (arr === undefined) arr = new LocalArr(k);\n        else this.locals[sk] = undefined;\n        arr.removeAll();\n    }\n    child(key:string|number):LocalCache {\n        let ks = String(key);\n        let ret = this.caches[ks];\n        if (ret !== undefined) return ret;\n        return this.caches[ks] =ret = new LocalCache(this, key);\n    }\n}\n\nconst maxArrSize = 500;\nexport class LocalArr extends Local {\n    private readonly index: number[];\n    constructor(name: string) {\n        super(name);\n        let index = __ls.getItem(this.name);\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\n    }\n    private saveIndex() {\n        __ls.setItem(this.name, this.index.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i < 0) return undefined;\n        return `${this.name}.${key}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) {\n            this.index.unshift(key);\n            if (this.index.length > maxArrSize) this.index.pop();\n        }\n        else {\n            this.index.splice(i, 1);\n            this.index.unshift(key)\n        }\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    protected keyForRemove(key:number):string {\n        let i = _.indexOf(this.index, key);\n        if (i<0) return;\n        this.index.splice(i, 1);\n        this.saveIndex();\n        return `${this.name}.${key}`;\n    }\n    removeAll():void {\n        for (let i of this.index) {\n            __ls.removeItem(`${this.name}.${i}`);\n        }\n        __ls.removeItem(this.name);\n        this.index.splice(0);\n    }\n    item(index:number):LocalCache {\n        return this.child(index);\n    }\n}\n\nexport class LocalMap extends Local {\n    private readonly index: {[key:string]:number};\n    private max: number;\n    constructor(name: string) {\n        super(name);\n        this.max = 0;\n        this.index = {};\n        let index = __ls.getItem(this.name);\n        if (index !== null) {\n            let ls = index.split('\\n');\n            ls.forEach(l => {\n                let p = l.indexOf('\\t');\n                if (p<0) return;\n                let key = l.substr(0, p);\n                let i = Number(l.substr(p+1));\n                if (isNaN(i) === true) return;\n                this.index[key] = i;\n                if (i>this.max) this.max = i;\n            });\n        }\n    }\n    private saveIndex() {\n        let ls:string[] = [];\n        for (let k in this.index) {\n            let v = this.index[k];\n            if (v === undefined) continue;\n            ls.push(`${k}\\t${v}`);\n        }\n        __ls.setItem(this.name, ls.join('\\n'));\n    }\n    protected keyForGet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) return undefined;\n        return `${this.name}.${i}`;\n    }\n    protected keyForSet(key:number):string {\n        let i = this.index[key];\n        if (i === undefined) {\n            ++this.max;\n            i = this.max;\n            this.index[key] = i;\n            this.saveIndex();\n        }\n        return `${this.name}.${i}`;\n    }\n    protected keyForRemove(key:string|number):string {\n        let i = this.index[key];\n        if (i===undefined) return;\n        this.index[key] = undefined;\n        this.saveIndex();\n        return `${this.name}.${i}`;\n    }\n    removeAll():void {\n        for (let i in this.index) {\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\n            this.index[i] = undefined;\n        }\n        __ls.removeItem(this.name);\n        this.max = 0;\n    }\n    item(key:string):LocalCache {\n        return this.child(key);\n    }\n}\n","import * as React from 'react';\nimport { BoxId } from './boxId';\nimport { Tuid } from './tuid';\nimport { observer } from 'mobx-react';\n\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\n    return <>{tuidName}: {uqStringify(values)}</>;\n};\n\nexport function uqStringify(values: any): string {\n    let s = '{';\n    if (values === undefined) return 'undefined';\n    for (let i in values) {\n        let v = values[i];\n        s += i + ': ';\n        if (v === undefined) {\n            s += 'undefined';\n        }\n        else if (v === null) {\n            s += 'null';\n        }\n        else {\n            switch (typeof v) {\n                default:\n                    s += v;\n                    break;\n                case 'function':\n                    s += 'function';\n                    break;\n                case 'object':\n                    s += '{obj}';\n                    break;\n            }\n        }\n        s += ', ';\n    }\n    return s + '}';\n}\n\nexport class ReactBoxId implements BoxId {\n    readonly id: number;\n    protected tuid: Tuid;\n    protected ui: (values:any) => JSX.Element;\n    readonly isUndefined:boolean;\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\n        this.id = Number(id);\n        this.tuid = tuid;\n        this.ui = ui;\n        this.isUndefined = (this.tuid === undefined);\n    }\n\n    get obj():any {\n        return this.tuid.valueFromId(this.id);\n    }\n\n    equ(id:BoxId|number): boolean {\n        if (id === undefined || id === null) return false;\n        if (typeof id === 'object') return this.id === id.id;\n        return this.id === id;\n    }\n\n    render(ui:TvTemplet, x:any):JSX.Element {\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\n        let boxName = this.boxName; // this.tuid.name;\n        let val = this.obj; // this.tuid.valueFromId(this.id);\n        if (this.isUndefined === true) {\n            if (ui !== undefined) return ui(val, x);\n            return TuidContent(boxName, val, x);\n        }\n        switch (typeof val) {\n            case 'undefined':\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\n            case 'number':\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\n        }\n        if (ui === undefined) {\n            ui = this.ui;\n        }\n        if (ui !== undefined) {\n            if (typeof ui !== 'function') {\n                ui = (ui as any).content;\n            }\n            if (ui !== undefined) {\n                let ret = ui(val/*, this.tuidUR.res*/);\n                if (ret !== undefined) return ret;\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\n            }\n        }\n\n        return TuidContent(boxName, val);\n    }\n\n    get boxName():string {return this.tuid.name}\n    // ui(): TvTemplet {return this.tuid.ui}\n    // res(): any {return this.tuid.res}\n\n    async assure(): Promise<BoxId> {\n        await this.tuid.assureBox(this.id);\n        return this;\n    }\n}\n\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\n    let logContent:any;\n    let boxId:ReactBoxId = bi as ReactBoxId;\n    switch(typeof bi) {\n        case 'undefined': logContent = <>boxId undefined</>; break;\n        case 'number': logContent = <>id:{bi}</>; break;\n        default:\n            if (typeof boxId.render !== 'function') {\n                if (ui === undefined) {\n                    logContent = TuidContent(boxId.boxName, bi, x);\n                }\n                else {\n                    return ui(bi, x);\n                }\n            }\n            break;\n    }\n    if (logContent !== undefined) {\n        return <del className=\"text-danger\">{logContent}</del>;\n    }\n    return boxId.render(ui, x);\n}\n\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\n\ninterface Props {\n    tuidValue: number|BoxId, \n    ui?: TvTemplet,\n    x?: any,\n    nullUI?: ()=>JSX.Element\n}\n\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\n    if (tuidValue === undefined) {\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\n        return nullUI();\n    }\n    if (tuidValue === null) {\n        if (nullUI === undefined) return <>[null]</>;\n        return nullUI();\n    }\n    let ttv = typeof tuidValue;\n    switch (ttv) {\n        default:\n            if (ui === undefined)\n                return <>{ttv}-{tuidValue}</>;\n            else {\n                let ret = ui(tuidValue, x);\n                if (ret !== undefined) return ret;\n                return <>{tuidValue}</>;\n            }\n        case 'object':\n            let divObj = boxIdContent(tuidValue, ui, x);\n            if (divObj !== undefined) return divObj;\n            return nullUI === undefined? <>id null</>: nullUI();\n        case 'number':\n            return <>id...{tuidValue}</>;\n    }\n});\n\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\n};\n","import React from 'react';\nimport classNames from 'classnames';\n\nconst scrollAfter = 20; // 20ms之后，scroll执行\nexport class Scroller {\n    private el: HTMLBaseElement;\n    constructor(el: HTMLBaseElement) {\n        this.el = el;\n    }\n\n    scrollToTop():void {\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\n    }\n    scrollToBottom():void {\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\n    }\n}\n\nexport interface ScrollProps {\n    onScroll?: (e:any) => void;\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\n\tclassName?: string;\n}\ninterface ScrollViewProps extends ScrollProps {\n\tclassName?: string;\n\tstyle?: React.CSSProperties;\n}\nconst scrollTimeGap = 100;\nexport class ScrollView extends React.Component<ScrollViewProps, null> {\n    private bottomTime:number = 0;\n\tprivate topTime:number = 0;\n\tprivate div: HTMLDivElement;\n\n\tprivate refDiv = (div:HTMLDivElement) => {\n\t\tif (!div) {\n\t\t\tif (this.div) {\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tthis.div = div;\n\t\tthis.div.addEventListener('resize', this.onResize);\n\t}\n\n\tprivate onResize = (ev:UIEvent) => {\n\t\tconsole.error('div resize');\n\t};\n\n    private onScroll = async (e:any) => {\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\n        if (onScroll) this.props.onScroll(e);\n        let el = e.target as HTMLBaseElement;\n        let scroller = new Scroller(el);\n        if (el.scrollTop < 30) {\n            if (onScrollTop !== undefined) {\n                let topTime = new Date().getTime();\n                if (topTime-this.topTime > scrollTimeGap) {\n                    this.topTime = topTime;\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\n\t\t\t\t\t\t // has more\n\t\t\t\t\t\tif (ret === true) {\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\n\t\t\t\t\t\t\tlet top = 200;\n\t\t\t\t\t\t\tif (top > sh) top = sh;\n\t\t\t\t\t\t\tel.scrollTop = top;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n                }\n            }\n        }\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - 30) {\n            //this.eachChild(this, 'bottom');\n            if (onScrollBottom !== undefined) {\n                let bottomTime = new Date().getTime();\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\n                    this.bottomTime = bottomTime;\n                    onScrollBottom(scroller);\n                }\n            }\n        }\n    }\n    private eachChild(c:any, direct:'top'|'bottom') {\n        let { props } = c;\n        if (props === undefined)\n            return;\n        let { children } = props;\n        if (children === undefined)\n            return;\n        React.Children.forEach(children, (child, index) => {\n            let {_$scroll} = child as any;\n            if (_$scroll) _$scroll(direct);\n            console.log(child.toString());\n            this.eachChild(child, direct);\n        });\n\t}\n\t\n    render() {\n\t\tlet {className, style} = this.props;\n\t\treturn <div ref={this.refDiv} className={classNames('tv-page')}\n\t\t\tonScroll={this.onScroll} style={style}>\n\t\t\t<article className={className}>\n\t\t\t\t{this.props.children}\n\t\t\t</article>\n\t\t</div>;\n    }\n}\n\n","import * as React from 'react';\n\nexport function Loading() {\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\n    </div>;\n}\n","import { LocalMap } from './localDb';\n\nconst testingTags:string[] = ['/test', '/test/', '-test', '-test/'];\nfunction isTesting():boolean {\n    let {pathname} = document.location;\n    let pn = pathname.toLowerCase();\n    for (let item of testingTags) {\n        if (pn.endsWith(item) === true) return true;\n    }\n    return false;\n}\n\nexport const env = (function () {\n    let testing = isTesting();\n    let localDb = new LocalMap(testing===true? '$$':'$');\n    return {\n        testing: testing,\n        isDevelopment: process.env.NODE_ENV === 'development',\n        localDb: localDb,\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\n            //if (tag !== undefined) console.log('setTimeout ' + tag);\n            return global.setTimeout(callback, ms, ...args);\n        },\n        clearTimeout: (handle:NodeJS.Timer):void => {\n            global.clearTimeout(handle);\n        },\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\n            return global.setInterval(callback, ms, ...args);\n        },\n        clearInterval: (handle:NodeJS.Timer):void => {\n            global.clearInterval(handle);\n        }\n    }\n}());\n","\nexport * from './boxId';\nexport { Tuid, TuidImport, TuidInner, TuidDiv, TuidBox } from './tuid';\nexport { TuidsCache } from './tuidsCache';\nexport { tv, ReactBoxId, uqStringify } from './reactBoxId';","import {HttpChannel} from './httpChannel';\nimport { Caller } from './caller';\n\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \n    resolve:(values:any)=>any, reject:(reason:any)=>void)\n{\n    await channel.fetch(url, options, false, resolve, reject);\n}\n\nexport abstract class ApiBase {\n    protected token: string;\n    protected path: string;\n    protected showWaiting: boolean;\n\n    constructor(path: string, showWaiting: boolean) {\n        this.path = path || '';\n        this.showWaiting = showWaiting;\n    }\n\n    protected abstract async getHttpChannel(): Promise<HttpChannel>;\n\n    async xcall(caller:Caller<any>):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.xcall(this.path, caller);\n    }\n\n    public async call(url:string, method:string, body:any):Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.callFetch(url, method, body);\n    }\n\n    public async get(path:string, params:any=undefined): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.get(this.path + path, params);\n    }\n\n    public async post(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.post(this.path + path, params);\n    }\n\n    public async put(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.put(this.path + path, params);\n    }\n\n    public async delete(path:string, params:any): Promise<any> {\n        let channel = await this.getHttpChannel();\n        return await channel.delete(this.path + path, params);\n    }\n}\n","import * as React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { UiImageItem } from '../schema';\nimport { ImageUploader } from '../resUploader';\nimport { nav } from '../nav';\nimport { ItemEdit } from './itemEdit';\n\nexport class ImageItemEdit extends ItemEdit {\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\n    @observable private resId: string;\n\n    protected async internalStart():Promise<any> {\n        this.resId = this.value;\n        return new Promise<any>((resolve, reject) => {\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\n        });\n    }\n\n    /*\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let ret = await this.resUploader.upload();\n        if (ret === null) {\n            this.overSize = true;\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.value);\n    }\n    */\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let size:any = this.uiItem && this.uiItem.size;\n\n        /*\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>resolve(this.resId)}>保存</button>;\n        let overSize:any;\n        if (this.overSize === true) {\n            overSize = <div className=\"text-danger\">\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\n            </div>;\n        }\n        */\n        return <ImageUploader \n            label={'更改' + this.label}\n            id={this.resId}\n            size={size}\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\n        /*\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div>上传图片：</div>\n                    <div className=\"my-3\">\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\n                    </div>\n                    <div>\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\n                    </div>\n                </div>\n                {overSize}\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\n                <div className=\"d-flex\">\n                    <div className=\"w-12c h-12c mr-4\"\n                        style={{border: '1px dotted gray', padding: '8px'}}>\n                        <Image className=\"w-100 h-100\" src={this.resId} />\n                    </div>\n                    <div>\n                        <div className=\"small\">图片预览</div>\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\n                    </div>\n                </div>\n            </div>\n        </Page>;\n        */\n    })\n}\n","//import _ from 'lodash';\nimport { KeyValueRes, Res } from './res';\n\nexport interface FormRes extends KeyValueRes {\n    required: string;\n    number: string;\n    integer: string;\n    min: string;\n    max: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const formRes:Res<FormRes> = {\n    _: {\n        required: 'required',\n        number: 'not valid number',\n        integer: 'not valid integer',\n        min: 'min value is ${min}',\n        max: 'max value is ${max}',\n    },\n    zh: {\n        _: {\n            required: '必须填',\n            number: '需要数字',\n            integer: '需要整数',\n            min: '不能小于${min}',\n            max: '不能大于${max}',\n        }\n    },\n}\n","import { KeyValueRes, Res } from './res';\n\nexport interface ListRes extends KeyValueRes {\n    none: string;\n}\n\n/*eslint no-template-curly-in-string: 0*/\nexport const listRes:Res<ListRes> = {\n    _: {\n        none: '[none]',\n    },\n    zh: {\n        _: {\n            none: '[无]',\n        }\n    },\n}\n","import { Res } from '../res';\n\nexport interface LoginRes {\n    a: string;\n}\n\nexport const loginRes: Res<LoginRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import { Res } from '../res';\n\nexport interface RegisterRes {\n    a: string;\n}\n\nexport const registerRes: Res<RegisterRes> = {\n    _: {\n        a: 'd',\n    }\n}\n","import _ from 'lodash';\nimport {observable, IObservableArray, computed} from 'mobx';\n\nexport abstract class PageItems<T> {\n    constructor(itemObservable:boolean = false) {\n        this._items = observable.array<T>([], {deep:itemObservable});\n    }\n\tprivate isFirst: boolean = true;\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\n    @observable loading: boolean = false;\n    @observable private beforeLoad: boolean = true;\n    @observable protected loaded: boolean = false;\n    protected _items:IObservableArray<T>;\n    @observable allLoaded: boolean = false;\n    @computed get items():IObservableArray<T> {\n        if (this.beforeLoad === true) return null;\n        if (this.loaded === false) return undefined;\n        return this._items;\n\t}\n\t\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\n\t\tthis.pageItemAction = pageItemAction;\n\t}\n\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\n\t\tthis.itemConverter = itemConverter;\n\t}\n\n    @observable topDiv:string = '$$top';\n    @observable bottomDiv:string = '$$bottom';\n    scrollToTop = () => {\n\t\tthis.scrollIntoView(this.topDiv);\n\t\t//let id = '$$top'+uid();\n\t\t//this.topDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.topDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n    }\n    scrollToBottom = () => {\n\t\tthis.scrollIntoView(this.bottomDiv);\n\t\t//let id = '$$bottom'+uid();\n\t\t//this.bottomDiv = id;\n\t\t/*\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(this.bottomDiv);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t\t*/\n\t}\n\tprivate scrollIntoView(divId:string) {\n\t\tsetTimeout(() => {\n\t\t\tlet div = document.getElementById(divId);\n\t\t\tdiv?.scrollIntoView();\n\t\t}, 20);\n\t}\n\n    protected param: any;\n    protected firstSize = 100;\n    protected pageStart:any = undefined;\n    protected pageSize = 30;\n    protected appendPosition:'head'|'tail' = 'tail';\n\n\tprotected sortOrder:'asc'|'desc';\n\tprotected abstract async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\n\tprotected getPageId(item:T):any {return;}\n\tprotected setPageStart(item:T) {\n\t\tthis.pageStart = this.getPageId(item);\n\t}\n\t\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\n\t\tlet pageList = results.$page;\n\t\tif (this.itemConverter) {\n\t\t\tlet ret:T[] = [];\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\n\t\t\t\tret.push(item);\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t\tif (this.pageItemAction !== undefined) {\n\t\t\tlet len = pageList.length;\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tthis.pageItemAction(pageList[i], results);\n\t\t\t}\n\t\t}\n\t\treturn pageList;\n\t}\n\n    reset() {\n        this.isFirst = true;\n        this.beforeLoad = true;\n        this.loaded = false;\n        this.param = undefined;\n\t\tthis.allLoaded = false;\n\t\tthis.pageStart = undefined;\n        this._items.clear();\n        //this.setPageStart(undefined);\n    }\n\n    append(item:T) {\n        if (this.appendPosition === 'tail')\n            this._items.unshift(item);\n        else\n            this._items.push(item);\n    }\n\n    async first(param:any):Promise<void> {\n        this.reset();\n        this.beforeLoad = false;\n        this.param = param;\n        await this.more();\n\t}\n\n\tprivate changing = false;\n\tasync attach(): Promise<void> {\n\t\tif (this.sortOrder === undefined) {\n\t\t\tconsole.error('没有定义增减序，无法attach');\n\t\t\treturn;\n\t\t}\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet items = this._items;\n\t\tlet isAsc = this.sortOrder === 'asc';\n\t\t//let isTail:boolean, \n\t\tlet endItem:T;\n\t\tlet scrollToEnd:() => void;\n\t\tlet pushItem:(item:T) => void;\n\t\tif (this.appendPosition === 'tail') {\n\t\t\t//isTail = true;\n\t\t\tendItem = items[0];\n\t\t\tscrollToEnd = this.scrollToTop;\n\t\t\tpushItem = (item:T) => items.unshift(item);\n\n\t\t}\n\t\telse {\n\t\t\t//isTail = false;\n\t\t\tlet endIndex = items.length;\n\t\t\tendItem = items[endIndex-1];\n\t\t\tscrollToEnd = this.scrollToBottom;\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\n\t\t}\n\t\tlet startId = this.getPageId(endItem);\n\t\tlet pid = undefined;\n\t\tlet sum = 0, max = 50;\n\t\tfor (;sum < max;) {\n\t\t\tlet ret = await this.load(this.param, pid, 3);\n\t\t\tlet len = ret.length;\n\t\t\tif (len === 0) break;\n\n\t\t\tfor (let i=0; i<len; i++) {\n\t\t\t\tlet item = ret[i];\n\t\t\t\tpid = this.getPageId(item);\n\t\t\t\tif (isAsc === true) {\n\t\t\t\t\tif (pid >= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pid <= startId) {\n\t\t\t\t\t\tmax = 0;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tpushItem(item);\n\t\t\t\t/*\n\t\t\t\tif (isTail === true) {\n\t\t\t\t\tthis._items.unshift(item);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis._items.push(item);\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t++sum;\n\t\t\t}\n\t\t}\n\t\tthis.changing = false;\n\t\tif (sum > 0) {\n\t\t\tscrollToEnd();\n\t\t\t/*\n\t\t\tif (isTail === true) this.scrollToTop();\n\t\t\telse this.scrollToBottom();\n\t\t\t*/\n\t\t}\n\t}\n\n\tasync refresh(): Promise<void> {\n\t\tif (this.changing === true) return;\n\t\tthis.changing = true;\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\n\t\tthis._items.clear();\n\t\tthis.setLoaded(ret);\n\t\t/*\n\t\tfor (let i=0; i<len; i++) {\n\t\t\tlet item = ret[i];\n\t\t\tlet pid = this.getRefreshPageId(item);\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\n\t\t\t//let oldItem = this._items[index];\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\n\t\t\tif (index >= 0) {\n\t\t\t\t_.merge(this._items[index], item);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.splice(0, 0, item);\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.changing = false;\n\t}\n\n\tprotected getRefreshPageId(item:T) {\n\t\treturn this.getPageId(item);\n\t}\n\n    protected async onLoad(): Promise<void> {}\n    protected async onLoaded(): Promise<void> {}\n\n    async more():Promise<boolean> {\n        if (this.allLoaded === true) return false;\n\t\tif (this.loading === true) return true;\n\t\tif (this.changing === true) return true;\n\t\tthis.loading = true;\n\t\tthis.changing = true;\n        await this.onLoad();\n        if (this.pageStart === undefined) this.setPageStart(undefined);\n        let pageSize = this.pageSize + 1;\n        if (this.isFirst === true) {\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\n        }\n        let ret = await this.load(\n                this.param, \n                this.pageStart,\n\t\t\t\tpageSize);\n        this.loaded = true;\n\t\tlet len = ret.length;\n        if ((this.isFirst===true && len>this.firstSize) ||\n            (this.isFirst===false && len>this.pageSize))\n        {\n            this.allLoaded = false;\n            --len;\n            ret.splice(len, 1);\n        }\n        else {\n            this.allLoaded = true;\n\t\t}\n\t\t/*\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(ret[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...ret);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...ret.reverse());\n\t\t\t}\n\t\t}\n\t\t*/\n\t\tthis.setLoaded(ret);\n\t\tthis.isFirst = false;\n\t\tthis.onLoaded();\n\t\tthis.changing = false;\n\t\tthis.loading = false;\n\t\treturn !this.allLoaded;\n\t}\n\t\n\tprivate setLoaded(data:any[]) {\n\t\tlet len = data.length;\n        if (len === 0) {\n\t\t\tthis.setPageStart(undefined);\n            this._items.clear();\n\t\t}\n\t\telse {\n\t\t\tthis.setPageStart(data[len-1]);\n\t\t\tif (this.appendPosition === 'tail') {\n\t\t\t\tthis._items.push(...data);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._items.unshift(...data.reverse());\n\t\t\t}\n\t\t}\n\t}\n\n\tfindItem(item:any):T {\n\t\tlet pid = this.getPageId(item);\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\n\t\tif (index < 0) return;\n\t\treturn this._items[index];\n\t\t//let oldItem = this._items[index];\n\t\t//let oid = this.getPageId(oldItem);\n\t\t//if (pid === oid) return oldItem;\n\t}\n}\n","// typescript version of krasimir/navigo\n\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\n\nexport interface NamedRoute {\n\tas: string;\n\tuses: RouteFunc;\n\thooks?: Hooks;\n}\nexport interface Hooks {\n\tbefore: (done:()=>void, params:object) => void;\n\tafter: (params:object) => void;\n\tleave: (params:object) => void;\n\talready: (params:object) => void;\n}\ninterface Handler {\n\thandler: RouteFunc;\n\thooks: Hooks;\n}\ninterface LastResolved {\n\turl: string;\n\tquery: string;\n\thooks: Hooks;\n\tparams?: {[name:string]:string};\n\tname?: string;\n}\ninterface Route {\n\troute: string|RegExp;\n\thandler: RouteFunc,\n\tname: string,\n\thooks: Hooks\n}\n\nexport class Navigo {\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\n\tprivate static WILDCARD_REGEXP = /\\*/g;\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\n\tprivate static MATCH_REGEXP_FLAGS = '';\n\n\tprivate static isPushStateAvailable() {\n\t\treturn !!(\n\t\t  typeof window !== 'undefined' &&\n\t\t  window.history &&\n\t\t  window.history.pushState\n\t\t);\n\t}\n\t\n\tprivate static clean(s:string|RegExp) {\n\t\tif (s instanceof RegExp) return s;\n\t\treturn Navigo.cleanUrl(s);\n\t}\n\tprivate static cleanUrl(s:string) {\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\n\t}\n\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\n\t\tif (names.length === 0) return null;\n\t\tif (!match) return null;\n\t\treturn match\n\t\t  .slice(1, match.length)\n\t\t  .reduce((params, value, index) => {\n\t\t\t\tif (params === null) params = {};\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\n\t\t\t\treturn params;\n\t\t  }, null);\n\t}\n\t  \n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\n\t\tlet paramNames:string[] = [], regexp:RegExp;\n\t  \n\t\tif (route instanceof RegExp) {\n\t\t\tregexp = route;\n\t\t}\n\t\telse {\n\t\t\tregexp = new RegExp(\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\n\t\t\t\t\t\tparamNames.push(name);\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\n\t\t\t\t\t})\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\n\t\t}\n\t\treturn { regexp, paramNames };\n\t}\n\t  \n\tprivate static getUrlDepth(url:string):number {\n\t\treturn url.replace(/\\/$/, '').split('/').length;\n\t}\n\t  \n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\n\t}\n\t  \n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\n\t\treturn routes.map(route => {\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\n\t\t\treturn match ? { match, route, params } : false;\n\t\t}).filter(m => m);\n\t}\n\t  \n\tprivate static match(url:string, routes:Route[]) {\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\n\t}\n\t  \n\tprivate static root(url:string, routes:Route[]) {\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\n\t\tlet matched = routes.map(\n\t\t\troute => {\n\t\t\t\tlet r = route.route;\n\t\t\t\tif (r === '' || r === '*') return url;\n\t\t\t\tif (typeof r === 'string') {\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/\\\\w+');\n\t\t\t\t}\n\t\t\t\tlet routeExp = r + exp;\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t);\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\n\t\tlet len = matched.length;\n\t\tif (len === 0) return fallbackURL;\n\t\tlet matched0 = matched[0];\n\t\tif (len === 1) return matched0;\n\t\treturn matched.reduce((result, url) => {\n\t\t\tif (result.length > url.length) result = url;\n\t\t\treturn result;\n\t\t}, matched0);\n\t}\n\t  \n\tprivate static isHashChangeAPIAvailable() {\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\n\t}\n\t  \n\tprivate static extractGETParameters(url:string):string {\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\n\t}\n\t  \n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\n\t\tlet onlyURL = url, split:string[];\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\n\t  \n\t\tif (typeof hash === 'undefined') {\n\t\t\t// To preserve BC\n\t\t\thash = '#';\n\t\t}\n\t  \n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\n\t\t}\n\t\telse {\n\t\t\tsplit = url.split(hash);\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\n\t\t}\n\t\treturn onlyURL;\n\t}\n\t  \n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\n\t\tif (hooks && typeof hooks === 'object') {\n\t\t\tif (hooks.before) {\n\t\t\t\thooks.before((shouldRoute = true) => {\n\t\t\t\tif (!shouldRoute) return;\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\t}, params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (hooks.after) {\n\t\t\t\thandler();\n\t\t\t\thooks.after && hooks.after(params);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\thandler();\n\t}\n\t  \n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tif (!url.match(hash)) {\n\t\t  return false;\n\t\t}\n\t  \n\t\tlet split = url.split(hash);\n\t  \n\t\treturn split.length < 2 || split[1] === '';\n\t}\n\t\n\tprivate root:string;\n\tprivate _routes:Route[] = [];\n\tprivate _useHash:boolean;\n\tprivate _hash:string;\n\tprivate _paused:boolean;\n\tprivate _destroyed:boolean;\n\tprivate _lastRouteResolved:LastResolved;\n\tprivate _notFoundHandler:Handler;\n\tprivate _defaultHandler:Handler;\n\tprivate _usePushState:boolean;\n\tprivate _genericHooks:Hooks;\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\n\tprivate timout: any; //NodeJS.Timeout;\n\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\n\t\tthis.root = null;\n\t\tthis._useHash = useHash;\n\t\tthis._hash = (!hash)? '#' : hash;\n\t\tthis._paused = false;\n\t\tthis._destroyed = false;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._notFoundHandler = null;\n\t\tthis._defaultHandler = null;\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\n\t\tthis._genericHooks = null;\n\t\tthis._historyUpdateMethod = 'pushState';\n\t\n\t\tif (r) {\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\n\t\t} else if (useHash) {\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\n\t\t}\n\t\n\t\tthis._listen();\n\t\tthis.updatePageLinks();\n\t}\n  \n\tnavigate(path:string, absolute:boolean = false):Navigo {\n\t\tlet to:string;\n\t\tpath = path || '';\n\t\tif (this._usePushState) {\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\n\t\t\tthis._historyUpdate({}, '', to);\n\t\t\tthis.resolve();\n\t\t}\n\t\telse if (typeof window !== 'undefined') {\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\n\t\t\tlet {location} = window;\n\t\t\tlocation.href = location.href\n\t\t\t\t.replace(/#$/, '')\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\n\t\t}\n\t\treturn this;\n\t}\n\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\ton(...args:any[]):Navigo {\n\t\tlet arg0 = args[0];\n\t\tlet arg1 = args[1];\n\t\tswitch (typeof arg0) {\n\t\t\tcase 'function':\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\n\t\t\t\tif (!this._notFoundHandler) {\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tif (args.length < 2) break;\n\t\t\t\tif (arg0 === '/') {\n\t\t\t\t\tthis._defaultHandler = { \n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \n\t\t\t\t\t\thooks: args[2],\n\t\t\t\t\t};\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis._add(arg0, arg1, args[2]);\n\t\t\t\tbreak;\n\t\t}\n\t\treturn this;\n\t}\n\n\toff(handler:RouteFunc):Navigo {\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\n\t\t\tthis._defaultHandler = null;\n\t\t}\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\n\t\t\tthis._notFoundHandler = null;\n\t\t}\n\t\tthis._routes = this._routes.reduce((result, r) => {\n\t\t\tif (r.handler !== handler) result.push(r);\n\t\t\treturn result;\n\t\t}, []);\n\t\treturn this;\n\t}\n\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\n\t\tthis._notFoundHandler = { handler, hooks };\n\t\treturn this;\n\t}\n\n\tresolve(current?:string) {\n\t\tlet c = current || this._cLoc();\n\t\tlet root = this._getRoot();\n\t\tlet url = c.replace(root, '');\n\t\n\t\tif (this._useHash) {\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\n\t\t}\n\t\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\n\t\n\t\tif (this._paused) return false;\n\t\n\t\tif (\n\t\t\tthis._lastRouteResolved &&\n\t\t\tonlyURL === this._lastRouteResolved.url &&\n\t\t\tGETParameters === this._lastRouteResolved.query\n\t\t) {\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\n\t\n\t\tlet manageHooks = (handler:Handler) => {\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tthis._callLeave();\n\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\thooks: handler.hooks\n\t\t\t\t\t};\n\t\t\t\t\thandler.handler(GETParameters);\n\t\t\t\t}, handler.hooks);\n\t\t\t}, this._genericHooks);\n\t\t}\n\n\t\tif (matched === false) {\n\t\t\tif (this._defaultHandler && (\n\t\t\t\tonlyURL === '' ||\n\t\t\t\tonlyURL === '/' ||\n\t\t\t\tonlyURL === this._hash ||\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\n\t\t\t)) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters, \n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\n\t\t\t\t\t}, this._defaultHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._defaultHandler);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (this._notFoundHandler) {\n\t\t\t\t/*\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\t\tthis._callLeave();\n\t\t\t\t\t\tthis._lastRouteResolved = {\n\t\t\t\t\t\t\turl: onlyURL,\n\t\t\t\t\t\t\tquery: GETParameters,\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\n\t\t\t\t\t}, this._notFoundHandler.hooks);\n\t\t\t\t}, this._genericHooks);\n\t\t\t\t*/\n\t\t\t\tmanageHooks(this._notFoundHandler);\n\t\t\t}\n\t\t\treturn false;\t\n\t\t}\n\t\tlet m = matched;\n\t\tif (m) {\n\t\t\tthis._callLeave();\n\t\t\tthis._lastRouteResolved = {\n\t\t\t\turl: onlyURL,\n\t\t\t\tquery: GETParameters,\n\t\t\t\thooks: m.route.hooks,\n\t\t\t\tparams: m.params,\n\t\t\t\tname: m.route.name\n\t\t\t};\n\t\t\tlet handler = m.route.handler;\n\t\t\tNavigo.manageHooks(() => {\n\t\t\t\tNavigo.manageHooks(() => {\n\t\t\t\t\tm.route.route instanceof RegExp ?\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\n\t\t\t\t\thandler(m.params, GETParameters);\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\n\t\t\t}, this._genericHooks, m.params);\n\t\t\treturn m;\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis._routes = [];\n\t\tthis._destroyed = true;\n\t\tthis._lastRouteResolved = null;\n\t\tthis._genericHooks = null;\n\t\tclearTimeout(this.timout);\n\t\tif (typeof window !== 'undefined') {\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t}\n\n\tupdatePageLinks() {\n\t\t//var self = this;\n\t\tif (typeof document === 'undefined') return;\n\t\t\tthis._findLinks().forEach(link => {\n\t\t\tif (!link.hasListenerAttached) {\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\n\t\t\t\t\tvar location = this.getLinkPath(link);\n\t\t\n\t\t\t\t\tif (!this._destroyed) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tlink.hasListenerAttached = true;\n\t\t\t}\n\t\t});\n\t}\n\n\tgenerate(name:string, data:any = {}) {\n\t\tlet result = this._routes.reduce((result, route) => {\n\t\t\tif (route.name === name) {\n\t\t\t\tresult = route.route.toString();\n\t\t\t\tfor (let key in data) {\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}, '');\n\t\n\t\treturn this._useHash ? this._hash + result : result;\n\t}\n\n\tlink(path:string) {\n\t\treturn this._getRoot() + path;\n\t}\n\n\tpause(status:boolean = true) {\n\t\tthis._paused = status;\n\t\tif (status) {\n\t\t\tthis._historyUpdateMethod = 'replaceState';\n\t\t}\n\t\telse {\n\t\t\tthis._historyUpdateMethod = 'pushState';\n\t\t}\n\t}\n\n\tresume() {\n\t\tthis.pause(false);\n\t}\n\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\n\t\tthis._historyUpdateMethod = value;\n\t\treturn value;\n\t}\n\n\tdisableIfAPINotAvailable() {\n\t\tif (!Navigo.isPushStateAvailable()) {\n\t\t\tthis.destroy();\n\t\t}\n\t}\n\n\tlastRouteResolved() {\n\t\treturn this._lastRouteResolved;\n\t}\n\n\tgetLinkPath(link:any) {\n\t\treturn link.getAttribute('href');\n\t}\n\n\thooks(hooks:Hooks) {\n\t\tthis._genericHooks = hooks;\n\t}\n\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\n\t\tif (typeof route === 'string') {\n\t\t\troute = encodeURI(route);\n\t\t}\n\t\tthis._routes.push(\n\t\t\ttypeof handler === 'object' ?\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler: handler.uses,\n\t\t\t\tname: handler.as,\n\t\t\t\thooks: hooks || handler.hooks\n\t\t\t} \n\t\t\t:\n\t\t\t{\n\t\t\t\troute,\n\t\t\t\thandler, \n\t\t\t\tname: undefined,\n\t\t\t\thooks,\n\t\t\t}\n\t\t);\n\t\treturn this._add;\n\t}\n\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\n\t\tswitch (this._historyUpdateMethod) {\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\n\t\t}\n\t}\n\n\tprivate _getRoot() {\n\t\tif (this.root !== null) return this.root;\n\t\tlet cLoc = this._cLoc();\n\t\tlet cLocRoot = cLoc.split('?')[0];\n\t\tthis.root = Navigo.root(cLocRoot, this._routes);\n\t\treturn this.root;\n\t}\n\n\tprivate _listen() {\n\t\tif (this._usePushState) {\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\n\t\t}\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\n\t\t}\n\t\telse {\n\t\t\tlet cached = this._cLoc();\n\t\n\t\t\tlet check = () => {\n\t\t\t\tlet current = this._cLoc();\n\t\t\t\tif (cached !== current) {\n\t\t\t\t\tcached = current;\n\t\t\t\t\tthis.resolve();\n\t\t\t\t}\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\n\t\t\t\tthis.timout = setTimeout(check, 200);\n\t\t\t};\n\t\t\tcheck();\n\t\t}\n\t}\n\n\tprivate _cLoc() {\n\t\tif (typeof window !== 'undefined') {\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\n\t\t\t//}\n\t\t\treturn Navigo.cleanUrl(window.location.href);\n\t\t}\n\t\treturn '';\n\t}\n\n\tprivate _findLinks() {\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\n\t}\n\n\tprivate _onLocationChange = () => {\n\t\tconsole.log('_onLocationChange');\n\t\tthis.resolve();\n\t}\n\n\tprivate _callLeave() {\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\n\t\tif (lastRouteResolved) {\n\t\t\tlet {params, hooks} = lastRouteResolved;\n\t\t\tif (hooks) {\n\t\t\t\tif (hooks.leave) {\n\t\t\t\t\thooks.leave(params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n//export default Navigo;\nexport const navigo = new Navigo();\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport classNames from 'classnames';\nimport { IVPage } from './page';\nimport { IObservableValue } from 'mobx/lib/internal';\nimport '../../css/va-tab.css';\nimport { ScrollView } from './scrollView';\n\nexport type TabCaption = (selected:boolean) => JSX.Element;\n\nexport interface TabProp {\n    name: string;\n    caption: TabCaption;\n\tcontent?: () => JSX.Element;\n\tpage?: IVPage;\n    notify?: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tisSelected?: boolean;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n}\n\nexport interface TabsProps {\n    tabs: TabProp[];\n    tabPosition?: 'top' | 'bottom';\n    size?: 'sm' | 'lg' | 'md';\n    tabBg?: string;\n    contentBg?: string;\n    sep?: string;\n    selected?: string;\n    borderColor?: string;\n    borderWidth?: string;\n}\n\nclass Tab {\n\t@observable private loaded: boolean = false;\n    name: string;\n    @observable selected: boolean;\n    caption: TabCaption;\n\tcontentBuilder: ()=>JSX.Element;\n\tpage: IVPage;\n    notify: IObservableValue<number>;\n    load?: () => Promise<void>;\n\tonShown?: () => Promise<void>;\n\tonScroll?: () => void;\n\tonScrollTop?: () => Promise<boolean>;\n\tonScrollBottom?: () => Promise<void>;\n\tclassName?: string;\n\n    private _content: JSX.Element;\n    \n    get content(): JSX.Element {\n\t\tif (this.load && this.loaded === false) return null;\n\t\tif (this.selected === false) return this._content;\n\t\tif (!this._content) {\n\t\t\tif (this.contentBuilder !== undefined) {\n\t\t\t\tthis._content = this.contentBuilder();\n\t\t\t}\n\t\t\telse if (this.page !== undefined) {\n\t\t\t\tthis._content = this.page.content();\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\n\t\t\t}\n\t\t}\n\t\treturn this._content;\n    }\n\n    async shown() {\n        if (this.onShown !== undefined) {\n            await this.onShown();\n        }\n        if (this.load !== undefined) {\n\t\t\tif (this.loaded === false) {\n\t\t\t\tawait this.load();\n\t\t\t\tthis.loaded = true;\n\t\t\t}\n        }\n    }\n}\n\nexport const TabCaptionComponent = (label:string, icon:string, color:string) => <div \n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\n    <small>{label}</small>\n</div>;\n\nexport const TabCaption = TabCaptionComponent;\n\nexport class TabsView {\n\tprivate props: TabsProps;\n    private size: string;\n    private tabBg: string;\n    //private contentBg: string;\n    private sep: string;\n    @observable private selectedTab: Tab;\n    @observable private tabArr: Tab[];\n\n    constructor(props: TabsProps) {\n\t\tthis.props = props;\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\n\t\tthis.size = size || 'md';\n        this.tabArr = tabs.map(v => {\n            let tab = new Tab();\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\ttab.name = name;\n\t\t\tif (isSelected === true || name === selected) {\n\t\t\t\tthis.selectedTab = tab;\n\t\t\t}\n\t\t\ttab.selected = false;\n\t\t\ttab.caption = caption;\n\t\t\tif (content !== undefined) {\n\t\t\t\ttab.contentBuilder = content;\n\t\t\t}\n\t\t\telse if (page !== undefined) {\n\t\t\t\ttab.page = page;\n\t\t\t\t//contentBuilder = () => {return page.content()};\n\t\t\t}\n            tab.notify = notify;\n            tab.load = load;\n\t\t\ttab.onShown = onShown;\n\t\t\ttab.onScroll = onScroll;\n\t\t\ttab.onScrollTop = onScrollTop;\n\t\t\ttab.onScrollBottom = onScrollBottom;\n\t\t\ttab.className = className;\n            return tab;\n        });\n        this.tabBg = tabBack;\n        //this.contentBg = contentBack;\n        this.sep = sep;\n        if (this.selectedTab === undefined) {\n\t\t\tthis.selectedTab = this.tabArr[0];\n\t\t}\n        this.selectedTab.selected = true;\n    }\n\n    tabClick = async (tab:Tab) => {\n\t\tif (!tab) {\n\t\t\ttab = this.selectedTab;\n\t\t\tif (tab === undefined) {\n\t\t\t\tif (this.tabArr === undefined) return;\n\t\t\t\tif (this.tabArr.length === 0) return;\n\t\t\t\ttab = this.tabArr[0];\n\t\t\t}\n\t\t}\n\n        this.selectedTab.selected = false;\n        tab.selected = true;\n\t\tthis.selectedTab = tab;\n\t\t\n\t\tawait tab.shown();\n    }\n\n\t/*\n    showTab(tabName: string) {\n        let tab = this.tabs.find(v => v.name === tabName);\n        if (tab === undefined) return;\n        if (this.selectedTab !== undefined) this.selectedTab.selected = false;\n        tab.selected = true;\n        this.selectedTab = tab;\n\t}\n\t*/\n\n\tprivate tabs = observer(() => {\n        let {tabPosition, borderColor} = this.props;\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\n        if (borderColor) {\n            bsCur = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderLeftWidth: 1,\n                borderRightWidth: 1,\n                borderBottomWidth: 1,\n            }\n            bsTab = {\n                borderColor: borderColor,\n                borderStyle: 'solid',\n                borderTopWidth: 1,\n                borderBottomWidth: 1,\n                borderLeftWidth: 0,\n                borderRightWidth: 0,\n            }\n            if (tabPosition === 'top') {\n                bsCur.borderBottomWidth = 0;\n                bsCur.borderTopLeftRadius = 10;\n                bsCur.borderTopRightRadius = 10;\n                bsTab.borderTopWidth = 0;\n            }\n            else {\n                bsCur.borderTopWidth = 0;\n                bsCur.borderBottomLeftRadius = 10;\n                bsCur.borderBottomRightRadius = 10;\n                bsTab.borderBottomWidth = 0;\n            }\n        }\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\n\t\tlet tabs = <div className={cn}>\n            {this.tabArr.map((v,index) => {\n                let {selected, caption, notify} = v;\n                let notifyCircle:any;\n                if (notify !== undefined) {\n                    let num = notify.get();\n                    if (num !== undefined) {\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\n                    }\n                }\n                return <div key={index} onClick={()=>this.tabClick(v)} style={selected===true? bsCur:bsTab}>\n\t\t\t\t\t<div>\n\t\t\t\t\t{notifyCircle}\n\t\t\t\t\t{caption(selected)}\n\t\t\t\t\t</div>\n                </div>\n            })}\n\t\t</div>;\n\t\treturn tabs;\n\t});\n\n\tcontent = observer(() => {\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\n\t\treturn <>\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet {tabPosition} = this.props;\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\n\t\t\t\tlet tabs = React.createElement(this.tabs);\n\t\t\t\tlet pageHeader:any, pageFooter:any;\n\t\t\t\tif (page !== undefined) {\n\t\t\t\t\tpageHeader = page.header();\n\t\t\t\t\tpageFooter = page.footer();\n\t\t\t\t}\n\t\t\t\tlet header:any, footer:any;\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\n\t\t\t\tif (tabPosition === 'top') {\n\t\t\t\t\theader = <>\n\t\t\t\t\t\t<section className=\"tv-page-header\">\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\n\t\t\t\t\t</>;\n\t\t\t\t\tif (pageFooter !== undefined) {\n\t\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tif (pageHeader !== undefined) {\n\t\t\t\t\t\theader = <>\n\t\t\t\t\t\t\t<section className='tv-page-header'>\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\n\t\t\t\t\t\t\t</section>\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\n\t\t\t\t\t\t</>;\n\t\t\t\t\t}\n\t\t\t\t\tfooter = <>\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t<section className='tv-page-footer'>\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\n\t\t\t\t\t\t</section>\n\t\t\t\t\t</>;\n\t\t\t\t}\n\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = displayNone;\n\t\t\t\treturn <ScrollView key={index} className={className}\n\t\t\t\t\tstyle={style}\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\n\t\t\t\t\t{header}\n\t\t\t\t\t{content}\n\t\t\t\t\t{footer}\n\t\t\t\t</ScrollView>;\n\t\t\t})}\n\t\t</>;\n\t});\n\n    render() {\n\t\tlet {tabPosition} = this.props;\n\t\tlet tabs = <this.tabs />;\n\t\tlet header:any, footer:any;\n\t\tlet visibility:React.CSSProperties = {display:'none'};\n\t\tif (tabPosition === 'top') {\n\t\t\theader = <header>{tabs}</header>;\n\t\t}\n\t\telse {\n\t\t\tfooter = <footer>{tabs}</footer>;\n\t\t}\n\t\treturn <>\n\t\t\t{header}\n\t\t\t{this.tabArr.map((v,index) => {\n\t\t\t\tlet style:React.CSSProperties;\n\t\t\t\tif (v.selected===false) style = visibility;\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\n\t\t\t\t\t{v.content}\n\t\t\t\t</div>;\n\t\t\t})}\n\t\t\t{footer}\n\t\t</>;\n    }\n};\n\n@observer export class Tabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn this.tabsView.render();\n    }\n};\n\n@observer export class RootTabs extends React.Component<TabsProps> {\n\tprivate readonly tabsView: TabsView;\n    constructor(props: TabsProps) {\n\t\tsuper(props);\n\t\tthis.tabsView = new TabsView(props);\n\t\tsetTimeout(() => {\n\t\t\tthis.tabsView.tabClick(undefined);\n\t\t}, 100);\n    }\n\n    render() {\n\t\treturn React.createElement(this.tabsView.content);\n    }\n};\n","import * as React from 'react';\nimport { nav } from './nav';\nimport { Loading } from './loading';\nimport { Image as ImageControl } from './image';\nimport { Page } from './page/page';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { LMR } from './simple';\n\nexport interface ResUploaderProps {\n    className?: string;\n    label?: string;\n    multiple?: boolean;\n    maxSize?: number;\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\n}\n\n@observer\nexport class ResUploader extends React.Component<ResUploaderProps> {\n    private fileInput: HTMLInputElement;\n    @observable private fileName: string;\n\n    buildFormData():FormData {\n        let {maxSize} = this.props;\n        if (maxSize === undefined || maxSize <= 0) \n            maxSize = 100000000000;\n        else\n            maxSize = maxSize * 1024;\n        var files:FileList = this.fileInput.files;\n        var data = new FormData();\n        let len = files.length;\n        for (let i=0; i<len; i++) {\n            let file = files[i];\n            if (file.size > maxSize) return null;\n            data.append('files[]', file, file.name);\n        }\n    }\n\n    getFile0(): File {\n        return this.fileInput.files[0];\n    }\n\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\n        let resUrl = nav.resUrl + 'upload';\n        if (!formData) formData = this.buildFormData();\n        try {\n            nav.startWait();\n            let headers = new Headers();\n            headers.append('Access-Control-Allow-Origin', '*');\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \n            //let abortController = new AbortController();\n            let res = await fetch(resUrl, {\n                method: \"POST\",\n                body: formData,\n                headers: headers,\n                //signal: abortController.signal,\n            });\n            let json = await res.json();\n            return ':' + json.res.id;\n        }\n        catch (err) {\n            console.error('%s %s', resUrl, err);\n            return {error:err};\n        }\n        finally {\n            nav.endWait();\n        }\n    }\n\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let {onFilesChange} = this.props;\n        if (onFilesChange) onFilesChange(evt);\n        let files = evt.target.files;\n        let len = files.length;\n        let names:string[] = [];\n        for (let i=0; i<len; i++) {\n            names.push(files.item(i).name);\n        }\n        this.fileName = names.join(', ');\n    }\n\n    render() {\n        let {className, multiple, label} = this.props;\n        return <div>\n                <label className=\"btn btn-outline-success\">\n                    {label || '选择文件'} \n                    <input \n                        className={className}\n                        ref={t=>this.fileInput=t} \n                        onChange={this.onFilesChange}\n                        type='file' name='file' \n                        multiple={multiple} style={{display:'none'}} />\n                </label>\n                &nbsp;\n                {this.fileName}\n            </div>\n    }\n}\n\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\n    var unit;\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\n    while ( (unit = units.shift()) && size > 1024 ) {\n        size = size / 1024;\n    }\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\n}\n\ninterface ImageUploaderProps {\n    id?: string;\n    label?: string;\n    size?: 'sm' | 'md' | 'lg';\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\nconst largeSize = 800;\nconst mediumSize = 400;\nconst smallSize = 180;\n\n@observer\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\n    private imgBaseSize: number;\n    private suffix: string;\n    private resUploader: ResUploader;\n    @observable private file: File;    \n    @observable private desImgWidth: number;\n    @observable private desImgHeight: number;\n    @observable private desImgSize: number;\n    @observable private srcImgWidth: number;\n    @observable private srcImgHeight: number;\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private srcImage: string;\n    @observable private desImage: string;\n    @observable private fileError: string;\n    @observable private uploaded: boolean = false;\n\n    constructor(props: ImageUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(ImageUploader.imageTypes.indexOf(this.suffix) < 0){\n                this.fileError = `图片类型必须是 ${ImageUploader.imageTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.srcImage = reader.result as string;\n\t\t\t\tswitch (this.suffix ) {\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tawait this.setSize(this.props.size);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'svg':\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\n\t\t\t\t\t\tthis.desImage = this.srcImage;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n            };\n        }\n    }\n\n    private async setSize(size?: 'sm' | 'md' | 'lg') {\n        switch (size) {\n            default:\n            case 'sm':\n                this.imgBaseSize = smallSize; break;\n            case 'md':\n                this.imgBaseSize = mediumSize; break;\n            case 'lg':\n                this.imgBaseSize = largeSize; break;\n\t\t}\n\t\tthis.desImage = await this.compress();\n    }\n\n    private compress = ():Promise<string> => {\n        return new Promise<string>((resolve, reject) => {\n            var img = new Image();\n            img.src = this.srcImage;\n            img.onload = () => {\n                //var that = this;\n                // 默认按比例压缩\n                let {width, height} = img;\n                this.srcImgWidth = width;\n                this.srcImgHeight = height;\n                let scale = width / height;\n                let w:number, h:number;\n                if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\n                    w = width;\n                    h = height;\n                }\n                else if (scale < 0) {\n                    w = this.imgBaseSize;\n                    h = w / scale;\n                }\n                else {\n                    h = this.imgBaseSize;\n                    w = h * scale;\n                }\n                this.desImgWidth = Math.round(w);\n                this.desImgHeight = Math.round(h);\n                var quality = 0.7;  // 默认图片质量为0.7\n                //生成canvas\n                var canvas = document.createElement('canvas');\n                var ctx = canvas.getContext('2d');\n                // 创建属性节点\n                var anw = document.createAttribute(\"width\");\n                anw.nodeValue = String(w);\n                var anh = document.createAttribute(\"height\");\n                anh.nodeValue = String(h);\n                canvas.setAttributeNode(anw);\n                canvas.setAttributeNode(anh);\n                ctx.drawImage(img, 0, 0, w, h);\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\n                let blob = this.convertBase64UrlToBlob(base64);\n                this.desImgSize = blob.size;\n                if (this.desImgSize > 3*1024*1024) {\n                    this.fileError = \"图片大于3M，无法上传\";\n                    this.enableUploadButton = false;\n                }\n                resolve(base64);\n            }\n        });\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n        if (!this.resUploader) return;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.desImage);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    private showOrgImage = () => {\n        nav.push(<Page header=\"原图\">\n            <div className=\"p-3 text-center\">\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\n            </div>\n        </Page>);\n    }\n\n    private levelDiv() {\n        if (this.props.size) return;\n        let arr = [{caption:'小图', size:'sm'}];\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\n            arr.push({caption:'中图', size:'md'});\n        }\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\n            arr.push({caption:'大图', size:'lg'});\n        }\n        if (arr.length < 2) return;\n        return <div>{arr.map((v, index) => {\n            let {caption, size} = v;\n            return <label key={index} className=\"mr-3\"><input type=\"radio\" name=\"size\" \n                onChange={()=>this.setSize(size as any)}\n                defaultChecked={index===0} /> {caption}</label>;\n        })}</div>\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改图片'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择图片文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {ImageUploader.imageTypes.join(', ')} 格式图片。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                    <LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n                            :\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\n                                <div className=\"mr-5\">\n                                    {this.levelDiv()}\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\n                                    &nbsp; &nbsp;\n                                    文件大小：{formatSize(this.desImgSize)}\n                                    </div>\n                                </div>\n                                <button className=\"btn btn-primary\" \n                                    disabled={!this.enableUploadButton}\n                                    onClick={this.upload}>上传</button>\n                            </div>\n                    }\n                    right={this.desImage && \n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\n                            原图大小: {formatSize(this.file.size)}<br/>\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\n                        </button>\n                    }\n                    ></LMR>\n                </div>\n                <div className=\"text-center\" \n                    style={{\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\n                        padding: '8px'\n                    }}>\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\ninterface AudioUploaderProps {\n    id?: string;\n    label?: string;\n    onSaved?: (imageId:string) => Promise<void>;\n}\n\n@observer\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\n\tprivate static audioTypes = ['mp3', 'wav'];\n\n    private suffix: string;\n\tprivate resUploader: ResUploader;\n\t@observable private content: string;\n\t@observable private file: File;    \n\t@observable private fileSize: number;\n\n    @observable private isChanged: boolean = false;\n    @observable private resId: string;\n    @observable private enableUploadButton: boolean = false;\n    @observable private fileError: string;\n\t@observable private uploaded: boolean = false;\n\t@observable private uploading: boolean = false;\n\n    constructor(props: AudioUploaderProps) {\n        super(props);\n        this.resId = props.id;\n    }\n\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.fileError = undefined;\n        this.uploaded = false;\n        this.enableUploadButton = evt.target.files.length > 0;\n        if (this.enableUploadButton) {\n            this.file = evt.target.files[0];\n            let pos = this.file.name.lastIndexOf('.');\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\n                return;\n            }\n            let reader = new FileReader();\n            reader.readAsDataURL(this.file);\n            reader.onload = async () => {\n\t\t\t\tthis.content = reader.result as string;\n\t\t\t\tthis.fileSize = this.content.length;\n            };\n        }\n    }\n\n    private convertBase64UrlToBlob(urlData: string):Blob {\n        let arr = urlData.split(',');\n        let mime = arr[0].match(/:(.*?);/)[1];\n        let bstr = atob(arr[1]);\n        let n = bstr.length;\n        let u8arr = new Uint8Array(n);\n        while(n--){\n            u8arr[n] = bstr.charCodeAt(n);\n        }\n        return new Blob([u8arr], {type:mime});\n    }\n\n    private upload = async () => {\n\t\tif (!this.resUploader) return;\n\t\tthis.uploading = true;\n        let formData = new FormData();\n        let blob = this.convertBase64UrlToBlob(this.content);\n        formData.append('image', blob, this.file.name);\n        let ret = await this.resUploader.upload(formData);\n        if (typeof ret === 'object') {\n            let {error} = ret;\n            let type = typeof error;\n            let err:string;\n            switch (type) {\n                case 'undefined': err = 'error: undefined'; break;\n                case 'string': err = error; break;\n                case 'object': err = error.message; break;\n                default: err = String(err); break;\n            }\n            this.fileError = 'error: ' + type + ' - ' + err;\n            return;\n        }\n        this.resId = ret;\n        this.isChanged = (this.resId !== this.props.id);\n        this.uploaded = true;\n    }\n\n    private onSaved = (): Promise<void> => {\n        let {onSaved} = this.props;\n        onSaved && onSaved(this.resId);\n        return;\n    }\n\n    render() {\n        let {label} = this.props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={this.onSaved}>保存</button>;\n        return <Page header={label || '更改文件'} right={right}>\n            <div className=\"my-3 px-3 py-3 bg-white\">\n                <div>\n                    <div className=\"mb-3\">\n                        <ResUploader ref={v=>this.resUploader=v} \n                            multiple={false} maxSize={2048} \n                            label=\"选择音频文件\"\n                            onFilesChange={this.onFileChange} />\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\n                    </div>\n                </div>\n            </div>\n\t\t\t<LMR left=\n                    {\n                        this.uploaded === true? \n                            <div className=\"text-success p-2\">上传成功！</div>\n\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\tthis.uploading === true?\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\n\t\t\t\t\t\t\t\t:\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t/>\n        </Page>;\n    }\n}\n","import _ from 'lodash';\nimport { UqApi, UqData, UnitxApi, appInFrame } from '../net';\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\nimport { Action } from './action';\nimport { Sheet } from './sheet';\nimport { Query } from './query';\nimport { Book } from './book';\nimport { History } from './history';\nimport { Map } from './map';\nimport { Pending } from './pending';\nimport { CreateBoxId, BoxId } from './tuid';\nimport { LocalMap, LocalCache } from '../tool';\nimport { UQsMan } from './uqsMan';\nimport { ReactBoxId } from './tuid/reactBoxId';\nimport { Tag } from './tag/tag';\n\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'char' | 'text'\n    | 'datetime' | 'date' | 'time' | 'timestamp';\n\nexport function fieldDefaultValue(type:FieldType) {\n    switch (type) {\n        case 'tinyint':\n        case 'smallint':\n        case 'int':\n        case 'bigint':\n        case 'dec':\n            return 0;\n        case 'char':\n        case 'text':\n            return '';\n        case 'datetime':\n        case 'date':\n            return '2000-1-1';\n        case 'time':\n            return '0:00';\n    }\n}\n\nexport interface Field {\n    name: string;\n    type: FieldType;\n    tuid?: string;\n    arr?: string;\n    null?: boolean;\n    size?: number;\n    owner?: string;\n    _tuid: TuidBox;\n}\nexport interface ArrFields {\n    name: string;\n    fields: Field[];\n    id?: string;\n    order?: string;\n}\nexport interface FieldMap {\n    [name:string]: Field;\n}\nexport interface SchemaFrom {\n    owner:string;\n    uq:string;\n}\nexport interface TuidModify {\n    max: number;\n    seconds: number;\n}\n\nexport class UqMan {\n    private readonly actions: {[name:string]: Action} = {};\n    private readonly sheets: {[name:string]: Sheet} = {};\n    private readonly queries: {[name:string]: Query} = {};\n    private readonly books: {[name:string]: Book} = {};\n    private readonly maps: {[name:string]: Map} = {};\n    private readonly histories: {[name:string]: History} = {};\n\tprivate readonly pendings: {[name:string]: Pending} = {};\n\tprivate readonly tags: {[name:string]: Tag} = {};\n    private readonly tuidsCache: TuidsCache;\n    private readonly localAccess: LocalCache;\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\n    readonly localMap: LocalMap;\n    readonly localModifyMax: LocalCache;\n    readonly tuids: {[name:string]: Tuid} = {};\n    readonly createBoxId: CreateBoxId;\n    readonly newVersion: boolean;\n    readonly uqOwner: string;\n    readonly uqName: string;\n    readonly name: string;\n    readonly uqApi: UqApi;\n    readonly id: number;\n\n    uqVersion: number;\n\n    constructor(uqs:UQsMan, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\n        this.createBoxId = createBoxId;\n        if (createBoxId === undefined) {\n            this.createBoxId = this.createBoxIdFromTVs;\n            this.tvs = tvs || {};\n        }\n        let {id, uqOwner, uqName, access, newVersion: clearTuids} = uqData;\n        this.newVersion = clearTuids;\n        this.uqOwner = uqOwner;\n        this.uqName = uqName;\n        this.id = id;\n        this.name = uqOwner + '/' + uqName;\n        this.uqVersion = 0;\n        this.localMap = uqs.localMap.map(this.name);\n        this.localModifyMax = this.localMap.child('$modifyMax');\n        this.localAccess = this.localMap.child('$access');\n        //let hash = document.location.hash;\n        let baseUrl = 'tv/';\n\n        let acc: string[];\n        if (access === null || access === undefined || access === '*') {\n            acc = [];\n        }\n        else {\n            acc = access.split(';').map(v => v.trim()).filter(v => v.length > 0);\n        }\n        if (this.name === '$$$/$unitx') {\n            // 这里假定，点击home link之后，已经设置unit了\n            // 调用 UnitxApi会自动搜索绑定 unitx service\n            this.uqApi = new UnitxApi(appInFrame.unit);\n        }\n        else {\n            let {appOwner, appName} = uqs;\n            this.uqApi = new UqApi(baseUrl, appOwner, appName, uqOwner, uqName, acc, true);\n        }\n        this.tuidsCache = new TuidsCache(this);\n    }\n\n    get entities() {\n        return _.merge({}, \n            this.actions, this.sheets, this.queries, this.books,\n\t\t\tthis.maps, this.histories, this.pendings, this.tuids,\n\t\t\tthis.tags,\n        );\n    }\n\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\n        let {name} = tuid;\n        /*\n        let tuidUR = this.tuidURs[name];\n        if (tuidUR === undefined) {\n            let {ui, res} = this.getUI(tuid);\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\n        }\n        */\n        return new ReactBoxId(id, tuid, this.tvs[name]);\n    }\n\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\n    tuidDiv(name:string, div:string):TuidDiv {\n        let tuid = this.tuids[name.toLowerCase()]\n        return tuid && tuid.div(div.toLowerCase());\n    }\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\n    book(name:string):Book {return this.books[name.toLowerCase()]}\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\n    history(name:string):History {return this.histories[name.toLowerCase()]}\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\n\n    sheetFromTypeId(typeId:number):Sheet {\n        for (let i in this.sheets) {\n            let sheet = this.sheets[i];\n            if (sheet.typeId === typeId) return sheet;\n        }\n    }\n\n    readonly tuidArr: Tuid[] = [];\n    readonly actionArr: Action[] = [];\n    readonly sheetArr: Sheet[] = [];\n    readonly queryArr: Query[] = [];\n    readonly bookArr: Book[] = [];\n    readonly mapArr: Map[] = [];\n    readonly historyArr: History[] = [];\n    readonly pendingArr: Pending[] = [];\n    readonly tagArr: Tag[] = [];\n\n    async init() {\n        await this.uqApi.init();\n    }\n\n    async loadEntities(): Promise<string> {\n        try {\n            let accesses = this.localAccess.get();\n            if (!accesses) {\n                accesses = await this.uqApi.loadAccess();\n            }\n            if (!accesses) return;\n            this.buildEntities(accesses);\n        }\n        catch (err) {\n            return err;\n        }\n    }\n\n\tbuildEntities(entities:any) {\n        if (entities === undefined) {\n            debugger;\n        }\n        this.localAccess.set(entities);\n        let {access, tuids, version} = entities;\n        this.uqVersion = version;\n        this.buildTuids(tuids);\n        this.buildAccess(access);\n\t}\n\t\n    private buildTuids(tuids:any) {\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let {typeId, from} = schema;\n            let tuid = this.newTuid(i, typeId, from);\n            tuid.sys = true;\n        }\n        for (let i in tuids) {\n            let schema = tuids[i];\n            let tuid = this.getTuid(i);\n            tuid.setSchema(schema);\n        }\n        for (let i in this.tuids) {\n            let tuid = this.tuids[i];\n            tuid.buildFieldsTuid();\n        }\n\t}\n\n    async loadEntitySchema(entityName: string): Promise<any> {\n        return await this.uqApi.schema(entityName);\n    }\n\n    getTuid(name:string): Tuid {\n        return this.tuids[name];\n    }\n\n    private buildAccess(access:any) {\n        for (let a in access) {\n            let v = access[a];\n            switch (typeof v) {\n                case 'string': this.fromType(a, v); break;\n                case 'object': this.fromObj(a, v); break;\n            }\n        }\n    }\n\n    cacheTuids(defer:number) {\n        this.tuidsCache.cacheTuids(defer);\n    }\n\n    newAction(name:string, id:number):Action {\n        let action = this.actions[name];\n        if (action !== undefined) return action;\n        action = this.actions[name] = new Action(this, name, id)\n        this.actionArr.push(action);\n        return action;\n    }\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\n        let tuid = this.tuids[name];\n        if (tuid !== undefined) return tuid;\n        if (from !== undefined)\n            tuid = new TuidImport(this, name, id, from);\n        else\n            tuid = new TuidInner(this, name, id);\n        this.tuids[name] = tuid;\n        this.tuidArr.push(tuid);\n        return tuid;\n    }\n    newQuery(name:string, id:number):Query {\n        let query = this.queries[name];\n        if (query !== undefined) return query;\n        query = this.queries[name] = new Query(this, name, id)\n        this.queryArr.push(query);\n        return query;\n    }\n    private newBook(name:string, id:number):Book {\n        let book = this.books[name];\n        if (book !== undefined) return book;\n        book = this.books[name] = new Book(this, name, id);\n        this.bookArr.push(book);\n        return book;\n    }\n    private newMap(name:string, id:number):Map {\n        let map = this.maps[name];\n        if (map !== undefined) return map;\n        map = this.maps[name] = new Map(this, name, id)\n        this.mapArr.push(map);\n        return map;\n    }\n    private newTag(name:string, id:number):Tag {\n        let tag = this.tags[name];\n        if (tag !== undefined) return tag;\n        tag = this.tags[name] = new Tag(this, name, id)\n        this.tagArr.push(tag);\n        return tag;\n    }\n    private newHistory(name:string, id:number):History {\n        let history = this.histories[name];\n        if (history !== undefined) return;\n        history = this.histories[name] = new History(this, name, id)\n        this.historyArr.push(history);\n        return history;\n    }\n    private newPending(name:string, id:number):Pending {\n        let pending = this.pendings[name];\n        if (pending !== undefined) return;\n        pending = this.pendings[name] = new Pending(this, name, id)\n        this.pendingArr.push(pending);\n        return pending;\n    }\n    newSheet(name:string, id:number):Sheet {\n        let sheet = this.sheets[name];\n        if (sheet !== undefined) return sheet;\n        sheet = this.sheets[name] = new Sheet(this, name, id);\n        this.sheetArr.push(sheet);\n        return sheet;\n    }\n    private fromType(name:string, type:string) {\n        let parts = type.split('|');\n        type = parts[0];\n        let id = Number(parts[1]);\n        switch (type) {\n            //case 'uq': this.id = id; break;\n            case 'tuid':\n                // Tuid should not be created here!;\n                //let tuid = this.newTuid(name, id);\n                //tuid.sys = false;\n                break;\n            case 'action': this.newAction(name, id); break;\n            case 'query': this.newQuery(name, id); break;\n            case 'book': this.newBook(name, id); break;\n            case 'map': this.newMap(name, id); break;\n            case 'history': this.newHistory(name, id); break;\n            case 'sheet':this.newSheet(name, id); break;\n\t\t\tcase 'pending': this.newPending(name, id); break;\n\t\t\tcase 'tag': this.newTag(name, id); break;\n        }\n    }\n    private fromObj(name:string, obj:any) {\n        switch (obj['$']) {\n            case 'sheet': this.buildSheet(name, obj); break;\n        }\n    }\n    private buildSheet(name:string, obj:any) {\n        let sheet = this.sheets[name];\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\n        sheet.build(obj);\n    }\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\n        if (fields === undefined) return;\n        for (let f of fields) {\n            let {tuid} = f;\n            if (tuid === undefined) continue;\n            let t = this.getTuid(tuid);\n            if (t === undefined) continue;\n            f._tuid = t.buildTuidBox();\n        }\n        for (let f of fields) {\n            let {owner} = f;\n            if (owner === undefined) continue;\n            let ownerField = fields.find(v => v.name === owner);\n            if (ownerField === undefined) {\n                if (mainFields !== undefined) {\n                    ownerField = mainFields.find(v => v.name === owner);\n                }\n                if (ownerField === undefined) {\n                    debugger;\n                    throw new Error(`owner field ${owner} is undefined`);\n                }\n            }\n            let {arr, tuid} = f;\n            let t = this.getTuid(ownerField._tuid.tuid.name);\n            if (t === undefined) continue;\n            let div = t.div(arr || tuid);\n            f._tuid = div && div.buildTuidDivBox(ownerField);\n            if (f._tuid === undefined) {\n                debugger;\n                throw new Error(`owner field ${owner} is not tuid`);\n            }\n        }\n    }\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\n        if (arrFields === undefined) return;\n        for (let af of arrFields) {\n            let {fields} = af;\n            if (fields === undefined) continue;\n            this.buildFieldTuid(fields, mainFields);\n        }\n    }\n\n    pullModify(modifyMax:number) {\n        this.tuidsCache.pullModify(modifyMax);\n    }\n}\n","import { Entity } from './entity';\nimport { PageItems } from '../tool/pageItems';\nimport { EntityCaller } from './caller';\n\nexport interface SheetState {\n    name: string;\n    actions: SheetAction[];\n}\n\nexport interface SheetAction {\n    name: string;\n}\n\nexport interface StateCount {\n    state: string;\n    count: number;\n}\n\nexport class Sheet extends Entity {\n    get typeName(): string { return 'sheet';}\n    states: SheetState[];\n\n    /*\n    setStates(states: SheetState[]) {\n        for (let state of states) {\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\n        }\n    }*/\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.states = schema.states;\n    }\n    build(obj:any) {\n        this.states = [];\n        for (let op of obj.ops) {\n            this.states.push({name: op, actions:undefined});\n        }\n        /*\n        for (let p in obj) {\n            switch(p) {\n                case '#':\n                case '$': continue;\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\n            }\n        }*/\n    }\n    private createSheetState(name:string, obj:object):SheetState {\n        let ret:SheetState = {name:name, actions:[]};\n        let actions = ret.actions;\n        for (let p in obj) {\n            let action:SheetAction = {name: p};\n            actions.push(action);\n        }\n        return ret;\n    }\n    /*\n    private setStateAccess(s:SheetState, s1:SheetState) {\n        if (s === undefined) return;\n        for (let action of s1.actions) {\n            let acn = action.name;\n            let ac = s.actions.find(a=>a.name === acn);\n            if (ac === undefined) continue;\n            s.actions.push(action);\n        }\n    }*/\n    async save(discription:string, data:any):Promise<any> {\n        /*\n        await this.loadSchema();\n        let {id} = this.uq;\n        let text = this.pack(data);\n\n        let ret = await this.uqApi.sheetSave(this.name, );\n        return ret;\n        */\n        let {id} = this.uq;\n        //let text = this.pack(data);\n        let params = {app: id, discription: discription, data:data};\n        return await new SaveCaller(this, params).request();\n        /*\n        let {id, state} = ret;\n        if (id > 0) this.changeStateCount(state, 1);\n        return ret;\n        */\n    }\n    async action(id:number, flow:number, state:string, action:string) {\n        /*\n        await this.loadSchema();\n        return await this.uqApi.sheetAction(this.name, {id:id, flow:flow, state:state, action:action});\n        */\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\n    }\n    private unpack(data:any):any {\n        //if (this.schema === undefined) await this.loadSchema();\n        let ret = data[0];\n        let brief = ret[0];\n        let sheetData = this.unpackSheet(brief.data);\n        let flows = data[1];\n        return {\n            brief: brief,\n            data: sheetData,\n            flows: flows,\n        }\n    }\n    async getSheet(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.getSheet(this.name, id);\n        */\n        let ret = await new GetSheetCaller(this, id).request();\n        if (ret[0].length === 0) return await this.getArchive(id);\n        return this.unpack(ret);\n    }\n    async getArchive(id:number):Promise<any> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchive(this.name, id)\n        return this.unpack(ret);\n        */\n        let ret = await new SheetArchiveCaller(this, id).request();\n        return this.unpack(ret);\n    }\n\n    async getArchives(pageStart:number, pageSize:number) {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {pageStart:pageStart, pageSize:pageSize};\n        return await new SheetArchivesCaller(this, params).request();\n    }\n\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new StateSheetsCaller(this, params).request();\n    }\n    createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\n\n    async stateSheetCount():Promise<StateCount[]> {\n        /*\n        await this.loadSchema();\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\n        return this.states.map(s => {\n            let n = s.name, count = 0;\n            let r = ret.find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n        */\n        return await new StateSheetCountCaller(this, undefined).request();\n    }\n\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\n        return await new UserSheetsCaller(this, params).request();\n    }\n\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\n        /*\n        await this.loadSchema();\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\n        return ret;\n        */\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\n        return await new MySheetsCaller(this, params).request();\n    }\n}\n\n\nabstract class SheetCaller<T> extends EntityCaller<T> {\n    protected get entity(): Sheet {return this._entity as Sheet;}\n    protected readonly suffix:string;\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\n}\n\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\n    get path():string {return `sheet/${this.entity.name}`;}\n    buildParams() {\n        let {app, discription, data} = this.params;\n        return {\n            app: app,\n            discription: discription,\n            data: this.entity.pack(data)\n        };\n    }\n}\n\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\n    method = 'PUT';\n    get path():string {return `sheet/${this.entity.name}`;}\n    //buildParams() {return this.entity.buildParams(this.params);}\n}\n\nclass GetSheetCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //private id:number;\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\n}\n\nclass SheetArchiveCaller extends SheetCaller<number> {\n    //protected readonly params: number;  // id\n    method = 'GET';\n    //protected readonly suffix = 'archive';\n    buildParams() {}\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\n}\n\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'archives';\n}\n\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'states';\n}\n\nclass StateSheetCountCaller extends SheetCaller<undefined> {\n    method = 'GET';\n    protected readonly suffix = 'statecount';\n    xresult(res:any):any {\n        let {states} = this.entity;\n        return states.map(s => {\n            let n = s.name, count = 0;\n            let r = (res as any[]).find(v => v.state === n);\n            if (r !== undefined) count = r.count;\n            return {state: n, count: count} \n        });\n    }\n}\n\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'user-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\n    protected readonly suffix = 'my-sheets';\n    xresult(res:any):any {\n        return res;\n    }\n}\n\nexport class PageStateItems<T> extends PageItems<T> {\n    private sheet: Sheet;\n    constructor(sheet: Sheet) {\n        super(true);\n        this.sheet = sheet;\n        this.pageSize = 10;\n\t}\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n\t\treturn {$page: ret};\n\t}\n\t/*\n    protected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\n        let ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\n        return ret;\n\t}\n\t*/\n\tprotected getPageId(item:T) {\n\t\treturn item === undefined? 0 : (item as any).id;\n\t}\n\t/*\n    protected setPageStart(item:any) {\n        this.pageStart = item === undefined? 0 : item.id;\n\t}\n\t*/\n}\n","import {Query} from './query';\nimport { QueryQueryCaller } from './caller';\n\nexport class Book extends Query {\n    get typeName(): string { return 'book';}\n    protected queryApiName = 'book';\n\n    protected queryCaller(params: any): QueryQueryCaller {\n        return new BookQueryCaller(this, params);\n    }\n}\n\nexport class BookQueryCaller extends QueryQueryCaller {\n    get path():string {return `book/${this.entity.name}`;}\n}\n","import {Query} from './query';\n\nexport class History extends Query {\n    get typeName(): string { return 'history';}\n    protected queryApiName = 'history';\n}\n","import { Entity } from './entity';\nimport { Action, ActionSubmitCaller } from './action';\nimport { Query } from './query';\nimport { Field } from './uqMan';\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\n\ninterface MapActions {\n    add: Action;\n    del: Action;\n}\ninterface MapQueries {\n    all: Query;\n    page: Query;\n    query: Query;\n}\n\nexport class Map extends Entity {\n    get typeName(): string { return 'map';}\n    keys: Field[];\n    actions: MapActions = {} as any;\n    queries: MapQueries = {} as any;\n    schemaFrom: {owner:string; uq:string};\n\n    setSchema(schema:any) {\n        super.setSchema(schema);\n        this.schemaFrom = this.schema.from;\n        let {actions, queries, keys} = schema;\n        this.uq.buildFieldTuid(this.keys = keys);\n        for (let i in actions) {\n            let actionSchema = actions[i];\n            let {name} = actionSchema;\n            let action = this.uq.newAction(name, undefined);\n            action.setSchema(actionSchema);\n            action.buildFieldsTuid();\n            (this.actions as any)[i] = action;\n        }\n        for (let i in queries) {\n            let querySchema = queries[i];\n            let {name} = querySchema;\n            let query = this.uq.newQuery(name, undefined);\n            query.setSchema(querySchema);\n            query.buildFieldsTuid();\n            (this.queries as any)[i] = query;\n        }\n    }\n\n    async add(param:any) {\n        let ret = await new AddCaller(this, param).request();\n        return ret;\n    }\n\n    async del(param:any) {\n        let ret = await new DelCaller(this, param).request();\n        return ret;\n    }\n\n    async all() {\n        let ret = await new AllCaller(this, undefined).request();\n        return ret;\n    }\n\n    async page(param:any, pageStart:any, pageSize: number) {\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\n        return ret;\n    }\n\n    async query(param:any) {\n       let qc = new QueryCaller(this, param);\n       let ret = await qc.request();\n       return ret;\n   }\n    async table(params:any): Promise<any[]> {\n        let ret = await this.query(params);\n        for (let i in ret) {\n            return ret[i];\n        }\n    }\n    async obj(params:any):Promise<any> {\n        let ret = await this.table(params);\n        if (ret.length > 0) return ret[0];\n    }\n    async scalar(params:any):Promise<any> {\n        let ret = await this.obj(params);\n        for (let i in ret) return ret[i];\n    }\n}\n\nabstract class MapCaller extends EntityCaller<any> {\n    protected get entity(): Map {return this._entity as Map;}\n    get path():string {return undefined;}\n\n    protected abstract getCaller(param: any):EntityCaller<any>;\n\n    protected async innerCall(): Promise<any> {\n        let caller = this.getCaller(this.params);\n        let res = await this.entity.uqApi.xcall(caller);\n        let ret = caller.xresult(res.res);\n        return {res: ret};\n    }\n\n    buildParams() {\n        let p = super.buildParams();\n        return p;\n    }\n}\n\nclass AddCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass DelCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\n    }\n}\n\nclass AllCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\n    }\n}\n\nclass PageCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\n    }\n}\n\nclass QueryCaller extends MapCaller {\n    protected getCaller(param:any):EntityCaller<any> {\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\n    }\n}\n\nclass MapAddCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/add`}\n    get headers(): {[header:string]: string} {return undefined;}\n}\n\nclass MapDelCaller extends ActionSubmitCaller {\n    private map: Map;\n    constructor(map:Map, action:Action, params:any) {\n        super(action, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/del`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapAllCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/all`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapPageCaller extends QueryPageCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/page`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n\nclass MapQueryCaller extends QueryQueryCaller {\n    private map: Map;\n    constructor(map:Map, query:Query, params:any) {\n        super(query, params);\n        this.map = map;\n    }\n\n    get path():string {return `map/${this.map.name}/query`}\n    get headers(): {[header:string]: string} {return undefined}\n}\n","import {Query} from './query';\n\nexport class Pending extends Query {\n    get typeName(): string { return 'pending';}\n    protected queryApiName = 'pending';\n}\n","import * as React from 'react';\nimport { IValuesView, IValuesViewRenderOptions } from '../../components';\nimport { Tag, TagValue } from './tag';\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class TagView implements IValuesView {\n\tprivate tag: Tag;\n\tconstructor(tag: Tag) {\n\t\tthis.tag = tag;\n\t}\n\trender(values: number|string):JSX.Element {\n\t\tlet names:string[];\n\t\tif (typeof values === 'number') {\n\t\t\tnames = [this.tag.nameFromId(values)];\n\t\t}\n\t\telse {\n\t\t\tnames = this.tag.namesFromIds(values);\n\t\t}\n\t\treturn <div className=\"d-flex flex-wrap \">{names.map((name, index)=>{\n\t\t\treturn <div key={index} className=\"mx-2 border border-muted rounded px-3 bg-light\">{name}</div>\n\t\t})}</div>;\n\t}\n\trenderRadios(value: number, options: IValuesViewRenderOptions): JSX.Element {\n        let content = this.tag.values.map((item,index) => {\n\t\t\treturn <div className=\"col\" key={index}>{this.renderRadio(item, value, options)}</div>;\n        });\n\t\treturn this.renderView(options, content);\n\t}\n\trenderChecks(values: string, options: IValuesViewRenderOptions): JSX.Element {\n\t\tlet arr = values===undefined? undefined : values.split('|').map(v => Number(v));\n\t\tlet content = this.tag.values.map((item,index) => {\n\t\t\tlet checked: boolean = arr===undefined? undefined : arr.indexOf(item.id)>=0;\n\t\t\treturn <div className=\"col\" key={index}>{this.renderCheck(item, checked, options)}</div>\n\t\t});\n\t\treturn this.renderView(options, content);\n\t}\n\tprivate renderView(options: IValuesViewRenderOptions, content:any) {\n\t\tlet {className, wrapClassName} = options;\n\t\twrapClassName = wrapClassName?\n\t\t\t'row ' + wrapClassName\n\t\t\t:\n\t\t\t'row row-cols-2 row-cols-sm-3 row-cols-md-4';\n\t\treturn <div className={className} style={radioStyle}>\n\t\t\t<div className={wrapClassName}>\n                {content}\n\t\t\t</div>\n        </div>;\n\t}\n\tprivate renderRadio(item:TagValue, value: number, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, inputName, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"radio\" name={inputName}\n\t\t\t\tvalue={id} defaultChecked={value===id}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n\n\tprivate renderCheck(item:TagValue, checked: boolean, options: IValuesViewRenderOptions):JSX.Element {\n\t\tlet {id, name} = item;\n\t\tlet {inputs, onInputChange} = options;\n\t\tlet ref = inputs && ((input:HTMLInputElement)=>inputs[id]=input);\n\t\treturn <label className=\"form-radio-inline\">\n\t\t\t<input ref={ref} type=\"checkbox\"\n\t\t\t\tvalue={id} defaultChecked={checked}\n\t\t\t\tonChange={onInputChange} />\n\t\t\t{name}\n\t\t</label>;\n\t}\n}\n","import { Entity } from \"../entity\";\nimport { TagView } from \"./tagView\";\n\nexport interface TagValue {\n\tid: number;\n\tname: string;\n\text: string;\n}\n\nexport class Tag extends Entity {\n    get typeName(): string { return 'tag';}\n\tvalues: TagValue[];\n\tprivate coll: {[id:number]: TagValue} = {};\n\n\tprivate _view: TagView;\n\tget view(): TagView { \n\t\tif (this._view !== undefined) return this._view; \n\t\treturn this._view = new TagView(this);\n\t}\n\n\tnameFromId(id:number) {\n\t\tlet c = this.coll[id]; \n\t\treturn c===undefined? undefined : c.name;\n\t}\n\n\tnamesFromIds(ids:string):string[] {\n\t\tlet ret:string[] = [];\n\t\tfor (let id of ids.split('|')) {\n\t\t\tlet c = this.coll[Number(id)];\n\t\t\tlet name = c===undefined? undefined : c.name;\n\t\t\tif (name !== undefined) ret.push(name);\n\t\t}\n\t\treturn ret;\n\t}\n\n\tasync loadValues():Promise<TagValue[]> {\n\t\tif (this.values !== undefined) return this.values;\n\t\tthis.values = [];\n\t\tlet ret = await this.uqApi.get('tag/values/' + this.name);\n\t\tif (ret === undefined) return;\n\t\tlet lines = (ret as string).split('\\n');\n\t\tfor (let line of lines) {\n\t\t\tif (line.length === 0) continue;\n\t\t\tlet parts = line.split('\\t');\n\t\t\tlet id = Number(parts[0]);\n\t\t\tlet val = {\n\t\t\t\tid: id,\n\t\t\t\tname: parts[1],\n\t\t\t\text: parts[2],\n\t\t\t};\n\t\t\tthis.values.push(val);\n\t\t\tthis.coll[id] = val;\n\t\t}\n\t\treturn this.values;\n\t}\n}\n","export * from './page';\nexport * from './tabs';\nexport * from './scrollView';\n","export * from './schema';\nexport * from './uiSchema';\nexport * from './toUiSelectItems';\nexport * from './IValuesView';","\nexport const mobileRegex = /^[0-9]*$/;\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\n\nexport const EmailFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\n}\n\nexport const MobileFieldRule = (value:any): string|string[] => {\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n\nexport interface DropdownAction {\n    icon?: string;\n    caption?: string;\n    action?: () => void;\n}\n\nexport interface DropdownActionsProps {\n    icon?: string;\n    actions: DropdownAction[];\n    isRight?: boolean;\n    className?: string;\n}\n\nexport interface DropdownActionsState {\n    dropdownOpen: boolean;\n}\n\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\n    private menu: HTMLDivElement;\n    private button: HTMLElement;\n    constructor(props:DropdownActionsProps) {\n        super(props);\n        this.state = {\n            dropdownOpen: false\n        };\n    }\n\n    componentDidMount() {\n        document.addEventListener('click', this.handleDocumentClick);\n        document.addEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    componentWillUnmount() {\n        document.removeEventListener('click', this.handleDocumentClick);\n        document.removeEventListener('touchstart', this.handleDocumentClick);\n    }\n\n    private handleDocumentClick = (evt:any) => {\n        if (this.state.dropdownOpen === false) return;\n        if (this.button && this.button.contains(evt.target)) return;\n        if (!this.menu) return;\n        //if (!this.menu.contains(evt.target)) \n        this.toggle();\n    }\n\n    private toggle = () => {\n        this.setState({\n            dropdownOpen: !this.state.dropdownOpen\n        });\n    }\n\n    render() {\n        let {icon, actions, isRight, className} = this.props;\n        if (isRight === undefined) isRight = true;\n        let hasIcon = actions.some(v => v.icon!==undefined);\n        let {dropdownOpen} = this.state;\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\n\t\tlet cn = 'cursor-pointer dropdown-toggle btn btn-sm ';\n\t\tif (className) cn += className;\n        return <div className={'dropdown'}>\n\t\t\t<button ref={v=>this.button=v} \n\t\t\t\tclassName={cn}\n                data-toggle=\"dropdown\"\n                aria-expanded={dropdownOpen}\n                onClick={this.toggle}>\n                <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} />\n            </button>\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\n                {\n                    actions.map((v,index) => {\n                        let {icon, caption, action} = v;\n                        if (icon === undefined && caption === undefined) \n                            return <div className=\"dropdown-divider\" />;\n                        let i:any;\n                        if (hasIcon === true) {\n                            if (icon !== undefined) icon = 'fa-' + icon;\n                            i = <><i className={classNames('fa', icon, 'fa-fw')} aria-hidden={true}></i>&nbsp; </>;\n                        }\n                        if (action === undefined) \n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\n                            evt.preventDefault();\n                            action();\n                        }\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\n                            action();\n                        }\n                            // eslint-disable-next-line\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\n                            >{i} {caption}</a>\n                    })\n                }\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport { setRes } from '../../components';\n\nexport interface EasyDateProps {\n    date: Date | number;\n}\n\n//type YMD = (year:number, month:number, date:number) => string;\n//type MD = (month:number, date:number) => string;\n\nconst timeRes:{[prop:string]:any} = {\n\tmd: (month:number, date:number) => `${month}-${date}`,\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\tyesterday: 'Yday',\n\ttoday: 'Today',\n\ttomorrow: 'Tmw',\n\t$zh: {\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\n\t\tyesterday: '昨天',\n\t\ttoday: '今天',\n\t\ttomorrow: '明天',\n\t},\n\t$en: {\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\n\t\tyesterday: 'Yday',\n\t\ttoday: 'Today',\n\t\ttomorrow: 'Tmw',\n\t}\n}\n\nsetRes(timeRes, timeRes);\n\nfunction tt(str:string):any {\n\treturn timeRes[str];\n}\n\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\n    if (!vDate) return null;\n    let date: Date;\n    switch (typeof vDate) {\n        default: date = vDate as Date; break;\n        case 'string': date = new Date(vDate); break;\n        case 'number': date = new Date((vDate as number)*1000); break;\n    }\n\n    let now = new Date();\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\n    let d = date;\n    tick = now.getTime() - d.getTime();\n    let hour=d.getHours(), minute=d.getMinutes();\n    nDate=now.getDate();\n    _date=d.getDate();\n    month=d.getMonth()+1;\n    year=d.getFullYear();\n\tnowYear = now.getFullYear();\n\n\tlet appendTime:boolean = false;\n\tlet dPart:string = (function() {\n\t\tif (tick < -24*3600*1000) {\n\t\t\tif (year === nowYear) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('md')(month, _date);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt('ymd')(year, month, _date);\n\t\t\t}\n\t\t}\n\t\tif (tick < 24*3600*1000) {\n\t\t\tif (_date!==nDate) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\n\t\t\t}\n\t\t\tif (withTime===true) {\n\t\t\t\tappendTime = true;\n\t\t\t\treturn '';\n\t\t\t}\n\t\t\treturn tt('today');\n\t\t}\n\t\tif (year === nowYear) {\n\t\t\treturn tt('md')(month, _date);\n\t\t}\n\t\treturn tt('ymd')(year, month, _date);\n\t})();\n\n\tlet hm = hour + ((minute<10?':0':':') + minute);\n\n\t/*\n    if (tick < -24*3600*1000) {\n        if (year === nowYear)\n            return tt('md')(month, _date) + ' ' + hm;\n        else\n            return tt('ymd')(year, month, _date) + ' ' + hm;\n    }\n    if (always === true || tick < 24*3600*1000) {\n        return _date!==nDate? \n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \n            : withTime===true? hm : tt('today');\n    }\n    if (year === nowYear) {\n        return tt('md')(month, _date);\n    }\n\treturn tt('ymd')(year, month, _date);\n\t*/\n\tif (appendTime === true || always === true) {\n\t\treturn dPart + ' ' + hm;\n\t}\n\treturn dPart;\n}\n\n\nexport class EasyDate extends React.Component<EasyDateProps> {\n    render() {\n        return renderDate(this.props.date, false);\n    }\n}\n\ninterface EasyTimeProps extends EasyDateProps {\n\talways?: boolean;\n}\nexport class EasyTime extends React.Component<EasyTimeProps> {\n    render() {\n\t\tlet {date, always} = this.props;\n        return renderDate(date, true, always);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Image } from '.';\n\nexport interface MediaProps {\n    icon: string;\n    main: string|JSX.Element;\n    discription?: string | JSX.Element;\n    px?: number;\n    py?: number;\n}\n\nexport class Media extends React.Component<MediaProps> {\n    render() {\n        let {icon, main, discription, px, py} = this.props;\n        let disp:any;\n        if (typeof discription === 'string')\n            disp = <div>{discription}</div>;\n        else\n            disp = discription;\n        let cn = classNames(\n            'media', \n            px===undefined? 'px-0':'px-'+px, \n            py===undefined? 'py-2':'py-'+py);\n        return <div className={cn}>\n            <Image className=\"mr-3 w-4c h-4c\" src={icon} />\n            <div className=\"media-body\">\n                <h5 className=\"mt-0\">{main}</h5>\n                {disp}\n            </div>\n        </div>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\n\nexport interface SearchBoxProps {\n    className?: string;\n    label?: string;\n    initKey?: string;\n    placeholder?: string;\n    buttonText?: string;\n    maxLength?: number;\n    size?: 'sm' | 'md' | 'lg';\n    inputClassName?: string;\n    onSearch: (key:string)=>Promise<void>;\n    onFocus?: ()=>void;\n    allowEmptySearch?: boolean;\n}\n\n/*\nexport interface SearchBoxState {\n    disabled: boolean;\n}*/\n\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\n    private input: HTMLInputElement;\n    private key: string = null;\n    @observable private disabled: boolean;\n\n    private onChange = (evt: React.ChangeEvent<any>) => {\n        this.key = evt.target.value;\n        if (this.key !== undefined) {\n            this.key = this.key.trim();\n            if (this.key === '') this.key = undefined;\n        }\n        if (this.props.allowEmptySearch !== true) {\n            this.disabled = !this.key;\n        }\n    }\n    private onSubmit = async (evt: React.FormEvent<any>) => {\n        evt.preventDefault();\n        if (this.key === null) this.key = this.props.initKey || '';\n        if (this.props.allowEmptySearch !== true) {\n            if (!this.key) return;\n            if (this.input) this.input.disabled = true;\n        }\n        await this.props.onSearch(this.key);\n        if (this.input) this.input.disabled = false;\n    }\n    clear() {\n        if (this.input) this.input.value = '';\n    }\n    render() {\n        let {className, inputClassName, onFocus,\n            label, placeholder, buttonText, maxLength, size} = this.props;\n        let inputSize:string;\n        switch (size) {\n            default:\n            case 'sm': inputSize = 'input-group-sm'; break;\n            case 'md': inputSize = 'input-group-md'; break;\n            case 'lg': inputSize = 'input-group-lg'; break;\n        }\n        return <form className={className} onSubmit={this.onSubmit} >\n            <div className={classNames(\"input-group\", inputSize)}>\n                {label && <div className=\"input-group-addon align-self-center mr-2\">{label}</div>}\n                <input ref={v=>this.input=v} onChange={this.onChange}\n                    type=\"text\"\n                    name=\"key\"\n                    onFocus={onFocus}\n                    className={classNames('form-control', inputClassName || 'border-primary')}\n                    placeholder={placeholder}\n                    defaultValue={this.props.initKey}\n                    maxLength={maxLength} />\n                <div className=\"input-group-append\">\n                    <button className=\"btn btn-primary\"\n                        type=\"submit\"\n                        disabled={this.disabled}>\n                        <i className='fa fa-search' />\n                        <i className=\"fa\"/>\n                        {buttonText}\n                    </button>\n                </div>\n            </div>\n        </form>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { nav } from './nav';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { userApi } from '../net';\nimport { User } from '../tool';\n\nexport type UserLoader = (userId:number)=>Promise<any>;\n\nexport class UserCache<T> {\n\tprivate loader: UserLoader;\n\tprivate onLoaded: (user:User) => void;\n\tprivate map = observable(new Map<number, T|number>());\n\n\tconstructor(loader: UserLoader) {\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\n\t\tthis.loader = loader;\n\t}\n\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\n\t\tif (!id) return;\n\t\tif (typeof id === 'object') id = id.id;\n\t\tif (!id) return;\n\t\tthis.onLoaded = onLoaded;\n\t\tid = Number(id);\n\t\tlet ret = this.map.get(id);\n\t\tif (ret === undefined) {\n\t\t\tthis.map.set(id, id);\n\t\t}\n\t}\n\n\tgetValue(id:number|any):any {\n\t\tif (!id) return;\n\t\tswitch (typeof(id)) {\n\t\t\tcase 'object': \n\t\t\t\tid = id.id; \n\t\t\t\tif (!id) return;\n\t\t\t\tbreak;\n\t\t}\n\t\tlet ret = this.map.get(id);\n\t\tif (!ret) return;\n\t\tswitch (typeof(ret)) {\n\t\tdefault:\n\t\t\treturn ret;\n\t\tcase 'number':\n\t\t\tif (ret < 0) return id;\n\t\t\tthis.map.set(id, -id);\n\t\t\tthis.loader(id).then(v => {\n\t\t\t\tif (!v) v = null;\n\t\t\t\tthis.map.set(id, v);\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\n\t\t\t}).catch(reason => {\n\t\t\t\tconsole.error(reason);\n\t\t\t});\n\t\t\treturn id;\n\t\t}\n\t}\n}\n\nconst userCache = new UserCache(undefined);\n\nexport interface UserIconProps {\n    id: number;\n    className?: string;\n    style?: React.CSSProperties;\n    altImage?: string;\n    noneImage?: any;\n}\n\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\n    let {className, style, id, altImage, noneImage} = props;\n    let user = userCache.getValue(id);\n    switch (typeof user) {\n\tcase 'undefined':\n\tcase 'number':\n        return <div className={classNames(className, 'image-none')} style={style}>\n            {noneImage || <i className=\"fa fa-file-o\" />}\n        </div>;\n    }\n    let {icon} = user;\n    if (!icon) {\n        return <div className={classNames(className, 'image-none')} style={style}>\n            <i className=\"fa fa-file-o\" />\n        </div>;\n    }\n    if (icon.startsWith(':') === true) {\n        icon = nav.resUrl + icon.substr(1);\n    }\n    return <img src={icon} className={className} alt=\"img\"\n        style={style}\n        onError={evt=>{\n            if (altImage) evt.currentTarget.src=altImage;\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\n        }} />;\n});\n\nexport interface UserViewProps {\n\tid?: number;\n\tuser?: number|User;\n\trender: (user:User) => JSX.Element;\n\tonLoaded?: (user:User) => void\n}\n\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\n\tlet {id:idProp, user, render, onLoaded} = props;\n\tif (user === null) return <>null</>;\n\tswitch (typeof user) {\n\t\tcase 'undefined': \n\t\t\tuser = userCache.getValue(idProp);\n\t\t\tbreak;\n\t\tcase 'object': \n\t\t\tlet {/*obj, */id} = user as any;\n\t\t\t//if (typeof obj !== 'object') {\n\t\t\t\tuseUser(id, onLoaded);\n\t\t\t\tuser = userCache.getValue(id);\n\t\t\t//}\n\t\t\tbreak;\n\t\tcase 'number':\n\t\t\tuseUser(user as number, onLoaded);\n\t\t\tuser = userCache.getValue(user as number);\n\t\t\tbreak;\n\t\tcase 'string':\n\t\t\tuseUser(Number(user), onLoaded);\n\t\t\tuser = userCache.getValue(Number(user));\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tuser = undefined;\n\t\t\tbreak;\n\t}\n    switch (typeof user) {\n\t\tcase 'undefined':\n\t\tcase 'number':\n        \treturn <>{user}</>;\n    }\n    return render(user);\n});\n\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\n\tif (!id) return;\n\tif (typeof(id) === 'object') {\n\t\tid = (id as any).id;\n\t}\n\tuserCache.use(id, onLoaded);\n}\n","import { UqMan, TuidModify } from '../uqMan';\nimport { Tuid } from \"./tuid\";\nimport { env } from '../../tool';\n\ninterface Modify {\n    id: number;\n    entity: string;\n    key: string;\n}\n\nexport class TuidsCache {\n    private readonly uq: UqMan;\n    private modifyMax: TuidModify;\n    private cacheTimer: any;\n    constructor(uq: UqMan) {\n        this.uq = uq;\n    }\n\n    cacheTuids(defer:number) {\n        this.clearCacheTimer();\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\n    }\n    private clearCacheTimer() {\n        if (this.cacheTimer === undefined) return;\n        env.clearTimeout(this.cacheTimer);\n        this.cacheTimer = undefined;\n    }\n    private loadIds = () => {\n        this.clearCacheTimer();\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            let tuid = tuids[i];\n            tuid.cacheIds();\n        }\n    }\n    \n    pullModify(modifyMax:number) {\n        if (modifyMax === undefined) return;\n        let now = Math.floor(Date.now() / 1000);\n        if (this.modifyMax === undefined) {\n            this.modifyMax = this.uq.localModifyMax.get();\n            if (this.modifyMax === undefined) {\n                this.modifyMax = {\n                    max: modifyMax,\n                    seconds: now,\n                };\n                this.uq.localModifyMax.set(this.modifyMax);\n            }\n        }\n        let {max, seconds} = this.modifyMax;\n        let lockGap = 3600;\n        if (now - seconds < lockGap) return;\n        if (modifyMax <= max) return;\n        let tuidCached:string[] = [];\n        let {tuids} = this.uq;\n        for (let i in tuids) {\n            //if (tuids[i].cached === true) \n            tuidCached.push(i);\n        }\n        if (tuidCached.length === 0) return;\n        this.modifyMax.seconds = now;\n        this.innerPullModify(tuidCached.join('\\t'));\n    }\n\n    private async innerPullModify(tuidLists:string):Promise<void> {\n        let {uqApi, tuids} = this.uq;\n        let {max} = this.modifyMax;\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\n        let modifyMax:number = 0;\n        for (let modify of ret.queue) {\n\t\t\tlet {id, entity, key} = modify;\n\t\t\tif (!key) continue;\n            let tuid = tuids[entity];\n            if (tuid === undefined) continue;\n            let item = group[entity];\n            if (item === undefined) {\n                item = group[entity] = {tuid: tuid, ids:[]};\n            }\n            item.ids.push(key);\n            if (id > modifyMax) modifyMax = id;\n        }\n        for (let i in group) {\n            let {tuid, ids} = group[i];\n            await tuid.modifyIds(ids);\n        }\n        let now = Math.floor(Date.now() / 1000);\n        this.modifyMax = {\n            max: modifyMax,\n            seconds: now,\n        }\n        this.uq.localModifyMax.set(this.modifyMax);\n    }\n}\n","import { LocalMap, LocalCache, env } from '../tool';\nimport { UqData, UqAppData, loadAppUqs } from '../net';\nimport { UqMan } from './uqMan';\nimport { TuidImport, TuidInner } from './tuid';\nimport { nav } from '../components';\n\nexport interface TVs {\n    [uqName:string]: {\n        [tuidName: string]: (values: any) => JSX.Element;\n    }\n}\n\nexport class UQsMan {\n\tstatic _uqs: any;\n\tstatic value: UQsMan;\n\tstatic errors: string[];\n\n\tstatic async load(tonvaAppName:string, version:string, tvs:TVs) {\n\t\tlet uqsMan = UQsMan.value = new UQsMan(tonvaAppName, tvs);\n        let {appOwner, appName} = uqsMan;\n        let {localData} = uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        uqsMan.id = id;\n        await uqsMan.init(uqs);\n        let retErrors = await uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                UQsMan._uqs = uqsMan.buildUQs();\n                return;\n            }\n        }\n        UQsMan.errors = retErrors;\n\t}\n\n    private collection: {[uqName: string]: UqMan};\n    private readonly tvs: TVs;\n\n    readonly name: string;\n    readonly appOwner: string;\n    readonly appName: string;\n    readonly localMap: LocalMap;\n    readonly localData: LocalCache;\n    id: number;\n\n    private constructor(tonvaAppName:string, tvs:TVs) {\n        this.tvs = tvs || {};\n        this.buildTVs();\n        this.collection = {};\n        let parts = tonvaAppName.split('/');\n        if (parts.length !== 2) {\n            throw new Error('tonvaApp name must be / separated, owner/app');\n        }\n        this.appOwner = parts[0];\n        this.appName = parts[1];\n        this.localMap = env.localDb.map(tonvaAppName);\n        this.localData = this.localMap.child('uqData');\n    }\n\n    // to be removed in the future\n    addUq(uq: UqMan) {\n        this.collection[uq.name] = uq;\n    }\n\n    private buildTVs() {\n        for (let i in this.tvs) {\n            let uqTVs = this.tvs[i];\n            if (uqTVs === undefined) continue;\n            let l = i.toLowerCase();\n            if (l === i) continue;\n            this.tvs[l] = uqTVs;\n            for (let j in uqTVs) {\n                let en = uqTVs[j];\n                if (en === undefined) continue;\n                let lj = j.toLowerCase();\n                if (lj === j) continue;\n                uqTVs[lj] = en;\n            }\n        }\n    }\n\n    async init(uqsData:UqData[]):Promise<void> {\n        let promiseInits: PromiseLike<void>[] = [];\n        for (let uqData of uqsData) {\n            let {uqOwner, uqName} = uqData;\n            let uqFullName = uqOwner + '/' + uqName;\n            //let uqUI = this.ui.uqs[uqFullName] as UqUI || {};\n            //let cUq = this.newCUq(uqData, uqUI);\n            //this.cUqCollection[uqFullName] = cUq;\n            //this.uqs.addUq(cUq.uq);\n            let uq = new UqMan(this, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\n            this.collection[uqFullName] = uq;\n            let lower = uqFullName.toLowerCase();\n            if (lower !== uqFullName) {\n                this.collection[lower] = uq;\n            }\n            promiseInits.push(uq.init());\n        }\n        await Promise.all(promiseInits);\n    }\n\n    async load(): Promise<string[]> {\n        let retErrors:string[] = [];\n        let promises: PromiseLike<string>[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            promises.push(uq.loadEntities());\n\t\t}\t\t\n        let results = await Promise.all(promises);\n        for (let result of results)\n        {\n            let retError = result; // await cUq.loadSchema();\n            if (retError !== undefined) {\n                retErrors.push(retError);\n                continue;\n            }\n\t\t}\n        return retErrors;\n    }\n\n    buildUQs(): any {\n        let that = this;\n        let uqs:any = {};\n        for (let i in this.collection) {\n            let uqMan = this.collection[i];\n            //let n = uqMan.name;\n            let uqName = uqMan.uqName;\n            let l = uqName.toLowerCase();\n            let entities = uqMan.entities;\n            let keys = Object.keys(entities);\n            for (let key of keys) {\n                let entity = entities[key];\n                let {name} = entity;\n                //if (name !== sName) \n                //entities[sName] = entity;\n                entities[name.toLowerCase()] = entity;\n            }\n            //uqs[i] = entities;\n            //uqs[uqName] = entities;\n            //if (l !== uqName) \n            uqs[l] = new Proxy(entities, {\n                get: function(target, key, receiver) {\n                    let lk = (key as string).toLowerCase();\n                    let ret = target[lk];\n                    if (ret !== undefined) return ret;\n\t\t\t\t\tdebugger;\n\t\t\t\t\tlet err = `entity ${uqName}.${String(key)} not defined`;\n                    console.error(err);\n                    that.showReload('UQ错误：' + err);\n                    return undefined;\n                }\n            });\n        }\n        //let uqs = this.collection;\n        return new Proxy(uqs, {\n            get: function (target, key, receiver) {\n                let lk = (key as string).toLowerCase();\n                let ret = target[lk];\n                if (ret !== undefined) return ret;\n                /*\n                for (let i in uqs) {\n                    if (i.toLowerCase() === lk) {\n                        return uqs[i];\n                    }\n                }*/\n                debugger;\n                console.error('error in uqs');\n                that.showReload(`代码错误：新增 uq ${String(key)}`);\n                return undefined;\n            },\n        });\n    }\n\n    private showReload(msg: string) {\n        this.localMap.removeAll();\n        nav.showReloadPage(msg);\n    }\n\n    setTuidImportsLocal():string[] {\n        let ret:string[] = [];\n        for (let i in this.collection) {\n            let uq = this.collection[i];\n            for (let tuid of uq.tuidArr) {\n                if (tuid.isImport === true) {\n                    let error = this.setInner(tuid as TuidImport);\n                    if (error) ret.push(error);\n                }\n            }\n        }\n        return ret;\n    }\n\n    private setInner(tuidImport: TuidImport):string {\n        let {from} = tuidImport;\n        let fromName = from.owner + '/' + from.uq;\n        let uq = this.collection[fromName];\n        if (uq === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`;\n        }\n        let iName = tuidImport.name\n        let tuid = uq.tuid(iName);\n        if (tuid === undefined) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\n        }\n        if (tuid.isImport === true) {\n            //debugger;\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\n        }\n        tuidImport.setFrom(tuid as TuidInner);\n    }\n}\n","import _ from 'lodash';\nimport { Context } from '../context';\nimport { FormRes } from '../../../res/formRes';\n\nexport abstract class Rule {\n    abstract check(defy:string[], value:any):void;\n}\n\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\nexport type FieldRule = (value:any) => string[] | string;\n\nexport class RuleCustom extends Rule {\n    private func: FieldRule;\n    constructor(func: FieldRule) {\n        super();\n        this.func = func;\n    }\n    check(defy:string[], value:any) {\n        let ret = this.func(value);\n        if (ret === undefined) return;\n        switch (typeof ret) {\n            case 'undefined': return;\n            case 'string': defy.push(ret as string); return;\n            default: defy.push(...ret); return;\n        }        \n    }\n}\n\nexport abstract class RulePredefined extends Rule {\n    protected res: FormRes;\n    constructor(res: FormRes) {\n        super();\n        this.res = res;\n    }\n}\n\nexport class RuleRequired extends RulePredefined {\n    check(defy:string[], value:any) {\n        switch (typeof value) {\n            default:\n            case 'boolean': return;\n            case 'object':\n                if (value !== null) return;\n                break;\n            case 'string':\n                if ((value as string).trim().length > 0) return;\n                break;\n            case 'number':\n                if (isNaN(value as number) === false) return;\n                break;\n            case 'undefined':\n                break;\n        }\n        defy.push(this.res.required);\n    }\n}\n\nexport class RuleNum extends RulePredefined {\n    private minMsg: _.TemplateExecutor;\n    private maxMsg: _.TemplateExecutor;\n    protected min: number;\n    protected max: number\n    constructor(res: FormRes, min?: number, max?: number) {\n        super(res);\n        this.minMsg = _.template(res.min);\n        this.maxMsg = _.template(res.max);\n        this.min = min;\n        this.max = max;\n    }\n    check(defy:string[], value:any) {\n        if (value === undefined || value === null) return;\n        let n = Number(value);\n        if (isNaN(n) === true) {\n            defy.push(this.res.number);\n        }\n        else {\n            this.checkMore(defy, n);\n        }\n    }\n\n    protected checkMore(defy:string[], value: number) {\n        if (this.min !== undefined && Number(value) < this.min) {\n            defy.push(this.minMsg({min:this.min}));\n        }\n        if (this.max !== undefined && Number(value) > this.max) {\n            defy.push(this.maxMsg({max:this.max}));\n        }\n    }\n}\n\nexport class RuleInt extends RuleNum {\n    protected checkMore(defy:string[], n: number) {\n        super.checkMore(defy, n);\n        if (Number.isInteger(n) === false) {\n            defy.push(this.res.integer);\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { ItemSchema } from '../../schema';\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../rules';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\n\nexport abstract class Widget {\n    name: string;\n    protected context: Context;\n    protected fieldProps:FieldProps;\n    protected children: React.ReactNode;\n    protected _itemSchema: ItemSchema;\n    protected _ui: UiItem;\n    protected defaultValue: any;\n    protected value: any;\n    protected rules: Rule[];\n    @observable errors: string[] = [];\n    @observable protected contextErrors: string[] = [];\n    @computed protected get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\n    protected readOnly:boolean;\n    protected disabled:boolean;\n    @observable visible:boolean;\n\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\n        this.context = context;\n        let {name} = itemSchema;\n        this.name = name;\n        this._itemSchema = itemSchema;\n        this.fieldProps = fieldProps;\n        this.children = children;\n        this._ui = context.getUiItem(name);\n        if (this.ui === undefined) {\n            this.readOnly = false;\n            this.disabled = false;\n            this.visible = true;\n        }\n        else {\n            let {readOnly, disabled, visible} = this.ui;\n            this.readOnly = (readOnly === true);\n            this.disabled = (disabled === true);\n            this.visible = !(visible === false);            \n        }\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\n        // this.init();\n    }\n\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\n    protected get ui(): UiItem {return this._ui};\n\n    init() {\n        this.rules = [];\n        if (this.itemSchema.required === true) {\n            this.rules.push(new RuleRequired(this.context.form.res));\n        }\n        this.buildRules();\n        if (this.ui === undefined) return;\n        let {rules} = this.ui;\n        if (rules === undefined) return;\n        if (Array.isArray(rules) === false) {\n            this.rules.push(new RuleCustom(rules as FieldRule));\n            return;\n        }\n        for (let rule of rules as FieldRule[]) {\n            this.rules.push(new RuleCustom(rule));\n        }\n    }\n\n    protected buildRules() {\n    }\n\n    checkRules() {\n        let defy:string[] = [];\n        for (let r of this.rules) r.check(defy, this.value);\n        if (defy.length === 0) {\n            this.context.removeErrorWidget(this);\n        }\n        else {\n            this.context.addErrorWidget(this);\n            this.errors.push(...defy);\n        }\n    }\n\n    @computed get isOk() {\n        return this.errors.length ===0;\n    }\n\n    setError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.errors.push(err);\n        else this.errors.push(...err);\n    }\n\n    setContextError(err:string | string[]) {\n        if (err === undefined) return;\n        if (typeof err === 'string') this.contextErrors.push(err);\n        else this.contextErrors.push(...err);\n    }\n\n    clearError() {\n        this.errors.splice(0);\n    }\n\n    clearContextError() {\n        this.contextErrors.splice(0);\n    }\n\n    protected parse(value:any):any {return value}\n\n    protected setElementValue(value:any) {}\n    protected setDataValue(value:any) {\n        if (this.isChanging === true) return;\n        this.context.initData[this.name] = this.value = this.parse(value);\n    }\n\n    setValue(value:any) {\n        if (this.isChanging === true) return;\n        //this.setDataValue(value);\n        //this.setElementValue(value);\n        this.changeValue(value, false);\n    }\n\n    getValue() {\n        return this.context.getValue(this.name);\n    }\n\n    getReadOnly():boolean {return this.readOnly}\n    getDisabled():boolean {return this.disabled}\n    getVisible():boolean {return this.visible}\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}\n    setVisible(value:boolean) {this.visible = value}\n\n    private isChanging: boolean;\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n\n    protected changeValue(newValue: any, fromElement: boolean) {\n        let prev = this.value;\n        let onChanging: ChangingHandler;\n        let onChanged: ChangedHandler;\n        if (this.ui !== undefined) {\n            onChanging = this.ui.onChanging;\n            onChanged = this.ui.onChanged;\n        }\n        let allowChange = true;\n        if (onChanging !== undefined) {\n            this.isChanging = true;\n            allowChange = onChanging(this.context, this.value, prev);\n            this.isChanging = false;\n        }\n        if (allowChange === true) {\n            this.setDataValue(newValue);\n            if (fromElement !== true) this.setElementValue(newValue);\n            if (onChanged !== undefined) {\n                this.isChanging = true;\n                onChanged(this.context, this.value, prev);\n                this.isChanging = false;\n            }\n        }\n    }\n\n    protected get className():string {\n        let fieldClass:string;\n        if (this.context.inNode === false) fieldClass = 'form-control';\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\n    }\n\n    protected abstract render():JSX.Element;\n\n    protected renderBody():JSX.Element {\n        let elDiscription;\n        if (this.hasError === false && this.ui) {\n            let {discription, discriptionClassName} = this.ui;\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\n            elDiscription = <span className={discriptionClassName}>\n                {discription}\n            </span>;\n        }\n        return <>\n            {this.render()}\n            {elDiscription}\n        </>;\n    }\n\n    container = observer(():JSX.Element => {\n        if (this.visible === false) return null;\n        let {form, inNode} = this.context;\n        if (inNode === true) return this.render();\n        let label:any = this.label;\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\n        }\n        return form.FieldContainer(label, this.renderBody());\n    })\n\n    protected get label():string {\n        let label:any;\n        if (this.ui === undefined) {\n            label = this.name;\n        }\n        else {\n            let uiLabel = this.ui.label;\n            if (uiLabel === null) label = null;\n            else label = uiLabel || this.name;\n        }\n        return label;\n    }\n\n    protected renderTemplet():JSX.Element | undefined {\n        if (this.children !== undefined) {\n            return <>{this.children}</>;\n        }\n        if (this.ui === undefined) return undefined;\n        let {Templet} = this.ui;\n        if (typeof Templet === 'function') return Templet(this.value);\n        return Templet;\n    }\n\n    protected renderErrors() {\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\n        if (errorList.length === 0) return null;\n        let {inNode} = this.context;\n        let tag = inNode === true? 'span' : 'div';\n        return errorList.map(err => React.createElement(tag, \n            {\n                key: err, \n                className: 'text-danger d-inline-block my-2 ml-3'\n            },\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\n        ));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextItem, StringSchema } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class TextWidget extends Widget {\n    protected inputType = 'text';\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\n    protected input: HTMLInputElement;\n    @observable protected hasFocus: boolean;\n\n    protected setElementValue(value:any) {\n        if (this.input === null) return;\n        this.input.value = value;\n    }\n    protected get placeholder() {return (this.ui && this.ui.placeholder) || this.name}\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\n        this.internalOnKeyDown(evt);\n        if (evt.keyCode !== 13) return;\n        let {onEnter} = this.context.form.props;\n        if (onEnter === undefined) return;\n\n        this.changeValue(evt.currentTarget.value, true);\n\n        //this.checkRules();\n        //this.context.checkContextRules();\n        this.input.blur();\n\n        let ret = await onEnter(this.name, this.context);\n        if (ret !== undefined) {\n            this.context.setError(this.name, ret);\n        }\n    }\n\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n    }\n\n    protected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n\t\tthis.context.checkContextRules();\n\t\tthis.hasFocus = false;\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n\t\tthis.hasFocus = true;\n    }\n    protected onChange(evt: React.ChangeEvent<any>) {\n    }\n\n    setReadOnly(value:boolean) {\n        if (this.input === null) return;\n        this.input.readOnly = this.readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        if (this.input === null) return;\n        this.input.disabled = this.disabled = value;\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {\n            //'form-control': true,\n        };\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, cn)}\n            type={this.inputType}\n            defaultValue={this.value}\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\n            placeholder={this.placeholder}\n            readOnly={this.readOnly}\n            disabled={this.disabled}\n            onKeyDown = {this.onKeyDown}\n            onFocus = {this.onFocus}\n            onBlur={this.onBlur}\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTextAreaItem } from '../../schema';\nimport { StringSchema } from '../../schema';\n\nexport class TextAreaWidget extends Widget {\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\n    protected input: HTMLTextAreaElement;\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\n\n    protected setElementValue(value:any) {this.input.value = value}\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.setValue(evt.currentTarget.value);\n    }\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\n        this.onInputChange(evt);\n        this.checkRules();\n        this.context.checkContextRules();\n    }\n    protected onFocus = (evt: React.FocusEvent<any>) => {\n        this.clearError();\n        this.context.removeErrorWidget(this);\n        this.context.clearErrors();\n    }\n\n    render() {\n        let renderTemplet = this.renderTemplet();\n        if (renderTemplet !== undefined) return renderTemplet;\n        let cn:any = {};\n        if (this.hasError === true) {\n            cn['is-invalid'] = true;\n        }\n        else {\n            cn['required-item'] = this.itemSchema.required === true;\n        }\n        return <>\n\t\t\t<textarea ref={(input) => this.input=input}\n\t\t\t\tonBlur={this.onBlur} \n\t\t\t\tonFocus={this.onFocus}\n                className={classNames(this.className, cn)}\n                rows={this.ui && this.ui.rows}\n                maxLength={this.itemSchema.maxLength}\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\n            {this.renderErrors()}\n        </>;\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class PasswordWidget extends TextWidget {\n    protected inputType = 'password';\n}\n\nexport class UrlWidget extends TextWidget {\n    protected inputType = 'url';\n}\n\nexport class EmailWidget extends TextWidget {\n    protected inputType = 'email';\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\nimport { RuleNum, RuleInt } from '../rules';\nimport { NumBaseSchema } from '../../schema';\n\nexport class NumberWidget extends TextWidget {\n    protected inputType = 'number';\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\n\n    protected buildRules() {\n        super.buildRules();\n        let res = this.context.form.res;\n        let {min, max} = this.itemSchema;\n        this.rules.push(\n            this.itemSchema.type === 'integer'?\n                new RuleNum(res, min, max) :\n                new RuleInt(res, min, max)\n        );\n        /*\n        if (this.itemSchema.type === 'integer') {\n            this.rules.push(new RuleInt);\n        }\n        let {min, max} = this.itemSchema;\n        if (min !== undefined) this.rules.push(new RuleMin(min));\n        if (max !== undefined) this.rules.push(new RuleMax(max));\n        */\n    }\n\n    protected parse(value:any):any {\n        if (value === undefined || value === null) return;\n        return Number(value);\n    }\n}\n","import * as React from 'react';\nimport { NumberWidget } from './numberWidget';\n\nexport class UpdownWidget extends NumberWidget {\n    protected inputType = 'number';\n\n    protected isValidKey(key:number):boolean {\n        return key===46 || key===8 || key===37 || key===39\n            || (key>=48 && key<=57)\n            || (key>=96 && key<=105)\n            || key===109 || key===189;\n    }\n    \n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\n        let key = evt.keyCode;\n        window.event.returnValue = this.isValidKey(key);\n    }\n}\n","//import * as React from 'react';\nimport { TextWidget } from './textWidget';\n\nexport class DateWidget extends TextWidget {\n    protected inputType = 'date';\n}\n\nexport class DateTimeWidget extends TextWidget {\n    protected inputType = 'datetime';\n}\n\nexport class TimeWidget extends TextWidget {\n    protected inputType = 'time';\n}\n\nexport class MonthWidget extends TextWidget {\n    protected inputType = 'month';\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiCheckItem } from '../../schema';\n\nexport class CheckBoxWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\n    protected trueValue: any;\n    protected falseValue: any;\n\n    init() {\n        super.init();\n        if (this.ui !== undefined) {\n            let {trueValue, falseValue} = this.ui;\n            if (trueValue === undefined) this.trueValue = true;\n            else this.trueValue = trueValue;\n            if (falseValue === undefined) this.falseValue = false;\n            else this.falseValue = falseValue;\n        }\n        else {\n            this.trueValue = true;\n            this.falseValue = false;\n        }\n    }\n    protected setElementValue(value:any) {\n        this.input.checked = value === this.trueValue;\n    }\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\n        this.setDataValue(v);\n    }\n\n    protected onClick = () => {\n        this.context.clearErrors();\n    }\n\n    render() {\n        let cn = classNames(this.className, 'form-check-inline p-0');\n        let input = <input\n            ref={(input)=>this.input = input}\n            className={'align-self-center'}\n            type=\"checkbox\"\n            defaultChecked={this.defaultValue} \n            onChange={this.onInputChange}\n            onClick={this.onClick} />;\n        if (this.context.inNode === true) {\n            return <label className={cn}>\n                {input} {(this.ui&&this.ui.label) || this.name}\n            </label>\n        }\n        else {\n            return <div className={cn}>\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\n            </div>;\n        }\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { observable } from 'mobx';\nimport { Widget } from './widget';\nimport { UiSelect } from '../../schema';\n\nexport class SelectWidget extends Widget {\n    protected select: HTMLSelectElement;\n    protected get ui(): UiSelect {return this._ui as UiSelect};\n    @observable protected readOnly: boolean;\n\n    protected setElementValue(value:any) {this.select.value = value}\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\n        this.setDataValue(evt.target.value);\n    }\n\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\n\n    render() {\n        if (this.readOnly === true) {\n            let option = this.ui.list.find(v => v.value === this.value);\n            let title = (option === undefined)? '(???)' : option.title;\n            return <span className=\"form-control w-min-6c\">{title}</span>;\n        }\n        return <select\n            ref={(select)=>this.select = select}\n            className={classNames(this.className, 'form-control')}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}>\n            {this.ui.list.map((v,index) => {\n                let {title, value} = v;\n                let cn:string;\n                //if (value === undefined || value === null) cn = 'text-light small';\n                //else cn = 'text-danger';\n                return <option className={cn} key={index} value={value}>{title || value}</option>\n            })}\n        </select>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\n//import { TextWidget } from './textWidget';\nimport { Widget } from './widget';\nimport { UiRadio } from '../../schema';\nimport { RowContext } from '../context';\n\n\nconst radioStyle:React.CSSProperties = {height: 'auto'};\n\nexport class RadioWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiRadio {return this._ui as UiRadio};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n    }\n\n    /*\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n        this.changeValue(evt.target.value, true);\n    }\n    */\n\n    render() {\n        let {defaultValue, list} = this.ui;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n        return <span className={cn} style={radioStyle}>\n                {list.map((v,index) => {\n                    let {value, title} = v;\n                    let name = this.name;\n                    if (rowKey !== undefined) name += '-' + rowKey;\n                    return <label key={index} className=\"form-radio-inline\">\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\n                            onChange={this.onInputChange} />\n                        {title || value}\n                    </label>;\n                    //</span>\n                })}\n            </span>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { UiRange } from '../../schema';\nimport { Widget } from './widget';\n\nexport class RangeWidget extends Widget {\n    protected inputType = 'range';\n    protected input: HTMLInputElement;\n    protected get ui(): UiRange {return this._ui as UiRange};\n\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\n\n    render() {\n        let {min, max, step} = this.ui;\n        return <><input ref={input=>this.input = input}\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\n            type={this.inputType}\n            defaultValue={this.defaultValue} \n            onChange={this.onInputChange}\n            max={max}\n            min={min}\n            step={step}\n            />\n        </>;\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiIdItem, TempletType } from '../../schema';\nimport { observable } from 'mobx';\n\nexport class IdWidget extends Widget {\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\n    @observable protected value:number;\n    setReadOnly(value:boolean) {this.readOnly = value}\n    setDisabled(value:boolean) {this.disabled = value}    \n\n    protected onClick = async () => {\n        let pickId = this.ui && this.ui.pickId;\n        if (pickId === undefined) {\n            alert('no pickId defined!');\n            return;\n        }\n        let id = await pickId(this.context, this.name, this.value);        \n        this.setDataValue(id);\n        this.clearError();\n        this.clearContextError();\n        this.checkRules();\n    }\n\n    render() {\n        let placeholder:string|JSX.Element, Templet: TempletType;\n        if (this.ui !== undefined) {\n            placeholder = this.ui.placeholder;\n            Templet = this.ui.Templet;\n        }\n        let cn:any = {\n            'form-control': true,\n            'required-item': this.itemSchema.required === true,\n            'cursor-pointer': true,\n            'is-invalid': this.hasError,\n        };\n        let content;\n        if (this.value === undefined || this.value === null) {\n            content = placeholder || <small className=\"text-muted\">[无]</small>;\n            cn['text-muted'] = true;\n        }\n        else if (Templet === undefined) {\n            let c: any;\n            if (this.value === null) {\n                c = 'null';\n            }\n            else {\n                switch (typeof this.value) {\n                    case 'undefined': c = <small className=\"text-muted\">[无]</small>; break;\n                    case 'object': c = (this.value as any).id; break;\n                    default: c = this.value; break;\n                }\n            }\n            content = <>{c}</>;\n        }\n        else if (typeof Templet === 'function') {\n            content = Templet(this.value);\n        }\n        else {\n            content = Templet;\n        }\n        return <>\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\n            {this.renderErrors()}\n        </>;\n    }\n}\n","import * as React from 'react';\nimport { DataType } from '../../schema';\nimport { UiType } from '../../schema';\n\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\n};\n","import * as React from 'react';\nimport { UiButton, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { Widget } from './widget';\nimport { observer } from 'mobx-react';\n\nexport class ButtonWidget extends Widget {\n    protected get ui(): UiButton {return this._ui as UiButton};\n\n    protected onClick = async () => {\n        this.clearError();\n        this.clearContextError();\n        let {name, type} = this.itemSchema;\n        if (type === 'submit') {\n            await this.context.submit(name);\n        }\n        /*\n        let {onButtonClick} = this.context.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${name} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(name, this.context);\n        if (ret === undefined) return;\n        this.context.setError(name, ret);\n        */\n    }\n\n    private observerRender = observer(() => {\n        let {name, type} = this.itemSchema;\n        let Templet:TempletType, cn:string, caption:string;\n        if (this.ui !== undefined) {\n            let {widget:widgetType} = this.ui;\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\n            Templet = this.ui.Templet;\n            cn = this.ui.className;\n            caption = this.ui.label;\n        }\n        let {form, hasError} = this.context;\n        let context = this.context;\n        let disabled = type==='submit' && hasError;\n        let content:any;\n        if (this.children !== undefined) content = this.children;\n        else if (typeof Templet === 'function') content = Templet();\n        else if (Templet !== undefined) content = Templet;\n        else content = caption; \n        let button = <button \n            className={cn} \n            type=\"button\"\n            disabled={disabled}\n            onClick={this.onClick}>\n            {content || name}\n        </button>;\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\n        return <div className={form.ButtonClass}>\n            <div>{this.renderErrors()}</div>\n            {button}\n        </div>;\n    });\n    \n    protected get label():string {return null}\n\n    render() {\n        return <this.observerRender />\n    }\n}\n","import * as React from 'react';\nimport { Form } from './form';\nimport { UiSchema, UiArr, UiItem } from '../schema';\nimport { ArrSchema, ItemSchema } from '../schema';\nimport { Widget } from './widgets/widget';\n//import { ArrRow } from './arrRow';\nimport { observable, computed } from 'mobx';\nimport { ContextRule } from './rules';\nimport { observer } from 'mobx-react';\n\nexport abstract class Context {\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\n    readonly form: Form;\n    readonly uiSchema: UiSchema;\n    readonly initData: any;\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\n    readonly widgets: {[name:string]: Widget} = {};\n    readonly rules: ContextRule[];\n    readonly isRow: boolean;\n    @observable errors: string[] = [];\n    @observable errorWidgets:Widget[] = [];\n\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\n        this.form = form;\n        this.uiSchema = uiSchema;\n        this.initData = data;\n        this.inNode = inNode;\n        this.isRow = isRow;\n        if (uiSchema !== undefined) {\n            let {rules} = uiSchema;\n            if (rules !== undefined) {\n                this.rules = [];\n                if (Array.isArray(rules) === false)\n                    this.rules.push(rules as ContextRule);\n                else\n                    this.rules.push(...rules as ContextRule[]);\n            }\n        }\n    }\n\n    getArrRowContexts(arrName: string) {\n        if (this.subContexts === undefined) this.subContexts = {};\n        let arrRowContexts = this.subContexts[arrName];\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\n        return arrRowContexts;\n    }\n\n    abstract get data():any;\n    abstract getItemSchema(itemName:string):ItemSchema;\n    abstract getUiItem(itemName:string):UiItem;\n    get arrName():string {return undefined}\n    getValue(itemName:string):any {return this.initData[itemName]}\n    setValue(itemName:string, value:any) {\n        this.initData[itemName] = value;\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setValue(value);\n    }\n    getDisabled(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) return widget.getDisabled();\n        return undefined;\n    }\n    setDisabled(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setDisabled(value);\n    }\n    getReadOnly(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getReadOnly();\n        return undefined;\n    }\n    setReadOnly(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setReadOnly(value);\n    }\n    getVisible(itemName:string):boolean {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.getVisible();\n        return undefined;\n    }\n    setVisible(itemName:string, value:boolean) {\n        let widget = this.widgets[itemName];\n        if (widget !== undefined) widget.setVisible(value);\n    }\n\n    async submit(buttonName: string) {\n        this.checkRules()\n        if (this.hasError === true) {\n            let err = '';\n            for (let ew of this.errorWidgets) {\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\n            }\n            console.error(err);\n            return;\n        }\n        let {onButtonClick} = this.form.props;\n        if (onButtonClick === undefined) {\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this);\n        if (ret === undefined) return;\n        this.setError(buttonName, ret);\n\n    }\n\n    checkFieldRules() {\n        for (let i in this.widgets) {\n            this.widgets[i].checkRules();\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                arrRowContexts[j].checkFieldRules();\n            }\n        }\n    }\n\n    checkContextRules() {\n        this.clearErrors();\n        if (this.rules === undefined) return;\n        for (let rule of this.rules) {\n            let ret = rule(this);\n            if (ret === undefined) continue;\n            if (Array.isArray(ret) === true) {\n                this.errors.push(...ret as string[]);\n            }\n            else if (typeof ret === 'string') {\n                this.errors.push(ret as string);\n            }\n            else {\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\n            }\n        }\n        if (this.subContexts === undefined) return;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                let rowContext = arrRowContexts[j];\n                rowContext.clearErrors();\n                rowContext.checkContextRules();\n            }\n        }\n    }\n\n    setError(itemName:string, error:string) {\n        let widget = this.widgets[itemName];\n        if (widget === undefined) return;\n        widget.setContextError(error);\n        this.addErrorWidget(widget);\n    }\n\n    clearContextErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearContextError();\n        }\n    }\n\n    clearWidgetsErrors() {\n        for (let i in this.widgets) {\n            let widget = this.widgets[i];\n            if (widget === undefined) continue;\n            widget.clearError();\n        }\n    }\n\n    checkRules() {\n        this.clearErrors();\n        this.clearWidgetsErrors();\n        this.checkFieldRules();\n        if (this.hasError === true) return;\n        this.checkContextRules();\n    }\n\n    addErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos < 0) this.errorWidgets.push(widget);\n    }\n    removeErrorWidget(widget:Widget) {\n        let pos = this.errorWidgets.findIndex(v => v === widget);\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\n    }\n\n    protected checkHasError():boolean {\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\n        if (ret === true) return true;\n        if (this.subContexts === undefined) return false;\n        for (let i in this.subContexts) {\n            let arrRowContexts = this.subContexts[i];\n            for (let j in arrRowContexts) {\n                if (arrRowContexts[j].hasError === true) return true;\n            }\n        }\n        return false;\n    }\n\n    @computed get hasError():boolean {\n        return this.checkHasError();\n    };\n\n    clearErrors() {\n        this.errors.splice(0);\n        this.errorWidgets.splice(0);\n        this.clearContextErrors();\n    }\n\n    renderErrors = observer((): JSX.Element => {\n        let {errors} = this;\n        if (errors.length === 0) return null;\n        return <>\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ml-3\">\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\n            </span>)}\n        </>\n    });\n}\n\nlet rowKeySeed:number = 1;\nexport class RowContext extends Context {\n    readonly parentContext: Context;\n    readonly arrSchema: ArrSchema;\n    readonly rowKey: number;\n\treadonly data: any;\n    //readonly uiSchema: UiArr;\n\t\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\n        let uiArr:UiArr;\n        let {uiSchema} = parentContext;\n        if (uiSchema !== undefined) {\n            let {items} = uiSchema;\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\n        }\n        super(parentContext.form, uiArr, data, inNode, true);\n        this.parentContext = parentContext;\n        this.arrSchema = arrSchema;\n        this.rowKey = rowKeySeed++;\n        this.data = data;\n    }\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        if (this.uiSchema === undefined) return undefined;\n        let {items} = this.uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName]\n    }\n    get arrName():string {return this.arrSchema.name}\n    clearErrors() {\n        super.clearErrors();\n        this.parentContext.clearErrors();\n    }\n\n    get parentData():any {return this.parentContext.data;}\n}\n\nexport class FormContext extends Context {\n    constructor(form:Form, inNode:boolean) {\n        super(form, form.uiSchema, form.data, inNode, false);\n    }\n    get data():any {return this.form.data}\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\n    getUiItem(itemName:string):UiItem {\n        let {uiSchema} = this.form;\n        if (uiSchema === undefined) return undefined;\n        let {items} = uiSchema;\n        if (items === undefined) return undefined;\n        return items[itemName];\n    }\n}\n\nexport const ContextContainer = React.createContext<Context>({} as any);\n","import * as React from 'react';\nimport {observer} from 'mobx-react';\nimport classNames from 'classnames';\n//import { ArrRow } from '../arrRow';\nimport { Context, RowContext, ContextContainer } from '../context';\nimport { ArrSchema } from '../../schema';\nimport { UiArr, TempletType } from '../../schema';\nimport { Unknown } from './unknown';\nimport { factory } from './factory';\n\nexport const ArrComponent = observer((\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \n{\n    let {name, arr} = arrSchema;\n    let data = parentContext.initData[name] as any[];\n    let {form} = parentContext;\n    let arrRowContexts = parentContext.getArrRowContexts(name);\n    let ui = parentContext.getUiItem(name) as UiArr;\n    let arrLabel = name;\n    let Templet:TempletType;\n    let selectable:boolean, deletable:boolean, restorable:boolean;\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\n    if (uiSchema !== undefined) {\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\n        if (selectable !== true) selectable = formSelectable;\n        if (deletable !== true) deletable = formDeletable;\n        if (restorable !== true) restorable = formRestorable;\n    }\n    if (ui !== undefined) {\n        let {widget:widgetType, label, \n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\n        } = ui;\n        if (arrSelectable !== undefined) selectable = arrSelectable;\n        if (arrDeletable !== undefined) deletable = arrDeletable;\n        if (arrRestorable !== undefined) restorable = arrRestorable;\n        if (ac !== undefined) ArrContainer = ac;\n        if (rc !== undefined) RowContainer = rc;\n        if (rs !== undefined) RowSeperator = rs;\n        Templet = ui.Templet;\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\n        arrLabel = label || arrLabel;\n    }\n    let first = true;\n    return ArrContainer(arrLabel, <>\n        {data.map((row:any, index) => {\n            let rowContext: RowContext;\n            let rowContent: JSX.Element;\n            let sep = undefined;\n            if (first === false) sep = RowSeperator;\n            else first = false;\n            if (children !== undefined) {\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\n                rowContent = <>{children}</>;\n            }\n            else {\n                let typeofTemplet = typeof Templet;\n                if (typeofTemplet === 'function') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\n                }\n                else if (typeofTemplet === 'object') {\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\n                    rowContent = Templet as JSX.Element;\n                }\n                else {\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\n                    rowContent = <>{\n                        arr.map((v, index) => {\n                            return <React.Fragment key={v.name}>\n                                {factory(rowContext, v, undefined)}\n                            </React.Fragment>\n                        })}\n                    </>;\n                }\n            }\n            let {rowKey} = rowContext;\n            arrRowContexts[rowKey] = rowContext;\n\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\n            if (selectable === true) {\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\n                    let {checked} = (evt.target as HTMLInputElement);\n                    row.$isSelected = checked;\n                    let {$source} = row;\n                    if ($source !== undefined) $source.$isSelected = checked;\n                    rowContext.clearErrors();\n                }\n                selectCheck = <div className=\"form-row-checkbox\">\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\n                </div>;\n            }\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\n            if (deletable === true) {\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\n                let onDelClick = () => {\n                    if (restorable === true) {\n                        row.$isDeleted = !isDeleted;\n                        let {$source} = row;\n                        if ($source !== undefined) $source.$isDeleted = !isDeleted;\n                    }\n                    else {\n                        let p = data.indexOf(row);\n                        if (p>=0) data.splice(p, 1);\n                    }\n                    rowContext.clearErrors();\n                }\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\n                    <i className={classNames('fa', icon, 'fa-fw')} />\n                </div>;\n            }\n            let editContainer = selectable===true || deletable===true?\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\n                    {selectCheck}\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\n                    {deleteIcon}\n                </div></fieldset>\n                :\n                (content:any) => content;\n\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\n                {sep}\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\n            </ContextContainer.Provider>;\n        })}\n    </>);\n});\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiImageItem } from '../../schema';\nimport { Image } from '../../image';\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\n\nexport class ImageWidget extends Widget {\n    protected input: HTMLInputElement;\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\n    @observable private imageSrc: string;\n\n    init() {\n        super.init();\n        this.imageSrc = this.value;\n    }\n\n    protected onClick = async () => {\n        let edit = new ImageItemEdit(this.itemSchema, this.ui, this.ui.label, this.value);\n        let ret = await edit.start();\n        if (ret !== null) {\n            this.setValue(ret);\n            this.imageSrc = ret;\n        }\n        await edit.end();\n    }\n\n    render() {\n        return <this.observerRender />;\n    }\n\n    private observerRender = observer(() => {\n        let cn = [\n            'bg-white p-1 d-flex justify-content-center',\n        ];\n        let onClick: any;\n        if (!this.readOnly && !this.disabled) {\n            cn.push('cursor-pointer');\n            onClick = this.onClick;\n        }\n        return <div className={classNames(cn)} onClick={onClick}>\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\n        </div>;\n    });\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { Widget } from './widget';\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\nimport { RowContext } from '../context';\n\nabstract class TagWidget extends Widget {\n    protected inputs: {[index:number]: HTMLInputElement} = {};\n    protected get ui(): UiTag {return this._ui as UiTag};\n\n    protected setElementValue(value:any) {\n        for (let i in this.inputs) {\n            let input = this.inputs[i];\n            input.checked = value === input.value;\n        }\n    }\n    setReadOnly(value:boolean) {\n        this.readOnly = value;\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\n    }\n    setDisabled(value:boolean) {\n        this.disabled = value;\n        for (let i in this.inputs) this.inputs[i].disabled = value\n\t}\n\t\n\tabstract render():JSX.Element;\n}\n\nexport class TagSingleWidget extends TagWidget {\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let {isRow} = this.context;\n        let rowKey:number;\n        if (isRow === true) {\n            rowKey = (this.context as RowContext).rowKey;\n        }\n        let cn = classNames(this.className, 'py-0');\n\t\tlet name = this.name;\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputName: name,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\n    }\n}\n\nexport class TagMultiWidget extends TagWidget {\n\tprivate defaultArr:number[];\n\tinit() {\n\t\tsuper.init();\n\t\tlet def = this.defaultValue;\n\t\tswitch (typeof def) {\n\t\t\tdefault:\n\t\t\t\tthis.defaultArr = [];\n\t\t\t\tbreak;\n\t\t\tcase 'string':\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\n\t\t\t\tbreak;\n\t\t}\n\t}\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.changeValue(values.join('|'), true);\n\t}\n\trender() {\n\t\tlet {valuesView, wrapClassName} = this.ui;\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\n        let cn = classNames(this.className, 'py-0');\n\t\tlet options:IValuesViewRenderOptions = {\n\t\t\tclassName: cn,\n\t\t\tinputs: this.inputs,\n\t\t\twrapClassName,\n\t\t\tonInputChange: this.onInputChange\n\t\t}\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\n    }\n}\n","import * as React from 'react';\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\nimport { TypeWidget, UiCustom } from '../../schema';\nimport { TextWidget } from './textWidget';\nimport { TextAreaWidget } from './textareaWidget';\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\nimport { UpdownWidget } from './updownWidget';\nimport { NumberWidget } from './numberWidget';\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\nimport { CheckBoxWidget } from './checkBoxWidget';\nimport { FieldProps } from '../field';\nimport { Context } from '../context';\nimport { SelectWidget } from './selectWidget';\nimport { RadioWidget } from './radioWidget';\nimport { RangeWidget } from './rangeWidget';\nimport { IdWidget } from './idWidget';\nimport { ButtonWidget } from './buttonWidget';\nimport { ArrComponent } from './arrComponent';\nimport { ImageWidget } from './imageWidget';\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\n\nconst widgetsFactory: {[type: string]: {widget?: TypeWidget, dataTypes?: DataType[]}} = {\n    id: {\n        dataTypes: ['id'],\n        widget: IdWidget,\n    },\n    text: {\n        dataTypes: ['integer', 'number', 'string'],\n        widget: TextWidget\n    },\n    textarea: {\n        dataTypes: ['string'],\n        widget: TextAreaWidget\n    },\n    password: {\n        dataTypes: ['string'],\n        widget: PasswordWidget\n    },\n    date: {\n        dataTypes: ['date'],\n        widget: DateWidget\n    },\n    datetime: {\n        dataTypes: ['date'],\n        widget: DateTimeWidget\n    },\n    time: {\n        dataTypes: ['date'],\n        widget: TimeWidget\n    },\n    month: {\n        dataTypes: ['date'],\n        widget: MonthWidget\n    },\n    select: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: SelectWidget\n    },\n    url: {\n        dataTypes: ['string'],\n        widget: UrlWidget\n    },\n    email: {\n        dataTypes: ['string'],\n        widget: EmailWidget\n    },\n    number: {\n        dataTypes: ['integer', 'number'],\n        widget: NumberWidget\n    },\n    updown: {\n        dataTypes: ['integer', 'number'],\n        widget: UpdownWidget\n    },\n    color: {\n\n    },\n    checkbox: {\n        dataTypes: ['boolean', 'integer', 'number'],\n        widget: CheckBoxWidget\n    },\n    image: {\n        dataTypes: ['string'],\n        widget: ImageWidget,\n    },\n    checkboxes: {\n\n    },\n    radio: {\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\n        widget: RadioWidget\n\t},\n\ttagSingle: {\n\t\tdataTypes: ['integer'],\n\t\twidget: TagSingleWidget\n\t},\n\ttagMulti: {\n\t\tdataTypes: ['string'],\n\t\twidget: TagMultiWidget\n\t},\n    range: {\n        dataTypes: ['integer'],\n        widget: RangeWidget,\n    },\n    button: {\n        dataTypes: ['button', 'submit'],\n        widget: ButtonWidget,\n    }\n}\n\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\n    if (context === undefined) {\n        debugger;\n        return null;\n    }\n    if (itemSchema === undefined) return undefined;\n    let {name, type} = itemSchema;\n    switch (type) {\n    case 'arr':\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\n    default:\n        break;\n    }\n\n    let typeWidget: TypeWidget;\n    let ui = context.getUiItem(name);\n    function getTypeWidget(t:DataType): TypeWidget {\n        switch(t) {\n        default: return TextWidget; \n        case 'id': return IdWidget;\n        case 'integer': return UpdownWidget;\n        case 'number': return NumberWidget; \n        case 'string': return TextWidget; \n        case 'date': return DateWidget; \n        case 'boolean': return CheckBoxWidget; \n        case 'button':\n        case 'submit': return ButtonWidget;\n        }\n    }\n    if (ui === undefined) { \n        typeWidget = getTypeWidget(type);\n    }\n    else {\n        let {widget:widgetType} = ui;\n        switch (widgetType) {\n        default:\n            if (widgetType !== undefined) {\n                let widgetFactory = widgetsFactory[widgetType];\n                typeWidget = widgetFactory.widget;\n            }\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\n            break;\n        case 'custom':\n            typeWidget = (ui as UiCustom).WidgetClass;\n            break;\n        case 'group':\n            return <span>impletment group</span>;\n        }\n        //label = uiLabel || name;\n    }\n    \n    let {widgets} = context;\n    let widget = new typeWidget(context, itemSchema, fieldProps, children);\n    widget.init();\n    widgets[name] = widget;\n\n    return <widget.container />;\n    /*\n    if (isRow === false) {\n        let WidgetElement = observer(() => widget.container());\n        return <WidgetElement />;\n    }\n    else {\n        let widgetElement = widget.container();\n        return widgetElement;\n    }\n    */\n}\n\n","import * as React from 'react';\nimport {observable, IReactionDisposer, autorun} from 'mobx';\nimport classNames from 'classnames';\nimport { Schema, ItemSchema, ArrSchema } from '../schema';\nimport { UiSchema, TempletType } from '../schema';\nimport { factory } from './widgets';\nimport 'font-awesome/css/font-awesome.min.css';\nimport { ContextContainer, FormContext, Context } from './context';\nimport { FormRes, formRes } from '../../res';\nimport { resLang } from '../../res/res';\n\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\n\nexport interface FormProps {\n    className?: string;\n    schema: Schema;\n    uiSchema?: UiSchema;\n    formData?: any;\n    onButtonClick?: FormButtonClick;\n    onEnter?: InputEnter;\n    fieldLabelSize?: number;            // col-sm-2 for label\n    requiredFlag?: boolean;             // default=true\n    beforeShow?: (formContext:FormContext) => void;\n    res?: FormRes;\n\n    Container?: (content:JSX.Element) => JSX.Element;\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\n    FieldClass?: string;\n    ButtonClass?: string;\n}\n\nexport class Form extends React.Component<FormProps> {\n    readonly schema: Schema;\n    readonly itemSchemas: {[name:string]: ItemSchema};\n    readonly uiSchema: UiSchema;\n    readonly res?: FormRes;\n    protected formContext: FormContext;\n    private disposer: IReactionDisposer;\n    readonly data:any;\n\n    readonly Container: (content:JSX.Element) => JSX.Element;\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\n    readonly FieldClass: string;\n    readonly ButtonClass: string;\n    \n    constructor(props:FormProps) {\n        super(props);\n        let {schema, uiSchema, \n            Container, FieldContainer, FieldClass, \n            ButtonClass, res,\n        } = props;\n        this.Container = Container || this.DefaultContainer;\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\n        this.res = res || this.DefaultRes;\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\n\n        this.schema = schema;\n        this.itemSchemas = {};\n        for (let itemSchema of this.schema) {\n            this.itemSchemas[itemSchema.name] = itemSchema;\n        }\n        this.uiSchema = uiSchema;\n\n        this.disposer = autorun(this.watch);\n        this.data = {};\n    }\n\n    private renderContent():any {\n        this.initData(this.props.formData);\n        let {children} = this.props;\n        if (children !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return <>{children}</>;\n        }\n\n        let Templet: TempletType;\n        if (this.uiSchema !== undefined) {\n            Templet = this.uiSchema.Templet;\n        }\n        if (Templet !== undefined) {\n            this.formContext = new FormContext(this, true);\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\n        }\n\n        this.formContext = new FormContext(this, false);\n        return <>{this.schema.map((v, index) => {\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\n        })}</>;\n    }\n\n    private initData(formData: any) {\n        if (formData === undefined) formData = {};\n        if (this.uiSchema !== undefined) {\n            let {items} = this.uiSchema;\n            if (items !== undefined) {\n                for (let i in items) {\n                    let ui = items[i];\n                    let dv = ui.defaultValue;\n                    if (dv !== undefined) {\n                        if (formData[i] === undefined) {\n                            formData[i] = dv;\n                        }\n                    }\n                }\n            }\n        }\n        for (let itemSchema of this.schema) {\n            this.initDataItem(itemSchema, this.data, formData);\n        }\n    }\n\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\n        let {name, type} = itemSchema;\n        if (type === 'button') return;\n        if (type !== 'arr') {\n            data[name] = formData[name];\n            return;\n        }\n\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\n        let {arr:arrItems} = arrItem;\n        if (arrItems === undefined) return;\n        let arrDict:any = arrItem.itemSchemas = {};\n        for (let item of arrItems) {\n            arrDict[item.name] = item;\n        }\n        let val:any[] = formData[name];\n        if (val === undefined) val = [];\n        else if (Array.isArray(val) === false) val = [val];\n        let arr:any[] = [];\n        for (let row of val) {\n            let {$isSelected, $isDeleted} = row;\n            let r = {\n                $source: row,\n                $isSelected: $isSelected,\n                $isDeleted: $isDeleted,\n            };\n            for (let item of arrItems) {\n                this.initDataItem(item, r, row);\n            }\n            arr.push(r);\n        }\n        // 如果没有observable，行删除标志点击不管用\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\n        data[name] = observable(arr);\n        //data[name] = arr;\n        return;\n    }\n\n    private watch = () => {\n        let {formData} = this.props;\n        if (formData === undefined) return;\n        //this.initData(formData);\n        this.calcSelectOrDelete();\n    }\n    private calcSelectOrDelete() {\n        for (let itemSchema of this.schema) {\n            this.arrItemOperated(itemSchema);\n        }\n    }\n\n    private arrItemOperated(itemSchema: ItemSchema) {\n        let {name, type} = itemSchema;\n        if (type !== 'arr') return;\n        if (this.data === undefined) return;\n        let formArrVal = this.data[name];\n        if (formArrVal === undefined) return;\n        let {arr: arrItems} = itemSchema as ArrSchema;\n        for (let row of formArrVal) {\n            let {$source} = row;\n            if ($source === undefined) continue;\n            let {$isSelected, $isDeleted} = $source;\n            row.$isSelected = $isSelected;\n            row.$isDeleted = $isDeleted;\n            //console.log($isSelected, $isDeleted);\n            for (let item of arrItems) {\n                this.arrItemOperated(item);\n            }\n        }\n    }\n\n    componentDidMount() {\n        let {beforeShow} = this.props;\n        if (beforeShow !== undefined) beforeShow(this.formContext);\n    }\n\n    componentWillUnmount() {\n        if (this.disposer !== undefined) this.disposer();\n    }\n\n    render() {\n        let content = this.renderContent();\n        return <ContextContainer.Provider value={this.formContext}>\n            <this.formContext.renderErrors />\n            {this.Container(content)}\n        </ContextContainer.Provider>;\n    }\n\n    async buttonClick(buttonName:string) {\n        this.formContext.checkRules()\n        if (this.formContext.hasError === true) return;\n\n        let {onButtonClick} = this.formContext.form.props;\n        if (onButtonClick === undefined) {\n            alert(`you should define form onButtonClick`);\n            return;\n        }\n        let ret = await onButtonClick(buttonName, this.formContext);\n        if (ret === undefined) return;\n        this.formContext.setError(buttonName, ret);\n    }\n\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\n            {content}\n        </form>;\n    }\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\n        let {fieldLabelSize} = this.props;\n\n        if (fieldLabelSize > 0) {\n            let labelView:any;\n            if (label === null) {\n                fieldLabelSize = 0;\n            }\n            else {\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label')}>{label}</label>\n            }\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\n            return <div className=\"form-group row\">\n                {labelView}\n                <div className={fieldCol}>{content}</div>\n            </div>;\n        }\n        return <div className=\"form-group\">\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\n            {content}\n        </div>;\n    }\n    protected DefaultFieldClass:string = undefined;\n    protected DefaultButtonClass = 'text-center py-2';\n    protected DefaultRes:FormRes = resLang<FormRes>(formRes);\n\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\n        return <div>\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\n            {content}\n        </div>;\n    }\n    RowContainer = (content:JSX.Element): JSX.Element => {\n        let cn = classNames({\n            'py-3': true\n        });\n        return <div className={cn}>{content}</div>\n    }\n    RowSeperator = <div className=\"border border-gray border-top\" />;\n}\n","import * as React from 'react';\nimport { factory } from './widgets';\nimport { ContextContainer, Context } from './context';\n\nexport interface FieldProps {\n    name: string;\n}\n\nexport class FormField extends React.Component<FieldProps> {\n    static contextType = ContextContainer;\n    render() {\n        let {name, children } = this.props;\n        let context:Context = this.context;\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\n        let itemSchema = context.getItemSchema(name);\n        let content = factory(context, itemSchema, children, this.props);\n        if (content === undefined) {\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\n        }\n        return content;\n    }\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class StringItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\t\tif (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <input type=\"text\" \n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n                    defaultValue={this.value} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiRadio } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class RadioItemEdit extends ItemEdit {\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value: any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {name} = this.itemSchema;\n        let {list} = this.uiItem;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n            }}>保存</button>;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input name={name} type=\"radio\" value={value} \n                        onClick={()=>this.onChange(value)} \n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\n                </label></div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label} right={right}>\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\n\t\t\t</div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiSelect } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class SelectItemEdit extends ItemEdit {\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\nimport { UiIdItem } from '../schema';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class IdItemEdit extends ItemEdit {\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>(async (resolve, reject) => {\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            //nav.push(element,reject);\n\n            let {pickId} = this.uiItem;\n            if (pickId === undefined) {\n                alert('IdItemEdit.pickId = undefined');\n                return;\n            }\n            let boxId = await pickId(undefined, undefined, this.value);\n            //if (typeof id === 'object') {\n            //    id = (id as any).id;\n            //}\n            this.onChange(boxId.id);\n            resolve(boxId);\n            //this.newValue = id;\n        });\n    }\n\n    protected async internalEnd():Promise<void> {}\n\n    private onChange = (value:any) => {\n        this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        /*\n        let {resolve, reject} = props;\n        let {list} = this.uiItem;\n        let content = list?\n            list.map((v, index:number) => {\n                let {title, value} = v;\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\n                    {title || value}\n                </div>;\n            })\n            :\n            <>no list defined</>;\n        return <Page header={'更改' + this.label}>\n            <div className=\"my-3\">\n                {content}\n            </div>\n        </Page>;\n        */\n        return <Page header={'更改' + this.label}>\n            ddd\n        </Page>\n    })\n}\n","import * as React from 'react';\nimport { UiTag } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nabstract class TagItemEdit extends ItemEdit {\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\n\tprotected inputType: 'checkbox' | 'radio';\n    get uiItem(): UiTag {return this._uiItem as UiTag};\n\n\tinit() {\n        if (this.value === undefined) {\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\n        }\n\t}\n\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\n            nav.push(element,reject);\n        });\n\t}\n\t\n\trenderContent() {\n\t\tlet valuesView = this.uiItem.valuesView;\n\t\tif (valuesView === undefined) return super.renderContent();\n\t\treturn valuesView.render(this.value);\n\t}\n\n\tprotected abstract renderInputs():JSX.Element;\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n        let {resolve} = props;\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center\"\n            disabled={!this.isChanged}\n            onClick={()=>{\n                this.verifyValue();\n                if (this.error === undefined) resolve(this.newValue);\n\t\t\t}}>保存</button>;\n\t\t/*\n        let content = list?\n            list.map((v, index:number) => {\n                let {name:itemName, id} = v;\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\n                </label></div>;\n            })\n            :\n\t\t\t<>no list defined</>;\n\t\t*/\n        return <Page header={'更改' + this.label} right={right}>\n\t\t\t<div className=\"p-3\">\n\t\t\t\t{this.renderInputs()}\n\t\t\t</div>\n        </Page>;\n    })\n}\n\nexport class TagSingleItemEdit extends TagItemEdit {\n\tprotected inputType:'radio'|'checkbox' = 'radio';\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet {currentTarget} = evt;\n\t\tif (currentTarget.checked === false) return;\n        this.newValue = Number(currentTarget.value);\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\t\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange,\n\t\t};\n\t\treturn valuesView.renderRadios(this.value, options);\n\t}\n}\n\nexport class TagMultiItemEdit extends TagItemEdit {\n\t//private arr:number[];\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\n\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet values:string[] = [];\n\t\tfor (let i in this.inputs) {\n\t\t\tlet input = this.inputs[i];\n\t\t\tif (input.checked === true) values.push(input.value);\n\t\t}\n        this.newValue = values.join('|');\n        //this.newValue = value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n\t}\n\tprotected renderInputs():JSX.Element {\n\t\tlet {valuesView} = this.uiItem;\n\t\tlet options = {\n\t\t\tinputs: this.inputs,\n\t\t\tonInputChange: this.onInputChange\n\t\t};\n\t\treturn valuesView.renderChecks(this.value, options);\n\t}\n}\n","import * as React from 'react';\nimport { UiTextItem } from '../schema';\nimport { nav } from '../nav';\nimport { Page } from '../page/page';\nimport { observer } from 'mobx-react';\nimport { ItemEdit } from './itemEdit';\n\nexport class TextAreaItemEdit extends ItemEdit {\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\n    protected async internalStart():Promise<any> {\n        return new Promise<any>((resolve, reject) => {\n            let element = React.createElement(this.page, {resolve, reject});\n            nav.push(element,reject);\n        });\n    }\n\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.newValue = evt.target.value;\n        let preValue = this.value;\n        this.isChanged = (this.newValue !== preValue);\n    }\n\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\n        this.verifyValue();\n    }\n\n    private onFocus = () => {\n        this.error = undefined;\n    }\n\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\n\t\tlet {resolve} = props;\n\t\tlet onSave = () => {\n\t\t\tthis.verifyValue();\n\t\t\tif (this.error === undefined) {\n\t\t\t\tlet val = this.newValue;\n\t\t\t\tresolve(val);\t\t\t\t\n\t\t\t}\n\t\t}\n        let right = <button\n            className=\"btn btn-sm btn-success align-self-center mr-2\"\n            disabled={!this.isChanged}\n            onClick={onSave}>保存</button>;\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\n\t\t\t// if (evt.keyCode === 13) onSave();\n\t\t}\n        return <Page header={this.label} right={right}>\n            <div className=\"m-3\">\n                <textarea\n\t\t\t\t\tonChange={this.onChange}\n\t\t\t\t\tonKeyDown={onKeyDown}\n                    onBlur={this.onBlur}\n                    onFocus={this.onFocus}\n                    className=\"form-control\" \n\t\t\t\t\tdefaultValue={this.value}\n\t\t\t\t\trows={6} />\n                {\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\n                }\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\n            </div>\n        </Page>;\n    })\n}\n","import * as React from 'react';\n//import _ from 'lodash';\nimport { observer } from 'mobx-react';\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\nimport { ItemEdit } from './itemEdit';\nimport { StringItemEdit } from './stringItemEdit';\nimport { ImageItemEdit } from './imageItemEdit';\nimport { RadioItemEdit } from './radioItemEdit';\nimport { SelectItemEdit } from './selectItemEdit';\nimport { IdItemEdit } from './idItemEdit';\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\nimport { TextAreaItemEdit } from './textAreaItemEdit';\n\nexport interface EditProps {\n    className?: string;\n    schema: Schema;\n    data: any;\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\n    stopEdit?: boolean;\n    uiSchema?: UiSchema;\n    sepClassName?: string;\n    topBorderClassName?: string;\n    bottomBorderClassName?: string;\n    rowContainerClassName?: string;\n}\n\n@observer\nexport class Edit extends React.Component<EditProps> {\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\n    private topBorder:JSX.Element;\n    private bottomBorder:JSX.Element;\n    private rowContainerClassName?: string;\n    private sep:JSX.Element;\n\tprivate uiSchema: {[name:string]: UiItem};\n\n    constructor(props: EditProps) {\n        super(props);\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema, stopEdit} = props;\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\n        if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\n    }\n\n    render() {\n        let {schema} = this.props;\n\t\tlet sep:any;\n        return <div>\n\t\t\t{this.topBorder}\n            {schema.map((itemSchema, index) => {\n\t\t\t\tlet {name} = itemSchema;\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\n\t\t\t\tlet label:string, labelHide:any;\n\t\t\t\tif (uiItem !== undefined) {\n\t\t\t\t\tlabel = uiItem.label || name;\n\t\t\t\t\tlabelHide = uiItem.labelHide;\n\t\t\t\t};\n\t\t\t\tlet value = this.props.data[name];\n\t\t\t\tlet itemEdit = createItemEdit(itemSchema, uiItem, label, value);\n\n\t\t\t\tlet {required} = itemSchema;\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\n\t\t\t\tif (labelHide === true) {\n\t\t\t\t\tdivLabel = undefined;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\n\t\t\t\t\tcn += 'justify-content-end';\n\t\t\t\t}\n\t\t\t\tlet ret = <React.Fragment key={index}>\n\t\t\t\t\t{sep}\n\t\t\t\t\t<div className={'d-flex align-items-center' + this.rowContainerClassName} \n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\n\t\t\t\t\t\t{divLabel}\n\t\t\t\t\t\t<div className={cn}>{\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\n\t\t\t\t\t\t}</div>\n\t\t\t\t\t\t{this.props.stopEdit!==true && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\n\t\t\t\t\t</div>\n\t\t\t\t</React.Fragment>;\n\t\t\t\tsep = this.sep;\n\t\t\t\treturn ret;\n\t\t\t})}\n\t\t\t{this.bottomBorder}\n\t\t</div>;\n    }\n\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\n\t\tif (itemEdit === undefined) {\n\t\t\talert('item has no edit');\n\t\t\treturn;\n\t\t}\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\n        if (stopEdit === true) return;\n        let changeValue:any;\n        if (onItemClick !== undefined) {\n            await onItemClick(itemSchema, uiItem, value);\n            return;\n        }\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\n        if (itemEdit === undefined) {\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\n            return;\n        }\n        try {\n            changeValue = await itemEdit.start();\n            if (changeValue !== value) {\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\n                if (onItemChanged === undefined) {\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\n                    //this.props.data[itemSchema.name] = changeValue;\n                }\n                else {\n                    await onItemChanged(itemSchema, changeValue, value);\n                }\n            }\n            await itemEdit.end();\n        }\n        catch (err) {\n            // 如果直接back，会触发reject，就到这里了\n\t\t\tconsole.log('no value changed');\n\t\t\tconsole.error(err);\n        }\n    }\n}\n\ntype NewItemEdit = new (itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any) => ItemEdit;\n\nfunction createItemEdit(itemSchema: ItemSchema, uiItem:UiItem, label:string, value: any):ItemEdit {\n\tlet ie: ItemEdit;\n    let itemEdit: NewItemEdit;\n    if (uiItem !== undefined) {\n        switch (uiItem.widget) {\n            default: break;\n            case 'id': itemEdit = IdItemEdit; break;\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\n            case 'image': itemEdit = ImageItemEdit; break;\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\n\t\t\tcase 'range': itemEdit = StringItemEdit; break;\n            case 'radio': \n\t\t\t\tie = new RadioItemEdit(itemSchema, uiItem as UiRadio, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagSingle':\n\t\t\t\tie = new TagSingleItemEdit(itemSchema, uiItem as UiTagSingle, label, value);\n\t\t\t\tbreak;\n\t\t\tcase 'tagMulti':\n\t\t\t\tie = new TagMultiItemEdit(itemSchema, uiItem as UiTagMulti, label, value);\n\t\t\t\tbreak;\n\t\t\t}\n\t}\n\tif (ie === undefined) {\n\t\tif (itemEdit === undefined) {\n\t\t\tswitch (itemSchema.type) {\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\n\t\t\t}\n\t\t}\n\t\tif (itemEdit === undefined) return;\n\t\tie = new itemEdit(itemSchema, uiItem, label, value);\n\t}\n\tie.init();\n\treturn ie;\n}\n","import {CenterApiBase} from '../net';\n\nexport class CenterApi extends CenterApiBase {\n    async userAppUnits(app:number):Promise<any[]> {\n        return await this.get('tie/user-app-units', {app:app});\n    }\n    async userFromId(userId:number):Promise<any> {\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\n\t}\n\tasync userFromKey(userName:string):Promise<any> {\n\t\treturn await this.get('tie/user-from-key', {key:userName});\n\t}\n}\n\nexport const centerApi = new CenterApi('tv/', undefined);\n","import * as React from 'react';\nimport { Page, FA, nav, LMR, List } from \"../components\";\nimport { VPage } from '../vm';\nimport { appInFrame } from '../net';\nimport { CAppBase } from \"./CAppBase\";\nimport { UQsMan } from '../uq';\n\n/*\nexport class VAppMain extends VPage<CMainBase> {\n    async open(param?:any) {\n        this.openPage(this.appPage);\n    }\n\n    render(param?:any) {\n        return this.appContent();\n    }\n\n    protected appPage = () => {\n        let {caption} = this.controller;\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\n            {this.appContent()}\n        </Page>;\n    }\n\n    protected appContent = () => {\n        let {cUqArr} = this.controller;\n        let content:any;\n        if (cUqArr.length === 0) {\n            content = <div className=\"text-danger\">\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\n            </div>;\n        }\n        else {\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\n        }\n        return <>{content}</>;\n    };\n}\n*/\nexport class VUnsupportedUnit extends VPage<CAppBase> {\n    async open(predefinedUnit: number) {\n        this.openPage(this.page, {predefinedUnit:predefinedUnit});\n    }\n\n    private page = ({predefinedUnit}:{predefinedUnit: number}) => {\n        let {user} = nav;\n        let userName:string = user? user.name : '[未登录]';\n        let {appOwner, appName} = UQsMan.value;\n        return <Page header=\"APP无法运行\" logout={true}>\n            <div className=\"m-3 text-danger container\">\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\n                    <div className=\"col-sm text-body\">{userName}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">App</div>\n                    <div className=\"col-sm text-body\">{`${appOwner}/${appName}`}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">\n                        可能原因<FA name=\"exclamation-triangle\" />\n                    </div>\n                    <div className=\"col-sm text-body\">\n                        <ul className=\"p-0\">\n                            <li>没有小号运行 {appName}</li>\n                            <li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\n                            {\n                                predefinedUnit && \n                                <li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\n                            }\n                        </ul>\n                    </div>\n                </div>\n                <div className=\"form-group row\">\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\n                    <div className=\"col-sm text-body\">\n                        预设小号定义在 public/unit.json 文件中。\n                        定义了这个文件的程序，只能由url直接启动。\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\n                        如果要删去缓存的预定义Unit，logout然后再login。\n                    </div>\n                </div>\n            </div>\n        </Page>;\n    }\n}\n\nexport class VUnitSelect extends VPage<CAppBase> {\n    async open() {\n        this.openPage(this.page);\n    }\n\n    private renderRow = (item: any, index: number):JSX.Element => {\n        let {id, nick, name} = item;\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\n            <div>{nick || name}</div>\n        </LMR>;\n    }\n    private onRowClick = async (item: any) => {\n        appInFrame.unit = item.id; // 25;\n        await this.controller.start();\n    }\n\n    private page = () => {\n        return <Page header=\"选择小号\" logout={true}>\n            <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\n        </Page>\n    }\n}\n\nexport class VErrorsPage extends VPage<CAppBase> {\n    async open(errors:string[]) {\n        this.openPage(this.page, {errors:errors});\n    }\n\n    private page = (errors:{errors:string[]}) => {\n        return <Page header=\"ERROR\">\n            <div className=\"m-3\">\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\n\t\t\t\t</div>\n\n                <div>Load Uqs 发生错误：</div>\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\n            </div>\n        </Page>;\n    }\n}\n\nexport class VStartError extends VPage<CAppBase> {\n    async open(error:any) {\n        this.openPage(this.page, {error:error});\n    }\n\n    private page = ({error}:{error:any}) => {\n        return <Page header=\"App start error!\">\n            <pre>\n                {typeof error === 'string'? error : error.message}\n            </pre>\n        </Page>;\n    }\n}","import { nav, t, setGlobalRes, RouteFunc, Hooks, Navigo, NamedRoute } from \"../components\";\nimport { Controller } from '../vm';\nimport { UQsMan, TVs } from \"../uq\";\nimport { appInFrame } from \"../net\";\nimport { centerApi } from \"./centerApi\";\nimport { VUnitSelect, VErrorsPage, VStartError, VUnsupportedUnit } from \"./vMain\";\n\nexport interface IConstructor<T> {\n    new (...args: any[]): T;\n}\n\nexport interface AppConfig {\n    appName: string;        // 格式: owner/appName\n    version: string;        // 版本变化，缓存的uqs才会重载\n    tvs: TVs;\n    uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\n    loginTop?: JSX.Element;\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\n\tprivacy?: string;\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\n\thtmlTitle?: string;\n}\n\nexport interface Elements {\n\t[id:string]: (element: HTMLElement)=>void,\n}\n\nexport abstract class CAppBase extends Controller {\n\tprivate appConfig: AppConfig;\n    protected _uqs: any;\n\n    protected readonly name: string;\n\t//protected readonly version: string;\n\tprotected readonly noUnit: boolean;\n\n    //readonly uqsMan: UQsMan;\n    appUnits:any[];\n\n    // appName: owner/name\n    constructor(config?: AppConfig) {\n\t\tsuper(undefined);\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\n        let {appName, noUnit} = this.appConfig;\n        this.name = appName;\n        if (appName === undefined) {\n            throw new Error('appName like \"owner/app\" must be defined in MainConfig');\n        }\n\t\tthis.noUnit = noUnit;\n\t\t//this._uqs = UQsMan._uqs;\n\t\t//this.version = version;\n        //this.uqsMan = new UQsMan(this.name, tvs);\n    }\n\n    get uqs(): any {return this._uqs;}\n\n\tinternalT(str:string):any {\n\t\treturn t(str);\n\t}\n\t\n\tprotected setRes(res:any) {\n\t\tsetGlobalRes(res);\n\t}\n\t\n\tprotected hookElements(elements: Elements) {\n\t\tif (elements === undefined) return;\n\t\t//nav.setSettings(appConfig);\n\t\t//let cApp:CApp = (await start(CApp, appConfig)) as CApp;\n\t\tfor (let i in elements) {\n\t\t\tlet el = document.getElementById(i);\n\t\t\tif (el) {\n\t\t\t\telements[i](el);\n\t\t\t}\n\t\t}\n\t};\n\t\n    protected async beforeStart():Promise<boolean> {\n        try {\n\t\t\tthis.onRoute();\n\t\t\tif (nav.isInAppRouting === true || !nav.isRouting) {\n\t\t\t\t//await nav.init();\n\t\t\t\tlet {appName, version, tvs} = this.appConfig;\n\t\t\t\tawait UQsMan.load(appName, version, tvs);\n\t\t\t}\n\t\t\tthis._uqs = UQsMan._uqs;\n\t\t\n            //let retErrors = await this.load();\n            //let app = await loadAppUqs(this.appOwner, this.appName);\n            // if (isDevelopment === true) {\n\t\t\t// 这段代码原本打算只是在程序员调试方式下使用，实际上，也可以开放给普通用户，production方式下\n\t\t\tlet retErrors = UQsMan.errors;\n            let {predefinedUnit} = appInFrame;\n            let {user} = nav;\n            if (user !== undefined && user.id > 0) {\n\t\t\t\tthis.appUnits = await centerApi.userAppUnits(UQsMan.value.id);\n\t\t\t\tif (this.noUnit === true) return true;\n                switch (this.appUnits.length) {\n                    case 0:\n                        this.showUnsupport(predefinedUnit);\n\t\t\t\t\t\treturn false;\n                    case 1:\n                        let appUnit = this.appUnits[0].id;\n                        if (appUnit === undefined || appUnit < 0 || \n                            (predefinedUnit !== undefined && appUnit !== predefinedUnit))\n                        {\n                            this.showUnsupport(predefinedUnit);\n                            return false;\n                        }\n                        appInFrame.unit = appUnit;\n                        break;\n                    default:\n                        if (predefinedUnit>0 && this.appUnits.find(v => v.id===predefinedUnit) !== undefined) {\n                            appInFrame.unit = predefinedUnit;\n                            break;\n                        }\n                        this.openVPage(VUnitSelect);\n                        return false;\n                }\n            }\n            if (retErrors !== undefined) {\n                this.openVPage(VErrorsPage, retErrors);\n                return false;\n            }\n            return true;\n        }\n        catch (err) {\n            this.openVPage(VStartError, err);\n            return false;\n        }\n    }\n\tprotected async afterStart():Promise<void> {\n\t\tif (nav.isInAppRouting) nav.resolveRoute();\n\t}\n\n    async userFromId(userId:number):Promise<any> {\n        return await centerApi.userFromId(userId);\n    }\n\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\n\tprotected on(...args:any[]):Navigo {\n\t\tnav.isInAppRouting = true;\n\t\treturn nav.on(args[0], args[1], args[2]);\n\t}\n\n\tprotected onRoute() {\t\t\n\t}\n\n\t/*\n    private async load(): Promise<string[]> {\n        let {appOwner, appName} = this.uqsMan;\n        let {localData} = this.uqsMan;\n        let uqAppData:UqAppData = localData.get();\n        if (!uqAppData || uqAppData.version !== this.version) {\n\t\t\tuqAppData = await loadAppUqs(appOwner, appName);\n\t\t\tif (!uqAppData.id) {\n\t\t\t\treturn [\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\n\t\t\t\t];\n\t\t\t}\n            uqAppData.version = this.version;\n            localData.set(uqAppData);\n            // \n            for (let uq of uqAppData.uqs) uq.newVersion = true;\n        }\n        let {id, uqs} = uqAppData;\n        this.uqsMan.id = id;\n        await this.uqsMan.init(uqs);\n        let retErrors = await this.uqsMan.load();\n        if (retErrors.length === 0) {\n            retErrors.push(...this.uqsMan.setTuidImportsLocal());\n            if (retErrors.length === 0) {\n                this._uqs = this.uqsMan.buildUQs();\n                return;\n            }\n        }\n        return retErrors;\n\t}\n\t*/\n\n    private showUnsupport(predefinedUnit: number) {\n        nav.clear();\n        this.openVPage(VUnsupportedUnit, predefinedUnit);\n    }\n}\n","import { AppConfig, CAppBase } from './CAppBase';\n\nexport async function start(CApp: new (config: AppConfig) => CAppBase, appConfig: AppConfig) {\t\n\tlet {htmlTitle} = appConfig;\n\tif (htmlTitle) {\n\t\tdocument.title = htmlTitle;\n\t}\n\tlet html = document.getElementsByTagName('html');\n\tlet html0 = html[0];\n\tif (html0) {\n\t\tlet version = html0?.getAttribute('data-version');\n\t\tif (version) appConfig.version = version;\n\t}\n\n\tlet cApp = new CApp(appConfig);\n    await cApp.start();\n}\n","import { Controller } from \"../vm\";\nimport { IConstructor } from \"./CAppBase\";\n\nexport abstract class CBase extends Controller {\n    protected readonly _uqs: any;\n    protected readonly _cApp: any;\n\n    constructor(cApp: any) {\n        super(undefined);\n        this._cApp = cApp;\n        this._uqs = cApp && cApp.uqs;\n\t}\n\n    protected get uqs(): any {return this._uqs}\n\tget cApp(): any {return this._cApp}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._cApp.internalT(str);\n\t}\n\n    protected newC<T extends CBase>(type: IConstructor<T>, param?:any):T {\n\t\tlet c = new type(this.cApp);\n\t\tc.init(param);\n\t\treturn c;\n    }\n\n    protected newSub<O extends CBase, T extends CSub<O>>(type: IConstructor<T>, param?:any):T {\n\t\tlet s = new type(this);\n\t\ts.init(param);\n\t\treturn s;\n    }\n}\n\nexport abstract class CSub<T extends CBase> extends CBase {\n    protected _owner: T;\n\n    constructor(owner: T) {\n        super(owner.cApp);\n        this._owner = owner;\n\t}\n\n\tinternalT(str:string):any {\n\t\tlet r = super.internalT(str);\n\t\tif (r!==undefined) return r;\n\t\treturn this._owner.internalT(str);\n\t}\n\n    protected get owner(): CBase {return this._owner}\n}\n","import * as React from 'react';\nimport { IObservableArray, computed } from 'mobx';\nimport { PageItems } from '../../tool/pageItems';\nimport {List} from './index';\n\nexport abstract class ListBase {\n    protected list: List;\n    constructor(list: List) {\n        this.list = list;\n    }\n    get isPaged():boolean {\n        let items = this.list.props.items;\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\n    }\n    get items():any[]|IObservableArray<any> {\n        let items = this.list.props.items;\n        if (items === null) return null;\n        if (items === undefined) return undefined;\n        if (Array.isArray(items) === true)\n            return items as IObservableArray<any>;\n        else\n            return (items as PageItems<any>).items;\n    }\n    @computed get loading():boolean {\n        let items = this.list.props.items;\n        if (items === null) return false;\n        if (items === undefined) return true;\n        let pageItems = items as PageItems<any>;\n        if (pageItems.items === undefined) return false;\n        return pageItems.loading;\n    }\n    get selectedItems():any[] { return undefined; }\n    //updateProps(nextProps:any) {}\n    dispose() {};\n    abstract render: (item:any, index:number) => JSX.Element;\n    protected renderContent(item:any, index:number) {\n        let {render} = this.list.props.item;\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\n        return render(item, index);\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\n\nexport class Clickable extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key, onClick} = this.list.props.item;\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport { ListBase } from './base';\nimport { uid } from '../../tool/uid';\n\nexport class Static extends ListBase {\n    render = (item:any, index:number):JSX.Element => {\n        let {className, key} = this.list.props.item;\n        if (typeof item === 'string') {\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\n            return <li key={uid()} className={cn}>{item}</li>;\n        }\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\n            {this.renderContent(item, index)}\n        </li>\n    }\n}\n","import * as React from 'react';\nimport {observable, IObservableArray, isObservableArray, observe} from 'mobx';\nimport classNames from 'classnames';\nimport {ListBase} from './base';\nimport {uid} from '../../tool/uid';\nimport { PageItems } from '../../tool/pageItems';\nimport { List } from './index';\nimport { observer } from 'mobx-react';\n\nexport interface SelectableItem {\n    selected: boolean;\n    item: any;\n    labelId: string;\n}\n\nexport class Selectable extends ListBase {\n    @observable private _items: SelectableItem[];\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\n\n    constructor(list: List) {\n        super(list);\n        this.buildItems();\n        this.listenArraySplice();\n    }    \n\n    private listenArraySplice() {\n        let {items} = this.list.props;\n        if (items === undefined) return;\n        if (items === null) return;\n        let itemsArray:any;\n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        if (isObservableArray(items) === true) {\n            observe(itemsArray as IObservableArray<any>, (change) => {                \n                if (change.type === 'splice') {\n                    let {index, removedCount, added} = change;\n                    let _added = added && added.map(v => {\n                        return {\n                            selected: false, \n                            item: v, \n                            labelId:uid()\n                        }\n                    });\n                    this._items.splice(index, removedCount, ..._added);\n                    this.buildItems();\n                }\n            }, true);\n        }\n    }\n\n    private buildItems = () => {\n        let {items, selectedItems, compare} = this.list.props;\n        let itemsArray:any[] | IObservableArray<any>;\n        if (items === undefined) {\n            this._items = undefined;\n            return;\n        }\n        if (items === null) {\n            this._items = null;\n            return;\n        }\n        \n        if (Array.isArray(items) === true) {\n            itemsArray = items as any;\n        }\n        else {\n            itemsArray = (items as PageItems<any>).items;\n        }\n        //let items = this.items;\n        //this._selectedItems = selectedItems;\n\n        let comp: ((item:any, selectItem:any)=>boolean);\n        if (compare === undefined) {\n            comp = (item:any, selectItem:any) => item === selectItem;\n        }\n        else {\n            comp = compare;\n        }\n        let retItems = itemsArray.map(v => {\n            //let isObserved = isObservable(v);\n            //let obj = isObserved === true? toJS(v) : v;\n            //let obj = v;\n            let selected = selectedItems === undefined?\n                false\n                : selectedItems.find(si => comp(v, si)) !== undefined;\n            return {\n                selected: selected, \n                item: v, \n                labelId:uid()\n            };\n        });\n        this._items = retItems;\n    }\n\n    get items() {\n        //if (this._items === undefined) \n        //this.buildItems();\n        return this._items;\n    }\n    private checkAll(on: boolean) {\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\n        for (let item of this._items) item.selected = on;\n    }\n    selectAll() {\n        //if (this._items) this._items.forEach(v => v.selected = true);\n        this.checkAll(true);\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\n    }\n    unselectAll() {\n        // if (this._items) this._items.forEach(v => v.selected = false);\n        this.checkAll(false);\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\n    }\n    /*\n    updateProps(nextProps:any) {\n        if (nextProps.selectedItems === this._selectedItems) return;\n        this.buildItems();\n    }\n    */\n    private get anySelected():boolean {return this._items.some(v => v.selected)}\n    private onSelect(item:SelectableItem, selected:boolean) {\n        item.selected = selected;\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\n    }\n    \n    get selectedItems():any[] {\n        return this._items.filter(v => v.selected === true).map(v => v.item);\n    }\n    /*\n    set selectedItems(value: any[]) {\n        if (value === undefined) return;\n        if (this._items === undefined) return;\n        let sLen = this._items.length;\n        let list = value.slice();\n        for (let n=0; n<sLen; n++) {\n            let sItem = this._items[n];\n            let len = list.length;\n            if (len === 0) break;\n            let item = sItem.item;\n            for (let i=0; i<len; i++) {\n                let v = list[i];\n                if (item === v) {\n                    sItem.selected = true;\n                    value.splice(i, 1);\n                    break;\n                }\n            }\n        };\n    }\n    */\n    //w-100 mb-0 pl-3\n    //m-0 w-100\n    render = (item:SelectableItem, index:number):JSX.Element => {\n        let {key} = this.list.props.item;\n\t\t//return <this.row item={item} index={index} key={key===undefined?index:key(item)} />;\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\n    }\n\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\n        let {item, index} = props;\n        let {className} = this.list.props.item;\n        let {labelId, selected, item:obItem} = item;\n        return <li className={classNames(className)}>\n            <div className=\"d-flex align-items-center px-3\">\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\n                    defaultChecked={selected}\n                    onChange={(e)=>{\n                        this.onSelect(item, e.target.checked)} \n                    }/>\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\n                    {this.renderContent(obItem, index)}\n                </label>\n            </div>\n        </li>\n    })\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport _ from 'lodash';\nimport {PageItems} from '../../tool/pageItems';\nimport {ListBase} from './base';\nimport {Clickable} from './clickable';\nimport {Static} from './static';\nimport {Selectable} from './selectable';\nimport '../../css/va-list.css';\nimport { IObservableArray } from 'mobx';\nimport { resLang } from '../../res/res';\nimport { ListRes, listRes } from '../../res';\n\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\ninterface ItemProps {\n\tclassName?: string|string[];\n\trender?: (item:any, index:number) => JSX.Element;\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\n\tonClick?: (item:any)=>void;\n\tkey?: (item:any)=>string|number;\n}\n\nexport interface ListProps {\n    className?: string|string[];\n    items: any[] | IObservableArray<any> | PageItems<any>;\n    item: ItemProps;\n    compare?:(item:any, selectItem:any)=>boolean;\n    selectedItems?:any[];\n    header?: StaticRow;\n    footer?: StaticRow;\n    before?: StaticRow;\n    loading?: StaticRow;\n\tnone?: StaticRow;\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\n}\n\n@observer\nexport class List extends React.Component<ListProps> {\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\n\n\tprivate listBase: ListBase;\n\tprivate selectable: Selectable;\n    constructor(props:ListProps) {\n\t\tsuper(props);\n        this.buildBase();\n    }\n    _$scroll = (direct: 'top'|'bottom') => {\n        console.log('############### items scroll to ' + direct);\n    }\n    private buildBase() {\n        let {item} = this.props;\n        let {onClick, onSelect} = item;\n        if (onSelect !== undefined)\n            this.selectable = this.listBase = new Selectable(this);\n        else if (onClick !== undefined)\n            this.listBase = new Clickable(this);\n        else\n            this.listBase = new Static(this);\n\t}\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\n\t\t\tthis.buildBase();\n\t\t\tthis.forceUpdate();\n\t\t}\n\t}\n    componentWillUnmount() {\n        this.listBase.dispose();\n    }\n    selectAll() {\n        if (this.selectable) this.selectable.selectAll();\n    }\n    unselectAll() {\n        if (this.selectable) this.selectable.unselectAll();\n    }\n    get selectedItems():any[] {\n        return this.listBase.selectedItems;\n    }\n    render() {\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\n        if (before === undefined) before = '-';\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\n        if (none === undefined) none = List.res.none;\n        //this.listBase.selectedItems = selectedItems;\n        let {items, loading:isLoading} = this.listBase;\n        function staticRow(row:StaticRow, type:string) {\n            if (!row) return;\n            switch (typeof row) {\n                default:\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\n                case 'object': return <li>{row}</li>\n            } \n        }\n        let content:any, waitingMore:any;\n        if (items === null)\n            content = staticRow(before, 'before');\n        else if (items === undefined)\n            content = staticRow(loading, 'loading');\n        else if (items.length === 0)\n            content = staticRow(none, 'none');\n        else {\n            content = items.map((item, index) => {\n                return this.listBase.render(item, index);\n            });\n        }\n        if (isLoading === true && items) {\n            waitingMore = staticRow(loading, 'loading');\n\t\t}\n\t\tlet tabIndex:number;\n\t\tif (onFocus !== undefined) tabIndex = -1;\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\n            {staticRow(header, 'header')}\n            {content}\n            {waitingMore}\n            {staticRow(footer, 'footer')}\n        </ul>;\n    }\n}\n","import * as React from 'react';\nimport className from 'classnames';\nimport {PropGridProps} from './PropGrid';\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\n\nexport abstract class PropRow {\n    setValues(values: any) {}\n    abstract render(key:string): any;\n}\n\nexport class PropBorder extends PropRow {\n    render(key:string): JSX.Element {\n        return <div key={'_b_' + key} className=\"\">\n            <div className=\"w-100\">\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\n            </div>\n        </div>;\n    }\n}\n\nexport class PropGap extends PropRow {\n    private param: string;\n    constructor(param?: string) {\n        super();\n        this.param = param;\n    }\n    render(key:string): JSX.Element {\n        let w: string;\n        switch (this.param) {\n            default: w = 'py-2'; break;\n            case '=': w = 'py-1'; break;\n            case '-': w = 'pb-1'; break;\n        }\n        let cn = className(w);\n        return <div key={'_g_' + key} className={cn} />;\n    }\n}\n\nconst valueAlignStart = 'justify-content-start';\nconst valueAlignCenter = 'justify-content-center';\nconst valueAlignEnd = 'justify-content-end';\nexport abstract class LabeledPropRow extends PropRow {\n    protected gridProps: PropGridProps;\n    protected _prop: LabeledProp;\n    protected get prop():LabeledProp {return this._prop}\n    protected content: any;\n    protected col: string;\n    //protected values: any;\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\n        super();\n        this.gridProps = gridProps;\n        this._prop = prop;\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\n        //this.values = values;\n    }\n    render(key:string):any {\n        let {onClick, bk} = this.prop;\n        let cn = className({\n            \"cursor-pointer\": onClick !== undefined,\n            \"bg-white\": bk === undefined, \n            \"row\": true\n        });\n        return <div key={key} className={cn} onClick={onClick}>\n            {this.renderLabel()}\n            {this.renderProp()}\n        </div>;\n    }\n    protected renderLabel():any {\n        let {label} = this.prop;\n        if (label === undefined) return null;\n        return <label className={this.col + '-3 col-form-label'}>\n            {label}\n        </label>;\n    }\n    protected renderProp():any {\n        let {label} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string = this.col + (label===undefined? '-12':'-9');\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n    protected renderPropBody():any {\n        return <div className=\"form-control-plaintext\">\n            {this.renderPropContent()}\n        </div>;\n    }\n    protected renderPropContent():any {\n        return this.content;\n    }\n}\n\nexport class StringPropRow extends LabeledPropRow {\n    protected get prop(): StringProp {return this._prop as StringProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class NumberPropRow extends LabeledPropRow {\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else this.content = values[this.prop.name];\n    }\n}\n\nexport class ListPropRow extends LabeledPropRow {\n    protected get prop(): ListProp {return this._prop as ListProp;}\n    setValues(values:any) {\n        if (values === undefined) this.content = undefined;\n        else {\n            let list = this.prop.list;\n            if (typeof list === 'string') this.content = values[list];\n            else this.content = undefined;\n        }\n    }\n    protected renderPropBody() {\n        let {list, row} = this.prop;\n        let items:any[] = typeof list === 'string'? this.content : list;\n        if (items === undefined) return <div/>;\n        // new row(item)\n        return <div className=\"w-100\">\n            {\n                items.map((item, index) => <React.Fragment key={index}>\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\n                    {React.createElement(row, item)}\n                </React.Fragment>)\n            }\n        </div>;\n    }\n}\n\nexport class ComponentPropRow extends LabeledPropRow {\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\n    protected renderPropBody() {\n        let {component} = this.prop;\n        return component;\n    }\n    protected renderProp():any {\n        let {label, full} = this.prop;\n        let align, vAlign;\n        switch (this.gridProps.alignValue) {\n            case 'left': align = valueAlignStart; break;\n            case 'center': align = valueAlignCenter; break;\n            case 'right': align = valueAlignEnd; break;\n        }\n        switch (this.prop.vAlign) {\n            case 'top': vAlign = 'align-items-start'; break;\n            default:\n            case 'center': vAlign = 'align-items-center'; break;\n            case 'bottom': vAlign = 'align-items-end'; break;\n            case 'stretch': vAlign = 'align-items-stretch'; break;\n        }\n        let col:string;\n        if (full !== true)\n            col = this.col + (label===undefined? '-12':'-9');\n        else\n            col = 'w-100';\n        let cn = className(align, vAlign, col, 'd-flex');\n        return <div className={cn}>\n            {this.renderPropBody()}\n        </div>;\n    }\n}\n","import { PropGridProps } from './PropGrid';\nimport {\n    PropRow, PropBorder, PropGap, \n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\n} from './row';\n\nexport interface Format {\n\n}\n\nexport interface PropBase {\n    onClick?: () => void;\n}\n\nexport interface LabeledProp extends PropBase {\n    label?: string;\n    bk?: string;\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\n}\n\nexport interface StringProp extends LabeledProp {\n    type: 'string';\n    name: string;\n}\n\nexport interface NumberProp extends LabeledProp {\n    type: 'number';\n    name: string;\n}\n\nexport interface FormatProp extends LabeledProp {\n    type: 'format';\n    format: Format;\n}\n\nexport interface ListProp extends LabeledProp {\n    type: 'list';\n    list: string | any[];  // string 表示名字，否则就是值\n    row: new (props: any) => React.Component;\n}\n\nexport interface ComponentProp extends LabeledProp {\n    type: 'component';\n    full?: boolean;\n    component: any; //JSX.Element;\n}\n\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\n\nexport class PropView {\n    private gridProps: PropGridProps\n    private props: Prop[];\n    //private values:any;\n    private rows: PropRow[];\n\n    constructor(gridProps: PropGridProps, props: Prop[]) {\n        this.gridProps = gridProps;\n        this.props = props;\n        //this.values = values;\n        this.buildRows();\n    }\n\n    private buildRows() {\n        this.rows = [];\n        let isGap: boolean = true;\n        for (let prop of this.props) {\n            if (typeof prop === 'string') {\n                this.rows.push(new PropGap(prop));\n                isGap = true;\n            }\n            else {\n                if (!isGap) this.rows.push(new PropBorder());\n                let row;\n                switch (prop.type) {\n                    default: continue;\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\n                }\n                this.rows.push(row);\n                isGap = false;\n            }\n        }\n    }\n\n    setValues(values: any) {\n        for (let r of this.rows) r.setValues(values);\n    }\n\n    render() {\n        return this.rows.map((row, index) => row.render(String(index)));\n    }\n}\n","import * as React from 'react';\nimport classNames from 'classnames';\nimport {observer} from 'mobx-react';\nimport {Prop, PropView} from './propView';\n\nexport interface PropGridProps {\n    className?: string;\n    rows: Prop[];\n    values: any;\n    alignValue?: 'left'|'center'|'right';\n    labelFixLeft?: boolean;\n}\n\n@observer\nexport class PropGrid extends React.Component<PropGridProps> {\n    render() {\n        let {className, rows, values} = this.props;\n        let propView = new PropView(this.props, rows);\n        propView.setValues(values);\n        let cn = classNames('container-fluid', className);\n        return <div className={cn}>\n            {propView.render()}\n        </div>;\n    }\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\nimport { userApi } from '../net';\n\nexport class EditMeInfo extends React.Component {\n    private schema:ItemSchema[] = [\n        {name:'nick', type:'string'} as StringSchema,\n        {name:'icon', type:'image'} as ImageSchema\n    ];\n    private uiSchema:UiSchema = {\n        items: {\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\n            icon: {widget:'image', label:'头像'} as UiImageItem,\n        }\n    }\n    @observable private data:any;\n\n    constructor(props:any) {\n        super(props);\n        let {nick, icon} = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        }\n    }\n\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\n        let {name} = itemSchema;        \n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        let user:any = nav.user;\n        user[name] = newValue;\n        nav.saveLocalUser();\n    }\n\n    render() {\n        return <Page header=\"个人信息\">\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\n                data={this.data}\n                onItemChanged={this.onItemChanged} />\n        </Page>;\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import { AppConfig } from \"tonva\";\nimport { appName } from \"./appName\";\n\nexport const appConfig: AppConfig = {\n    appName: appName,\n\tversion: '1.0.0',\n\tnoUnit: true,\n    tvs: {},\n\toem: undefined,\n\thtmlTitle: '小单 - 记录和协作',\n};\n","export const appName = 'Bruce/notes';\n","import { CSub, CBase, CAppBase, IConstructor } from 'tonva';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n}\n\nexport abstract class CUqSub<T extends CUqBase> extends CSub<T> {\n    get cApp(): CApp { return this._cApp; }\n    protected get uqs(): UQs { return this._uqs as UQs };\n    get owner(): T { return this._owner as T }\n}\n\nexport abstract class CUqApp extends CAppBase {\n    get uqs(): UQs { return this._uqs };\n\n    protected newC<T extends CUqBase>(type: IConstructor<T>): T {\n\t\tlet c = new type(this);\n\t\tc.init();\n\t\treturn c;\n    }\n}\n","import * as React from 'react';\nimport { VPage, TabCaptionComponent, Page, TabProp, t } from 'tonva';\nimport { CApp } from './CApp';\n\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\nfunction caption(label:string, icon:string) {\n\treturn (selected: boolean) => TabCaptionComponent(label, icon, color(selected));\n}\nexport class VMain extends VPage<CApp> {\n    async open(param?: any) {\n        this.openPage(this.render);\n    }\n\n    render = (param?: any): JSX.Element => {\n\t\tlet { cHome, cRelation, cDiscover, cMe } = this.controller;\n\t\t/*\n        let faceTabs = [\n\t\t\t{ name: 'note', label: '首页', icon: 'home', content: cGroup.tab},\n\t\t\t{ name: 'job', label: '查看', icon: 'list', content: cReport.tab, onShown: cReport.load, className: 'job-tab' },\n            //{ name: 'home', label: '绩效', icon: 'tasks', content: cHome.tab, },\n            { name: 'me', label: '我的', icon: 'user', content: cMe.tab }\n        ].map(v => {\n            let { name, label, icon, content, onShown, className } = v;\n            return {\n                name: name,\n                caption: (selected: boolean) => TabCaptionComponent(label, icon, color(selected)),\n                content: content,\n\t\t\t\tonShown: onShown,\n\t\t\t\tclassName: className\n            }\n\t\t});\n\t\t*/\n\t\tlet tabs: TabProp[] = [\n\t\t\t{name: 'home', caption: caption(t('home'), 'home'), content: cHome.tab},\n\t\t\t{name: 'relation', caption: caption(t('relation'), 'user-plus'), content: cRelation.tab, onShown: cRelation.load},\n\t\t\t{name: 'discover', caption: caption(t('discover'), 'arrows-alt'), content: cDiscover.tab},\n\t\t\t{name: 'me', caption: caption(t('me'), 'user-o'), content: cMe.tab},\n\t\t];\n\t\treturn <Page tabsProps={{tabs}} />;\n    }\n}\n","import { BoxId, t } from \"tonva\";\n\n//export const notesName = t('notes');\nexport enum EnumNoteItemType {text=0, task=1, folder=3}\n\nexport interface NoteItem {\n\tseconds: number;\n\towner: number | BoxId;\n\tnote: number;\n\ttype: EnumNoteItemType;\n\tcaption: string;\n\tcontent: string;\n\tassigned: string;\n\tfrom: number | BoxId;\n\tfromAssigned: string;\n\tstate: number;\n\tflowContent?: string;\n\tunread: number;\n\tobj: any;\n\t$create: Date;\n\t$update: Date;\n\ttoCount?: number;\n\tspawnCount?: number;\n}\n\nexport interface NoteFlow {\t\n}\n\nexport interface Access {\n\tuser: number;\n\taccess: number;\n\tassigned: string;\n}\n\nexport interface CommentItem {\n\tid: number;\n\tcontent: string;\n\towner: number;\n\tassigned: string;\n\t$create: Date;\n\t$update: Date;\n}\n\nexport interface NoteModel {\n\tid: number;\n\tcaption: string;\n\tcontent: string;\n\ttype: EnumNoteItemType,\n\t$create: Date;\n\t$update: Date;\n\tto: Access[];\n\tflow: NoteFlow[];\n\tspawn: NoteItem[];\n\tcontain: NoteItem[];\n\tcomments: CommentItem[];\n}\n\nexport function replaceAll(str:string, findStr:string, repStr:string):string {\n\tif (!str) return str;\n\treturn str.split(findStr).join(repStr);\n}\n\nexport function numberFromId(id:number|BoxId):number {\n\tlet _id:number;\n\tswitch (typeof id) {\n\t\t\tcase 'object': _id = (id as BoxId).id; break;\n\t\t\tcase 'number': _id = id as number; break;\n\t\t\tdefault: return;\n\t}\n\treturn _id;\n}\n\n","import React from 'react';\nimport { VPage, User, Image, UserView } from \"tonva\";\nimport { CNote } from \"../CNote\";\nimport { Contact } from 'model';\n\nexport abstract class VBasePage extends VPage<CNote> {\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected renderContactItem = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\treturn <div className=\"px-3 py-2\">\n\t\t\t{this.renderContact(contact, assigned)}\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VBasePage } from './VBasePage';\nimport { List, User, Image, UserView, FA } from 'tonva';\nimport { Contact } from 'model';\n\nexport interface SelectContactOptions {\n\ttitle?: string;\n\taction?: string;\n\tsingle?: boolean;\n}\n\nexport class VSelectContact extends VBasePage {\n\t@observable private anySelected:boolean = false;\n\t@observable private contacts: Contact[];\n\t@observable private multiple:boolean = false;\n\tprivate list: List;\n\tprivate options: SelectContactOptions;\n\n\tinit(options: SelectContactOptions):void {\n\t\tthis.options = options;\n\t}\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return this.options?.title ?? '选择'}\n\tright() {\n\t\treturn React.createElement(observer(this.buildRight));\n\t}\n\n\tprivate buildRight = () => {\n\t\tif (this.options?.single === true) return;\n\t\tlet cn = 'btn btn-sm btn-success mr-1';\n\t\tif (this.multiple === false) {\n\t\t\treturn <button className={cn} onClick={this.onToggleSelect}>多选</button>;\n\t\t}\n\t\tif (this.contacts && this.contacts.length > 0) {\n\t\t\treturn <button className={cn} onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t\t{this.options?.action ?? '选中'}({this.contacts.length}) <FA name=\"angle-right\" />\n\t\t\t</button>;\n\t\t}\n\t\treturn <button className={cn} onClick={this.onToggleSelect}>单选</button>;\n\t}\n\n\tprivate onToggleSelect = () => {\n\t\tthis.multiple = !this.multiple;\n\t}\n\n\tcontent() {\n\t\tlet render = () => {\n\t\t\tlet list:any;\n\t\t\tlet items = this.controller.cApp.contacts;\n\t\t\tif (this.multiple === true) {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t\t}\n\t\t\telse {\n\t\t\t\tlist = <List ref={v => this.list = v}\n\t\t\t\t\titems={items} \n\t\t\t\t\titem={{render:this.renderContactItem, onClick:this.onContactClick}} />\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{list}\n\t\t\t</div>;\n\t\t}\n\t\treturn React.createElement(observer(render));\n\t}\n\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t\tthis.contacts = this.list.selectedItems;\n\t}\n\n\tprivate onContactClick = (item:Contact) => {\n\t\tthis.returnCall([item]);\n\t}\n\n\tprivate onNext = () => {\n\t\tthis.returnCall(this.list.selectedItems);\n\t}\n}\n","import React from \"react\";\nimport { VPage, User, Image, UserView, Page, EasyTime, FA } from \"tonva\";\nimport { CNoteItem, CheckItem } from \"./CNoteItem\";\nimport { observer } from \"mobx-react\";\nimport { EnumNoteItemType } from 'note/model';\n\nconst itemIcons: {[key in EnumNoteItemType]: JSX.Element} = {\n\t[EnumNoteItemType.text]: <FA name=\"file-text-o\" size=\"lg\" className=\"text-info\" />,\n\t[EnumNoteItemType.task]: <FA name=\"tasks\" size=\"lg\" className=\"text-success\" />,\n\t[EnumNoteItemType.folder]: <FA name=\"folder\" size=\"lg\" className=\"text-warning mr-2\" />,\n}\n\nexport abstract class VNoteBase<T extends CNoteItem> extends VPage<T> {\n\tprotected renderContentBase(checkable:boolean) {\n\t\tlet {checkType} = this.controller;\n\t\treturn <div>\n\t\t{\n\t\t\tcheckType === 0 || checkType === 3 ? \n\t\t\t\tthis.renderContentText()\n\t\t\t\t: \n\t\t\t\tcheckType === 1 ? \n\t\t\t\t\tthis.renderCheckItems(checkable)\n\t\t\t\t\t:\n\t\t\t\t\tthis.renderContentList()\n\t\t}\n\t\t</div>;\n\t}\n\n\tprotected renderContent() {\n\t\treturn this.renderContentBase(true);\n\t}\n\n\tprotected renderItemContent() {\n\t\treturn this.renderContentBase(false);\n\t}\n\n\tprotected renderTop() {\n\t\tlet {type, unread} = this.controller.noteItem;\n\t\tlet dot:any;\n\t\tif (unread>0) dot = <u/>;\n\t\treturn <div className=\"d-flex mx-3 py-2 unread-dot align-items-center\">\n\t\t\t<div className=\"mr-4\">{itemIcons[type]}{dot}</div>\n\t\t\t{this.renderFrom()}\n\t\t</div>;\n}\n\t\n\tprotected renderParagraphs(content:string):JSX.Element {\n\t\tif (!content) return;\n\t\treturn <>{content.trimRight().split('\\n').map((v, index) => {\n\t\t\tlet c:any;\n\t\t\tif (!v) {\n\t\t\t\tc = '\\u00A0'; //<>&nbsp;</>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tc = '';\n\t\t\t\tlet len = v.length, i=0;\n\t\t\t\tfor (; i<len; i++) {\n\t\t\t\t\tswitch(v.charCodeAt(i)) {\n\t\t\t\t\t\tcase 0x20: c +='\\u2000'; continue;\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tc += v.substr(i);\n\t\t\t}\n\t\t\treturn <div key={index} className=\"mb-3\">{c}</div>;\n\t\t})}</>;\n\t}\n\n\tprotected renderContentText() {\n\t\treturn <div className=\"px-3 py-3\">{this.renderParagraphs(this.controller.noteContent)}</div>;\n\t}\n\n\tprotected renderContentList() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet items = this.controller.items;\n\t\t\treturn <ul className=\"note-content-list px-3 pb-2\">\n\t\t\t\t{items.map((v, index) => {\n\t\t\t\t\tlet {key, text} = v;\n\t\t\t\t\treturn <li key={key} className=\"ml-3 pt-1 pb-2 align-items-center\">\n\t\t\t\t\t\t{text}\n\t\t\t\t\t</li>\n\t\t\t\t})}\n\t\t\t</ul>;\n\t\t}));\n\t}\n\n\tprotected renderCheckItems(checkable:boolean) {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet uncheckedItems:CheckItem[] = [];\n\t\t\tlet checkedItems:CheckItem[] = [];\n\t\t\tfor (let ci of this.controller.items) {\n\t\t\t\tlet {checked} = ci;\n\t\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\t\telse uncheckedItems.push(ci);\n\t\t\t}\n\t\t\tlet doneItems:any;\t\t\t\n\t\t\tlet checkedCount = checkedItems.length;\n\t\t\tif (checkedCount > 0) {\n\t\t\t\tlet cn:string, doneTop:any;\n\t\t\t\tif (checkable===true) {\n\t\t\t\t\tcn = 'border-top py-2';\n\t\t\t\t\tdoneTop = <div className=\"px-3 pt-2 small text-muted\">{checkedCount}项完成</div>;\n\t\t\t\t}\n\t\t\t\tdoneItems = <div className={cn}>\n\t\t\t\t\t{doneTop}\n\t\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v, checkable))}\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v, checkable))}\n\t\t\t\t{doneItems}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderCheckItem(v:CheckItem, checkable:boolean) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'ml-3 ';\n\t\tlet content: any;\n\t\tlet icon: string;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted ';\n\t\t\tcontent = <del>{text}</del>;\n\t\t\ticon = 'check-square';\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t\ticon = 'square-o';\n\t\t}\n\t\tif (checkable === true) {\n\t\t\treturn <div key={key} className=\"d-flex mx-3 my-0 align-items-center form-group form-check\">\n\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\t\tdefaultChecked={checked}\n\t\t\t\t\tdata-key={key} />\n\t\t\t\t<div className={'form-control-plaintext ' + cn}>{content}</div>\n\t\t\t</div>;\n\t\t}\n\t\telse {\n\t\t\treturn <div key={key} className=\"d-flex mx-3 my-0 align-items-center\">\n\t\t\t\t<FA name={icon} />\n\t\t\t\t<div className={'py-1 ' + cn}>{content}</div>\n\t\t\t</div>;\n\t\t}\n\t}\n\n\tprotected renderFrom = () => {\n\t\tlet {noteItem} = this.controller;\n\t\tif (!noteItem) return <div>noteItem undefined in renderFrom</div>;\n\t\tlet {owner, assigned, from, fromAssigned, $create, $update} = noteItem;\n\t\tlet contact:number, contactAssigned:string;\n\t\tif (from) {\n\t\t\tcontact = from as number;\n\t\t\tcontactAssigned = fromAssigned;\n\t\t}\n\t\telse {\n\t\t\tcontact = owner as number;\n\t\t\tcontactAssigned = assigned;\n\t\t}\n\t\tif (this.isMe(contact) === true) {\n\t\t\treturn this.renderEditTime();\n\t\t}\n\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <div className=\"d-flex\">\n\t\t\t\t<div className=\"pr-3\">\n\t\t\t\t\t<Image className=\"w-2-5c h-2-5c\" src={icon || '.user-o'} />\n\t\t\t\t</div>\n\t\t\t\t<div style={{lineHeight:'1.3'}}>\n\t\t\t\t\t<div><b className=\"small font-weight-bolder\">{assigned || nick || name}</b></div>\n\t\t\t\t\t<div>{this.renderEditTime()}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n\n\tprotected renderEditTime() {\n\t\tlet {$create, $update} = this.controller.noteItem;\n\t\tlet create:Date = $create;\n\t\tlet update:Date = $update;\n\t\tif (create && update) {\n\t\t\tlet time:Date, action:any;\n\t\t\tif (update.getTime() - create.getTime() > 60*1000) {\n\t\t\t\taction = <FA className=\"mr-1\" name=\"pencil\" />;\n\t\t\t\ttime = update;\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttime = create;\n\t\t\t}\n\t\t\treturn <small className=\"text-muted\">\n\t\t\t\t<span className=\"mr-2\"><EasyTime date={time} /></span>\n\t\t\t\t{action}\n\t\t\t</small>\n\t\t}\n\t}\n\n\tprotected renderToCount = () => {\n\t\tlet {toCount} = this.controller;\n\t\tif (toCount === undefined || toCount <= 0)\n\t\t\treturn;\n\t\treturn <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"share\"/><small className=\"\">{toCount}</small> \n\t\t</span>;\n\t}\n\n\tprotected renderSpawnCount = () => {\n\t\tlet {spawnCount} = this.controller;\n\t\tif (spawnCount === undefined || spawnCount <= 0)\n\t\t\treturn;\n\t\treturn  <span className=\"mr-5 text-muted\">\n\t\t\t<FA className=\"mr-2\" name=\"hand-pointer-o\"/><small className=\"\">{spawnCount}</small>\n\t\t</span>;\n\t}\n\n\tprotected showActionEndPage({content, onClick}:{content:any; onClick?:()=>void}) {\n\t\tthis.openPage(() => {\n\t\t\tonClick = onClick || (()=>this.closePage());\n\t\t\tlet {title} = this.controller;\n\t\t\treturn <Page header={title} back=\"close\">\n\t\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t\t{content}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={onClick}>返回</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Page>;\n\t\t});\n\t}\n\n\tprotected renderSendToButton() {\n\t\treturn <span onClick={this.onSendNote} className=\"cursor-pointer text-primary mr-5\">\n\t\t\t<FA name=\"share\" />\n\t\t</span>;\n\t}\n\n\tprivate onSendNote = async () => {\n\t\tawait this.controller.cApp.loadRelation();\n\t\tthis.controller.showTo(2);\n\t}\n\n\tprotected renderEditButton() {\n\t\treturn <span onClick={()=>this.onEdit()} className=\"cursor-pointer text-primary mr-3\">\n\t\t\t<FA name=\"pencil-square-o\" />\n\t\t</span>;\n\t}\n\n\tprotected onEdit() {}\n\n\tprotected renderCommentButton() {\n\t\treturn <span className=\"cursor-pointer text-primary mr-5\" onClick={this.onComment}><FA name=\"comment-o\" /></span>;\n\t}\n\n\tprivate onComment = () => {\n\t\tlet right = <button className=\"btn btn-sm btn-success mr-1\" onClick={this.onCommentSubmit}>提交</button>;\n\t\tthis.openPageElement(<Page header=\"说明\" right={right}>\n\t\t\t<textarea rows={10} \n\t\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\t\tplaceholder=\"请输入\" maxLength={20000}\n\t\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\t\tonChange={this.onCommentChange} />\n\t\t</Page>);\n\t}\n\tprivate comment:string;\n\tprivate onCommentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.comment = evt.target.value;\n\t}\n\n\tprivate onCommentSubmit = async () => {\n\t\tawait this.controller.AddComment(this.comment);\n\t\tthis.closePage();\n\t}\n}\n","import React from 'react';\nimport { EasyTime, LMR, List, User, Image, UserView } from \"tonva\";\nimport { CNoteItem } from \"./CNoteItem\";\nimport { observable } from 'mobx';\nimport { NoteItem, CommentItem } from 'note/model';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from './VNoteBase';\n\nexport type RelativeKey = 'comment'|'to'|'flow'|'spawn'|'contain';\nexport interface Relative {\n\tcaption: string;\n\trender: () => JSX.Element;\n}\n\nexport class VRelatives<T extends CNoteItem> extends VNoteBase<T> {\n\tprotected renderComments = () => {\n\t\tlet {comments} = this.controller.noteModel;\n\t\tif (comments.length === 0) return;\n\t\treturn <div className=\"py-3\">{\n\t\t\tcomments.map(v => this.renderComment(v))\n\t\t}</div>;\n\t}\n\n\tprotected renderTo = () => {\n\t\tlet {to} = this.controller.noteModel;\n\t\tif (!to || to.length === 0) return;\n\t\treturn <div className=\"px-3 py-2\">\n\t\t\t<small className=\"text-muted mr-3\">已分享给: </small>\n\t\t\t{to.map((t, index) => {\n\t\t\t\tlet {user, assigned} = t;\n\t\t\t\treturn <span key={index} className=\"mr-3\">{this.renderContact(user, assigned)}</span>;\n\t\t\t})}\n\t\t</div>\n\t}\n\n\tprotected renderFlow = () => {\n\t\tlet {flow} = this.controller.noteModel;\n\t\tif (!flow || flow.length === 0) return;\n\t\treturn <div>flow: {flow.length}</div>\n\t}\n\n\tprivate renderSpawnItem = (item:NoteItem, index:number):JSX.Element => {\n\t\tlet {caption, $create, $update, owner, assigned} = item;\n\t\tlet divOwner = this.renderContact(owner as number, assigned);\n\t\tlet right = <small className=\"text-muted\"><EasyTime date={$update} /></small>;\n\t\treturn <div className=\"px-3 py-2 d-block bg-white\">\n\t\t\t<LMR right={right}>\n\t\t\t\t<span className=\"mr-3\">{divOwner}</span>{caption}\n\t\t\t</LMR>\n\t\t</div>;\n\t}\n\n\tprotected renderSpawn = () => {\n\t\tlet {spawn} = this.controller.noteModel;\n\t\tif (!spawn || spawn.length === 0) return;\n\t\treturn <List\n\t\t\titems={spawn} \n\t\t\titem={{render: this.renderSpawnItem,  className: \"notes\"}} />\n\t}\n\n\tprotected renderContain = () => {\n\t\tlet {contain} = this.controller.noteModel;\n\t\tif (!contain || contain.length === 0) return;\n\t\treturn <div>contain: {contain.length}</div>\n\t}\n\n\tprotected renderContact = (userId:number, assigned:string) => {\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mr-2\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</>\n\t\t}\n\t\treturn <UserView user={userId as number} render={renderUser} />;\n\t}\n\n\tprotected tabs:{[key in RelativeKey]:Relative} = {\n\t\t'comment': {caption: '评论', render: this.renderComments},\n\t\t'to': {caption: '分享', render: this.renderTo},\n\t\t'flow': {caption: '流程', render: this.renderFlow},\n\t\t'spawn': {caption: '派生', render: this.renderSpawn},\n\t\t'contain': {caption: '包含', render: this.renderContain},\n\t}\n\tprotected arr:RelativeKey[] = ['comment', 'to', 'flow', 'spawn', 'contain'];\n\t@observable protected relativeCur: RelativeKey = 'comment';\n\trender():JSX.Element {\n\t\tlet render = observer(() => {\n\t\t\treturn <div className=\"bg-white\">\n\t\t\t\t<div className=\"d-flex px-3 pt-3 border-bottom\">\n\t\t\t\t\t{this.arr.map(v => {\n\t\t\t\t\t\tlet {caption} = this.tabs[v];\n\t\t\t\t\t\tlet cn:string;\n\t\t\t\t\t\tif (v === this.relativeCur) {\n\t\t\t\t\t\t\tcn = ' bg-white border-left border-top border-right';\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tcn = ' bg-light text-muted';\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn <div key={v} className={'px-3 py-2 cursor-pointer' + cn} onClick={()=>this.relativeCur = v}>\n\t\t\t\t\t\t\t{caption}\n\t\t\t\t\t\t</div>;\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-3\">\n\t\t\t\t\t{this.tabs[this.relativeCur].render() || <small className=\"px-3 text-muted\">[无]</small>}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t});\n\t\treturn React.createElement(render);\n\t}\n\n\tprotected renderComment(comment:CommentItem) {\n\t\tlet {id, owner, assigned, content, $update} = comment;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {id, name, nick, icon} = user;\n\t\t\tlet isMe = this.isMe(id);\n\t\t\tlet divUserName:any;\n\t\t\tif (isMe === true) {\n\t\t\t\tdivUserName = <span className=\"text-success\">[自己]</span>\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdivUserName = assigned || nick || name;\n\t\t\t}\n\t\t\treturn <div className=\"mt-1 d-flex bg-white pt-2\">\n\t\t\t\t<Image className=\"w-1-5c h-1-5c mx-3\" src={icon || '.user-o'} />\n\t\t\t\t<div className=\"mr-3\">\n\t\t\t\t\t<div className=\"small mb-3\">{divUserName}</div>\n\t\t\t\t\t<div className=\"mt-2\">{this.renderParagraphs(content)}</div>\n\t\t\t\t\t<div className=\"py-1 small text-muted\"><EasyTime date={$update} /></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView key={id} user={owner} render={renderUser} />;\n\t}\n}\n","import React from 'react';\nimport { VNoteBase } from \"./VNoteBase\";\nimport { CNoteItem } from \"./CNoteItem\";\nimport { VRelatives } from './VRelatives';\n\nexport class VNoteView<T extends CNoteItem> extends VNoteBase<T> {\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VRelatives);\n\t}\n}","import React from 'react';\nimport { VNoteView } from '../item';\nimport { FA } from 'tonva';\nimport { CNoteItem } from './CNoteItem';\nimport { observer } from 'mobx-react';\n\nexport class VNoteItem<T extends CNoteItem> extends VNoteView<T> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {caption} = this.controller.noteItem;\n\t\t\tlet divToCount = this.renderToCount();\n\t\t\tlet divspawnCount = this.renderSpawnCount();\n\n\t\t\treturn <div className=\"d-block bg-white\">\n\t\t\t\t{this.renderTop()}\n\t\t\t\t{caption && <div className=\"px-3 py-2\"><b>{caption}</b></div>}\n\t\t\t\t{this.renderItemContent()}\n\t\t\t\t{\n\t\t\t\t\t(divToCount || divspawnCount) &&\n\t\t\t\t\t\t<div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t\t\t\t{divToCount}\n\t\t\t\t\t\t\t{divspawnCount}\n\t\t\t\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>;\n\t\t}));\n\t}\n}\n","import { observable } from \"mobx\";\nimport { NoteItem, NoteModel, EnumNoteItemType } from '../model';\nimport { CNote } from '../CNote';\nimport { CUqSub } from '../../tapp';\nimport { VNoteItem } from './VNoteItem';\n\nexport interface CheckItem {\n\tkey: number;\n\ttext: string;\n\tchecked?: boolean;\n}\n\nexport abstract class CNoteItem extends CUqSub<CNote> {\n\t@observable noteModel: NoteModel;\n\t@observable noteItem: NoteItem;\n\t@observable toCount: number;\n\t@observable spawnCount: number;\n\n\tinit(param: NoteItem): void {\n\t\tthis.noteItem = param;\n\t\tif (!param) return;\n\t\tthis.title = param.caption;\n\t\tthis.toCount = param.toCount;\n\t\tthis.spawnCount = param.spawnCount;\n\t\tlet { obj } = param;\n\t\tif (obj) {\n\t\t\tthis.checkType = Number(obj.check);\n\t\t\tif (this.checkType === 0 || this.checkType === 3) {\n\t\t\t\tthis.noteContent = obj.content;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tthis.items.splice(0, this.items.length);\n\t\t\t\tthis.itemKey = obj.itemKey;\n\t\t\t\tthis.items.push(...obj.items);\n\t\t\t}\n\t\t}\n\t}\n\n\t@observable title: string;\n\t@observable noteContent: string;\n\t@observable checkType: number = 0;\n\t@observable items: CheckItem[] = [];\n\t@observable changedNoteContent: string;\n\titemKey: number = 1;\n\n\tprotected async internalStart() { }\n\n\taddItem(value: string): boolean {\n\t\tif (this.checkType === 1) {\n\t\t\tthis.items.push({\n\t\t\t\tkey: this.itemKey++,\n\t\t\t\ttext: value,\n\t\t\t\tchecked: false,\n\t\t\t});\n\t\t}\n\t\telse if (this.checkType === 2) {\n\t\t\tthis.items.push({\n\t\t\t\tkey: this.itemKey++,\n\t\t\t\ttext: value,\n\t\t\t});\n\t\t}\n\t\treturn false;\n\t}\n\n\trenderItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VNoteItem(this);\n\t\treturn vNoteItem.render();\n\t}\n\n\tabstract onClickItem(noteModel: NoteModel): void;\n\n\tprotected stringifyContent() {\n\t\tlet ret = JSON.stringify(this.buildObj());\n\t\treturn ret;\n\t}\n\n\tprotected buildObj(): any {\n\t\tlet obj = this.noteItem ? { ...this.noteItem.obj } : {};\n\t\tif (this.checkType === 0 || this.checkType === 3) {\n\t\t\tobj.check = this.checkType;\n\t\t\tobj.content = this.changedNoteContent || this.noteContent;\n\t\t\tdelete obj.itemKey;\n\t\t\tdelete obj.items;\n\t\t}\n\t\telse {\n\t\t\tobj.check = this.checkType;\n\t\t\tobj.itemKey = this.itemKey;\n\t\t\tobj.items = this.items;\n\t\t\tdelete obj.content;\n\t\t}\n\t\treturn obj;\n\t}\n\n\t// convertObj 可以在不同的继承中被重载\n\tconvertObj(item: NoteItem): NoteItem {\n\t\titem.obj = this.parseContent(item.content);\n\t\treturn item;\n\t}\n\n\tprotected parseContent(content: string): any {\n\t\ttry {\n\t\t\tif (!content) return undefined;\n\t\t\treturn JSON.parse(content);\n\t\t}\n\t\tcatch (err) {\n\t\t\tconsole.error(err);\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tshowTo(backPageCount: number) {\n\t\tthis.owner.showTo(this.noteItem, backPageCount);\n\t}\n\n\tonCheckableChanged(type: number) {\n\t\tlet oldType = this.checkType;\n\t\tthis.checkType = type;\n\t\tif (oldType === 0) {\n\t\t\tlet content = this.changedNoteContent || this.noteContent;\n\t\t\tif (content) {\n\t\t\t\tthis.items.splice(0, this.items.length);\n\t\t\t\tthis.items.push(...content.split('\\n').map((v, index) => {\n\t\t\t\t\tif (this.checkType === 1) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\t\t\ttext: v,\n\t\t\t\t\t\t\tchecked: false\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tkey: this.itemKey++,\n\t\t\t\t\t\t\ttext: v,\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tif (this.checkType === 0 || this.checkType === 3) {\n\t\t\t\tthis.noteContent = this.items.map(v => v.text).join('\\n');\n\t\t\t}\n\t\t\telse if (this.checkType === 1) {\n\t\t\t\tthis.items.map(v => v.checked = false);\n\t\t\t}\n\t\t\telse if (this.checkType === 2) {\n\t\t\t\tthis.items.map(v => delete v.checked);\n\t\t\t}\n\t\t}\n\t\tthis.changedNoteContent = undefined;\n\t}\n\n\tasync onCheckChange(key: number, checked: boolean) {\n\t\tlet item = this.items.find(v => v.key === key);\n\t\tif (item) item.checked = checked;\n\t\tawait this.SetNote(false);\n\t}\n\n\tasync SetNote(waiting: boolean) {\n\t\tlet noteContent = this.stringifyContent();\n\t\tawait this.owner.setNote(waiting,\n\t\t\tthis.noteItem,\n\t\t\tthis.title,\n\t\t\tnoteContent,\n\t\t\tthis.buildObj());\n\t\tthis.updateChange();\n\t}\n\n\tprivate updateChange() {\n\t\tif (this.changedNoteContent) {\n\t\t\tthis.noteContent = this.changedNoteContent;\n\t\t\tthis.changedNoteContent = undefined;\n\t\t}\n\t\tif (this.noteItem) {\n\t\t\tthis.noteItem.$update = new Date();\n\t\t\tif (this.title && this.title !== this.noteItem.caption) {\n\t\t\t\tthis.noteItem.caption = this.title;\n\t\t\t}\n\t\t}\n\t}\n\n\tasync AddNote(parent: number) {\n\t\tlet noteContent = this.stringifyContent();\n\t\tlet type = this.checkType === 3 ? EnumNoteItemType.folder : EnumNoteItemType.text;\n\t\tlet ret = await this.owner.addNote(parent, this.title, noteContent, this.buildObj(), type);\n\t\tthis.updateChange();\n\t\treturn ret;\n\t}\n\n\tasync AddComment(content: string) {\n\t\tlet ret = await this.uqs.notes.AddComment.submit({ note: this.noteModel.id, content });\n\t\tlet commentId = ret.comment;\n\t\t// 加入note界面，显示comment\n\t\tif (commentId) {\n\t\t\tthis.noteModel.comments.unshift({\n\t\t\t\tid: commentId,\n\t\t\t\tcontent: content,\n\t\t\t\towner: this.user.id,\n\t\t\t\tassigned: undefined,\n\t\t\t\t$create: new Date(),\n\t\t\t\t$update: new Date(),\n\t\t\t});\n\t\t}\n\t}\n}\n","import React from \"react\";\nimport { Controller, View, FA } from \"tonva\";\nimport { observable, computed } from \"mobx\";\nimport { observer } from \"mobx-react\";\nimport { isNullOrUndefinedOrEmpty } from \"tool\";\n\nexport interface ItemInputProps {\n\tonUpdate: (inputContent: string) => Promise<void>;\n\tcontent: string;\n\tplaceholder?: string;\n}\n\nexport class VItemInput<T extends Controller> extends View<T> {\n\t@observable protected isFocused: boolean = false;\n\t@observable protected inputContent: string;\n\t@computed get content() {\n\t\tlet content: any = this.inputContent;\n\t\tif (isNullOrUndefinedOrEmpty(content) && this.props.placeholder) {\n\t\t\tcontent = <small className=\"text-muted\">{this.props.placeholder}</small>;\n\t\t}\n\n\t\treturn content;\n\t}\n\tprivate props: ItemInputProps;\n\n\trender(props: ItemInputProps): JSX.Element {\n\t\tthis.props = props;\n\t\tthis.inputContent = props.content;\n\t\treturn React.createElement(observer(() => this.isFocused === true ?\n\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\ttype=\"text\"\n\t\t\t\tref={this.inputRef}\n\t\t\t\tonBlur={this.onBlur}\n\t\t\t\tonKeyDown={this.onKeyDown} onChange={this.onInputChange} />\n\t\t\t:\n\t\t\t<div className=\"cursor-pointer flex-fill border-0 py-2\"\n\t\t\t\tonClick={() => this.isFocused = true}>\n\t\t\t\t{this.content}\n\t\t\t</div>\n\t\t));\n\t}\n\n\tprotected input: HTMLInputElement;\n\tprotected lostFocusTimeoutHandler: NodeJS.Timeout;\n\tprotected onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.onUpdateAction();\n\t\t}\n\t}\n\tprotected onBlur = (evt: React.FocusEvent<HTMLInputElement>) => {\n\t\tthis.lostFocusTimeoutHandler = setTimeout(() => {\n\t\t\tthis.lostFocusTimeoutHandler = undefined;\n\t\t\tthis.isFocused = false;\n\t\t}, 200);\n\t\tif (this.inputContent !== this.props.content && this.props?.onUpdate) {\n\t\t\tthis.props.onUpdate(this.inputContent);\n\t\t}\n\t}\n\tprotected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.inputContent = this.input.value.trim();\n\t}\n\tprotected inputRef = (input: any) => {\n\t\tif (!input) return;\n\t\tif (window.getComputedStyle(input).visibility === 'hidden') return;\n\t\tthis.input = input;\n\t\tthis.input.focus();\n\t\tif (this.inputContent) this.input.value = this.inputContent;\n\t}\n\n\tprotected onUpdateAction = async () => {\n\t\tclearTimeout(this.lostFocusTimeoutHandler);\n\t\tif (!this.input) return;\n\t\tif (!this.inputContent) return;\n\t\tthis.input.disabled = true;\n\t\tif (this.inputContent !== this.props.content && this.props?.onUpdate) {\n\t\t\tthis.props.onUpdate(this.inputContent);\n\t\t}\n\t\tthis.input.disabled = false;\n\t\tthis.isFocused = false;\n\t}\n}\n","import { CNoteItem, CheckItem } from \"../item\";\nimport { NoteItem, NoteModel, numberFromId } from '../model';\nimport { VTaskParams } from \"./VTaskParams\";\nimport { Contact } from \"model\";\nimport { TaskViewFactory, VCheckTask, VRateTask } from \"./state\";\nimport { observable } from \"mobx\";\nimport { threadId } from \"worker_threads\";\n\nexport interface AssignTaskParam {\n\tcontacts: Contact[];\n\tchecker: Contact;\n\trater: Contact;\n\tpoint?: number;\n}\n\nexport interface TaskCheckItem extends CheckItem {\n\tcheckInfo?: string;\n\trateInfo?: string;\n}\n\nexport enum EnumTaskState { Start = 0, Done = 1, Pass = 2, Fail = 3, Rated = 4, Canceled = 5 };\n\nexport class CTaskNoteItem extends CNoteItem {\n\tprivate getTaskView = new TaskViewFactory().getView;\n\n\t@observable checkInfo: string;\n\t@observable rateInfo: string;\n\n\tprotected checkInfoInput: string;\n\tprotected rateInfoInput: string;\n\tprotected rateValue: number;\n\tprotected rateValueInput: number;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tif (!param)\n\t\t\treturn;\n\t\tlet {obj} = param;\n\t\tif (obj) {\n\t\t\tthis.checkInfo = obj.checkInfo;\n\t\t\tthis.checkInfoInput = this.checkInfo;\n\t\t\tthis.rateInfo = obj.rateInfo;\n\t\t\tthis.rateInfoInput = this.rateInfo;\n\t\t\tthis.rateValue = obj.rateValue;\n\t\t\tthis.rateValueInput = this.rateValue;\n\t\t}\n\t}\n\n\tprotected buildObj():any {\n\t\tlet obj = super.buildObj();\n\t\tif (this.checkInfo) {\n\t\t\tobj.checkInfo = this.checkInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.checkInfo;\n\t\t}\n\t\tif (this.rateInfo) {\n\t\t\tobj.rateInfo = this.rateInfo;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateInfo;\n\t\t}\n\t\tif (this.rateValue !== undefined) {\n\t\t\tobj.rateValue = this.rateValue;\n\t\t}\n\t\telse {\n\t\t\tdelete obj.rateValue;\n\t\t}\n\n\t\treturn obj;\n\t}\n\n\tupdateCheckInfo(v:string) {\n\t\tthis.checkInfoInput = v;\n\t}\n\n\tupdateRateInfo(v:string) {\n\t\tthis.rateInfoInput = v;\n\t}\n\n\tconvertObj(item: NoteItem): NoteItem {\n\t\tlet content = item.flowContent;\n\t\tif (!content) {\n\t\t\tcontent = item.content;\n\t\t}\n\t\titem.obj = this.parseContent(content);\n\t\treturn item;\n\t}\n\n\tprivate getView() {\n\t\tlet state = this.noteItem.state as EnumTaskState;\n\t\tif (state == EnumTaskState.Done) {\n\t\t\tif (this.noteItem.obj && this.isMe(this.noteItem.obj.checker)) {\n\t\t\t\treturn VCheckTask;\n\t\t\t}\n\t\t}\n\t\telse if (state == EnumTaskState.Pass) {\n\t\t\tif (this.noteItem.obj && this.isMe(this.noteItem.obj.rater)) {\n\t\t\t\treturn VRateTask;\n\t\t\t}\n\t\t}\n\n\t\treturn this.getTaskView(state);\n\t}\n\n\trenderItem(index: number): JSX.Element {\n\t\tlet TaskView = this.getTaskView(this.noteItem.state as EnumTaskState);\n\t\tlet v = new TaskView(this);\n\t\treturn v.renderListItem();\n\t}\n\n\trenderBaseItem(index: number): JSX.Element {\n\t\treturn super.renderItem(index);\n\t}\n\n\tonClickItem(noteModel: NoteModel) {\n\t\tlet TaskView = this.getView();\n\t\tthis.openVPage(TaskView);\n\t}\n\n\tshowAssignTaskPage() {\n\t\tthis.openVPage(VTaskParams, { contacts: this.owner.contacts }, () => this.closePage());\n\t}\n\n\tasync assignTask(param: AssignTaskParam) {\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet { contacts, checker, rater, point } = param;\n\t\tlet note: NoteModel = await this.uqs.notes.Note.assureBox(noteId);\n\t\tlet { caption, content } = note;\n\t\tlet cObj = JSON.parse(content);\n\t\tif (checker) {\n\t\t\tcObj.checker = numberFromId(checker.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.checker;\n\t\t}\n\t\tif (rater) {\n\t\t\tcObj.rater = numberFromId(rater.contact);\n\t\t}\n\t\telse {\n\t\t\tdelete cObj.rater;\n\t\t}\n\t\tlet data = {\n\t\t\tnote: numberFromId(noteId),\n\t\t\tcaption,\n\t\t\tcontent: JSON.stringify(cObj),\n\t\t\ttos: contacts.map(v => { return { to: v.contact } }),\n\t\t\tchecker: checker?.contact,\n\t\t\trater: rater?.contact,\n\t\t\tpoint,\n\t\t}\n\t\tawait this.uqs.notes.AssignTask.submit(data);\n\t}\n\n\tasync DoneTask() {\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet note: NoteModel = await this.uqs.notes.Note.assureBox(noteId);\n\t\tlet { content } = note;\n\t\tlet data = {\n\t\t\tnote: numberFromId(noteId),\n\t\t\tcontent: content\n\t\t}\n\n\t\tlet ret = await this.uqs.notes.DoneTask.submit(data);\n\t\tthis.noteItem.state = Number(EnumTaskState.Done);\n\t}\n\n\tasync CheckSaveInfo() {\n\t\tlet change = false;\n\t\tif (this.rateInfo !== this.rateInfoInput) {\n\t\t\tthis.rateInfo = this.rateInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.checkInfo !== this.checkInfoInput) {\n\t\t\tthis.checkInfo = this.checkInfoInput;\n\t\t\tchange = true;\n\t\t}\n\t\tif (this.rateValue !== this.rateValueInput) {\n\t\t\tthis.rateValue = this.rateValueInput;\n\t\t\tchange = true;\n\t\t}\n\n\t\tif (change) {\n\t\t\tawait this.SaveX();\n\t\t}\n\t}\n\n\tasync CheckTask(pass: boolean) {\n\t\tawait this.CheckSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet content = this.stringifyContent();\n\t\tlet data = {\n\t\t\tnote: numberFromId(noteId),\n\t\t\taction: pass ? 1 : 2,\n\t\t\tcontent: content\n\t\t}\n\n\t\tlet ret = await this.uqs.notes.CheckTask.submit(data);\n\t\tthis.noteItem.state = Number(pass ? EnumTaskState.Pass : EnumTaskState.Fail);\n\t}\n\n\tasync RateTask(value: number) {\n\t\tthis.rateValueInput = value;\n\t\tawait this.CheckSaveInfo();\n\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet content = this.stringifyContent();\n\t\tlet data = {\n\t\t\tnote: numberFromId(noteId),\n\t\t\tvalue: value,\n\t\t\tcontent: content\n\t\t}\n\n\t\tlet ret = await this.uqs.notes.RateTask.submit(data);\n\t\tthis.noteItem.state = Number(EnumTaskState.Rated);\n\t}\n\n\tasync setCheckInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.checkInfo;\n\t\t}\n\t\telse {\n\t\t\titem.checkInfo = v;\n\t\t}\n\t\tawait this.SaveX();\n\t}\n\n\tasync setRateInfo(item: TaskCheckItem, v:string) {\n\t\tif (v === undefined || v.length === 0) {\n\t\t\tdelete item.rateInfo;\n\t\t}\n\t\telse {\n\t\t\titem.rateInfo = v;\n\t\t}\n\t\tawait this.SaveX();\n\t}\n\n\tprotected async SaveX() {\n\t\tlet { note: noteId } = this.noteItem;\n\t\tlet flowContent = this.stringifyContent();\n\t\tlet param = { note: noteId, content: flowContent };\n\t\tawait this.uqs.notes.SetNoteX.submit(param, false);\n\t}\n}\n","// 在js里面，这是不需要的\n// if (s), s 基本上就跟下面的判断等同\nexport function isNullOrUndefinedOrEmpty(str: string) {\n  return str === undefined || str === null || str.length === 0 || str.trim().length === 0;\n}","import React from 'react';\nimport { computed, observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VNoteView, CheckItem } from '.';\nimport { FA, ConfirmOptions } from 'tonva';\nimport { CNoteItem } from './CNoteItem';\nimport { VItemInput, ItemInputProps } from './VItemInput';\n\nexport abstract class VNoteForm<T extends CNoteItem> extends VNoteView<T> {\n\t@observable private changed: boolean = false;\n\tprivate inputAdd: HTMLInputElement;\n\n\theader() {return this.t('notes')}\n\n\tprotected onTitleChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.controller.title = evt.target.value.trim();\n\t}\n\n\tprotected onContentChange = (evt:React.ChangeEvent<HTMLTextAreaElement>) => {\n\t\tthis.controller.changedNoteContent = evt.target.value;\n\t}\n\n\t@computed protected get btnSaveDisabled():boolean {\n\t\tif (this.changed === true) return false;\n\t\treturn this.getSaveDisabled();\n\t}\n\n\tprotected abstract getSaveDisabled():boolean;\n\n\tprotected abstract onButtonSave(): Promise<void>;\n\n\tprotected async onDelete(): Promise<void> {\n\t\tlet options: ConfirmOptions = {\n\t\t\tcaption: '请确认',\n\t\t\tmessage: '真的要删除这个小单吗？',\n\t\t\tyes: '确认删除',\n\t\t\tno: '不删除'\n\t\t};\n\t\tif (await this.controller.confirm(options) === 'yes') {\n\t\t\tawait this.controller.owner.hideNote(this.controller.noteItem.note, 1);\n\t\t\tthis.closePage(2);\n\t\t}\n\t}\n\n\tprivate onCheckableChanged = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.changed = true;\n\t\tthis.controller.onCheckableChanged(Number(evt.target.value));\n\t}\n\n\tprotected renderDeleteButton() {\n\t\treturn <button className=\"btn btn-outline-secondary mr-3\" onClick={() => this.onDelete()}>\n\t\t\t删除\n\t\t</button>;\n\t}\n\n\tprotected abstract renderExButtons():JSX.Element;\n\n\tprotected getOptions(): {val:number, text:string}[] {\n\t\treturn [\n\t\t\t{ val: 0, text: '文字' },\n\t\t\t{ val: 2, text: '列表' },\n\t\t\t{ val: 1, text: '勾选事项' },\n\t\t];\n\t}\n\n\tprotected renderEdit() {\n\t\tlet radios = this.getOptions();\n\n\t\treturn <div className=\"m-2\">\n\t\t\t<div className=\"border rounded\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t<div className=\"py-1 px-1 border-bottom\">\n\t\t\t\t\t\t<input type=\"text\" className=\"w-100 border-0 form-control font-weight-bold\" placeholder=\"标题\" maxLength={80}\n\t\t\t\t\t\t\tonChange={this.onTitleChange}\n\t\t\t\t\t\t\tdefaultValue={this.controller.title} />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"py-1 px-1\">\n\t\t\t\t\t\t{React.createElement(observer(() => this.controller.checkType === 0 || this.controller.checkType === 3? \n\t\t\t\t\t\t\tthis.renderContentTextArea()\n\t\t\t\t\t\t\t: this.controller.checkType === 1 ? this.renderContentCheckList(): this.renderContentEditList()))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-2 pl-3 bg-light border-top d-flex\">\n\t\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t\t{React.createElement(observer(() => <>\n\t\t\t\t\t\t<button onClick={() => this.onButtonSave()}\n\t\t\t\t\t\t\tclassName=\"btn btn-primary mr-3\" disabled={this.btnSaveDisabled}>\n\t\t\t\t\t\t\t保存\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</>))}\n\t\t\t\t\t{this.renderExButtons()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t{ radios &&\n\t\t\t\t<div className=\"m-2 form-group form-check\">\n\t\t\t\t\t{radios.map((v, index) => {\n\t\t\t\t\t\tlet { val, text } = v;\n\t\t\t\t\t\treturn <label key={index} className=\"mb-0 mx-2\">\n\t\t\t\t\t\t\t<input className=\"mr-1\" type=\"radio\" value={val}\n\t\t\t\t\t\t\t\tdefaultChecked={this.controller.checkType === val} name={'checktype'} onChange={this.onCheckableChanged} />\n\t\t\t\t\t\t\t{text}\n\t\t\t\t\t</label>\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tprivate renderContentTextArea() {\n\t\treturn <textarea rows={10} \n\t\t\tclassName=\"w-100 border-0 form-control\" \n\t\t\tplaceholder={this.t('notes')} maxLength={20000}\n\t\t\tdefaultValue={this.controller.noteContent}\n\t\t\tonChange={this.onContentChange} />;\n\t}\n\n\tprivate renderContentEditList() {\n\t\tlet items = this.controller.items;\n\t\treturn <>\n\t\t\t<ul className=\"note-content-list px-3\">\n\t\t\t{\n\t\t\t\titems.map((v, index) => {\n\t\t\t\t\tlet {key, text} = v;\n\t\t\t\t\tlet onItemUpdate = async (v:string) => {\n\t\t\t\t\t\tthis.onItemChanged(key, v);\n\t\t\t\t\t}\n\t\t\t\t\tlet param:ItemInputProps = {\n\t\t\t\t\t\tonUpdate: onItemUpdate,\n\t\t\t\t\t\tcontent: text,\n\t\t\t\t\t}\n\t\t\t\t\treturn <li key={key} className=\"ml-3 align-items-center\">\n\t\t\t\t\t\t{this.renderVm(VItemInput, param)}\n\t\t\t\t\t</li>\n\t\t\t\t})\n\t\t\t}\n\t\t\t</ul>\n\t\t\t<div className=\"d-flex mx-3 my-2 align-items-center\">\n\t\t\t\t<FA name=\"plus\" className=\"text-info mr-2\" />\n\t\t\t\t<input ref={t => this.inputAdd = t} className=\"flex-fill form-control\" type=\"text\" placeholder=\"新增\" onKeyDown={this.onAddEnter} />\n\t\t\t</div>\n\t\t</>;\n\t}\n\n\tprivate renderContentCheckList() {\n\t\tlet uncheckedItems:CheckItem[] = [];\n\t\tlet checkedItems:CheckItem[] = [];\n\t\tfor (let ci of this.controller.items) {\n\t\t\tlet {checked} = ci;\n\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\telse uncheckedItems.push(ci);\n\t\t}\n\t\treturn <div className=\"\">\n\t\t\t{\n\t\t\t\tuncheckedItems.map((v, index) => {\n\t\t\t\t\tlet {key, text, checked} = v;\n\t\t\t\t\tlet onItemUpdate = async (v:string) => {\n\t\t\t\t\t\tthis.onItemChanged(key, v);\n\t\t\t\t\t}\n\t\t\t\t\tlet param:ItemInputProps = {\n\t\t\t\t\t\tonUpdate: onItemUpdate,\n\t\t\t\t\t\tcontent: text,\n\t\t\t\t\t}\n\t\t\t\t\treturn <div key={key} className=\"d-flex mx-3 my-2 align-items-center form-group form-check\">\n\t\t\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\t\t\t\tdefaultChecked={checked}\n\t\t\t\t\t\t\tonChange={this.onCheckChange}\n\t\t\t\t\t\t\tdata-key={key} />\n\t\t\t\t\t\t{this.renderVm(VItemInput, param)}\n\t\t\t\t\t</div>\n\t\t\t\t})\n\t\t\t}\n\t\t\t<div className=\"d-flex mx-3 my-2 align-items-center\">\n\t\t\t\t<FA name=\"plus\" className=\"text-info mr-2\" />\n\t\t\t\t<input ref={t => this.inputAdd = t} className=\"flex-fill form-control\" type=\"text\" placeholder=\"新增\" onKeyDown={this.onAddEnter} />\n\t\t\t</div>\n\t\t\t{\n\t\t\t\tcheckedItems.length > 0 && <div className=\"border-top mt-2 py-2\">\n\t\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedItems.length}项完成</div>\n\t\t\t\t\t{checkedItems.map((v, index) => {\n\t\t\t\t\t\tlet {key, text, checked} = v;\n\t\t\t\t\t\treturn <div key={key} className=\"d-flex mx-3 my-2 align-items-center form-group form-check\">\n\t\t\t\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\" \n\t\t\t\t\t\t\t\tdefaultChecked={checked} \n\t\t\t\t\t\t\t\tonChange={this.onCheckChange} \n\t\t\t\t\t\t\t\tdata-key={key} />\n\t\t\t\t\t\t\t<div className=\"text-muted form-control-plaintext ml-3\"><del>{text}</del></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tprivate onAddEnter = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tlet {value} = evt.currentTarget;\n\t\t\tif (value.trim().length === 0) return;\n\t\t\tthis.controller.items.push({\n\t\t\t\tkey: this.controller.itemKey++,\n\t\t\t\ttext: value,\n\t\t\t\tchecked: false,\n\t\t\t});\n\t\t\tevt.currentTarget.value = '';\n\t\t}\n\t}\n\n\tprotected checkInputAdd() {\n\t\tlet {checkType} = this.controller;\n\t\tif ((checkType === 1 || checkType === 2) && this.inputAdd) {\n\t\t\tlet {value} = this.inputAdd;\n\t\t\tif (value.trim().length === 0) return;\n\t\t\tthis.controller.addItem(value);\n\t\t\tthis.inputAdd.value = '';\n\t\t}\n\t}\n\t\n\tprivate onCheckChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet t = evt.currentTarget;\n\t\tlet key = Number(t.getAttribute('data-key'));\n\t\tlet item = this.controller.items.find(v => v.key === key);\n\t\tif (item) item.checked = t.checked;\n\t}\n\n\tprivate onItemChanged = (key: number, value: string) => {\n\t\tlet item = this.controller.items.find(v => v.key === key);\n\t\tif (item) item.text = value;\n\t\tthis.changed = true;\n\t}\n\n\tprivate onItemChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet t = evt.currentTarget;\n\t\tlet key = Number(t.getAttribute('data-key'));\n\t\tlet item = this.controller.items.find(v => v.key === key);\n\t\tif (item) item.text = t.value;\n\t\tthis.changed = true;\n\t}\n\n\tprivate onItemKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tif (this.inputAdd) this.inputAdd.focus();\n\t\t}\n\t}\n}\n","import { tv } from \"tonva\";\nimport { VNoteForm } from '../item/VNoteForm';\nimport { CTextNoteItem } from \"./CTextNoteItem\";\n\nexport class VEdit extends VNoteForm<CTextNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\tcontent() {\n\t\treturn this.renderEdit();\n\t}\n\n\tprotected getSaveDisabled():boolean {\n\t\treturn (this.controller.title === undefined && this.controller.changedNoteContent === undefined);\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tthis.checkInputAdd();\n\t\tawait this.controller.SetNote(true);\n\t\tthis.closePage();\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn this.renderDeleteButton();\n\t}\n}\n","import React from 'react';\nimport { VEdit } from './VEdit';\nimport { observer } from 'mobx-react';\nimport { VNoteView, CheckItem } from '../item';\nimport { CTextNoteItem } from './CTextNoteItem';\n\nexport class VTextView extends VNoteView<CTextNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return this.t('notes')}\n\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {title} = this.controller;\n\t\t\treturn <div className=\"\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t{this.renderTop()}\n\t\t\t\t\t{title && <div className=\"px-3 py-2 border-bottom\">\n\t\t\t\t\t\t<div><b>{title}</b></div>\n\t\t\t\t\t</div>}\n\t\t\t\t\t{this.renderContent()}\n\t\t\t\t</div>\n\t\t\t\t{this.renderBottomCommands()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderBottomCommands() {\n\t\tlet {owner} = this.controller.noteItem;\n\t\tlet isMe = this.isMe(owner);\n\t\tlet right:any;\n\t\tif (isMe === true) {\n\t\t\tright = <>\n\t\t\t\t{this.renderEditButton()}\t\t\t\t\n\t\t\t</>;\n\t\t}\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.renderSendToButton()}\n\t\t\t{this.renderCommentButton()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t}\n\n\tprotected onEdit() {\n\t\tthis.openVPage(VEdit);\n\t}\n\n\tprotected renderCheckItem(v:CheckItem, checkable:boolean) {\n\t\tlet {key, text, checked} = v;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"d-flex mx-3 my-0 align-items-center form-group form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tonChange={this.onCheckChange}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!checkable} />\n\t\t\t<div className={cn}>{content}</div>\n\t\t</label>;\n\t}\n/*\n\tprotected renderCheckItems() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet uncheckedItems:CheckItem[] = [];\n\t\t\tlet checkedItems:CheckItem[] = [];\n\t\t\tfor (let ci of this.controller.items) {\n\t\t\t\tlet {checked} = ci;\n\t\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\t\telse uncheckedItems.push(ci);\n\t\t\t}\t\t\t\n\t\t\treturn <div className=\"\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v, true))}\n\t\t\t\t{\n\t\t\t\t\tcheckedItems.length > 0 && <div className=\"border-top mt-2 py-2\">\n\t\t\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedItems.length}项完成</div>\n\t\t\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v, true))}\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>;\n\t\t}));\n\t}\n*/\n\tprivate onCheckChange = async (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet t = evt.currentTarget;\n\t\tlet key = Number(t.getAttribute('data-key'));\n\t\tawait this.controller.onCheckChange(key, t.checked);\n\t}\n}\n","import React from \"react\";\nimport { VNoteForm } from '../item/VNoteForm';\nimport { CTextNoteItem } from './CTextNoteItem';\nimport { NoteItem } from \"note/model\";\nimport { observer } from \"mobx-react\";\n\nexport class VAdd extends VNoteForm<CTextNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\tprotected parentId: number;\n\n\tinit(param?:any):void \n\t{\n\t\tsuper.init(param);\n\t\tthis.parentId = param;\n\t}\n\n\tcontent() {\n\t\treturn this.renderEdit();\n\t}\n\n\tprotected getOptions(): {val:number, text:string}[] {\n\t\treturn [\n\t\t\t{ val: 0, text: '文字' },\n\t\t\t{ val: 2, text: '列表' },\n\t\t\t{ val: 1, text: '勾选事项' },\n\t\t\t{ val: 3, text: '小单夹' },\n\t\t];\n\t}\n\n\tprotected getSaveDisabled():boolean {\n\t\tif (this.controller.title !== undefined) {\n\t\t\treturn this.controller.title.length === 0;\n\t\t}\n\t\tif (this.controller.changedNoteContent !== undefined) {\n\t\t\treturn this.controller.changedNoteContent.length === 0;\n\t\t}\n\t\treturn true;\n    }\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tawait this.controller.AddNote(this.parentId);\n\t\tthis.closePage();\n\t\treturn;\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn React.createElement(observer(() => {\n\t\t\tif (this.controller.checkType === 3)\n\t\t\t\treturn;\n\t\t\treturn this.renderSendToButton();\n\t\t}));\n\t}\n\n\tprotected renderSendToButton() {\n\t\treturn <button onClick={this.onSaveAndSendNote}\n\t\t\tclassName=\"btn btn-outline-primary mr-3\">\n\t\t\t发给\n\t\t</button>;\n\t}\n\n\tprivate onSaveAndSendNote = async () => {\n\t\tthis.checkInputAdd();\n\t\tlet cnewNote = await this.controller.AddNote(this.parentId);\n\t\tthis.closePage();\n\t\tawait cnewNote.cApp.loadRelation();\n\t\tcnewNote.showTo(1);\n\t}\n\n}\n","import { CNoteItem } from \"../item\";\nimport { NoteItem, NoteModel } from '../model';\nimport { VTextView } from './VTextView';\nimport { VAdd } from './VAdd';\n//import { VTextNoteItem } from './VTextNoteItem';\n\nexport class CTextNoteItem extends CNoteItem {\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tif (param) {\n\t\t\tif (!this.title) this.title = param.caption;\n\t\t}\n\t}\n\n\t// renderItem(index:number): JSX.Element {\n\t// \tlet vNoteItem = new VTextNoteItem(this);\n\t// \treturn vNoteItem.render();\n\t// }\n\n\tonClickItem(noteModel: NoteModel) {\n\t\tthis.openVPage(VTextView);\n\t}\n\n\tshowAddNotePage(parent: number) {\n\t\tthis.openVPage(VAdd, parent);\n\t}\n}\n","import React from 'react';\nimport { VBasePage } from \"./VBasePage\";\nimport { LMR, FA } from 'tonva';\nimport { CheckItem } from 'note/item';\n\nexport class VActions extends VBasePage {\n\tprotected backPageCount = 3;\n\n\tinit(param?:any):void {\n\t\tif (param) {\n\t\t\tthis.backPageCount = Number(param);\n\t\t}\t\n\t}\n\n\theader() {return '操作'}\n\tcontent() {\n\t\tlet {noteItem} = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tlet checkType = Number(obj?.check);\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mt-1';\n\t\treturn <div className=\"\">\n\t\t\t<div className=\"text-muted small px-3 py-1 mt-2\">收件人</div>\n\t\t\t<div className=\"border rounded p-3 mb-3\">\n\t\t\t\t{this.controller.contacts.map(c => {\n\t\t\t\t\tlet {contact, assigned} = c;\n\t\t\t\t\treturn <span className=\"mr-3\">{this.renderContact(contact, assigned)}</span>;\n\t\t\t\t})}\n\t\t\t</div>\n\t\t\t<div className={cn} onClick={this.onSend}>\n\t\t\t\t分享内容\n\t\t\t</div>\n\t\t\t{\n\t\t\t\t(checkType === 1) &&\n\t\t\t\t<div className={cn} onClick={this.onAssign}>\n\t\t\t\t\t<LMR right={<FA name=\"angle-right\" />}>\n\t\t\t\t\t\t分派任务\n\t\t\t\t\t</LMR>\n\t\t\t\t</div>\n\t\t\t}\n\t\t</div>;\n\t}\n\n\tprivate onSend = async () => {\n\t\tlet {contacts, noteItem} = this.controller;\n\t\tlet toList = contacts.map (v => {\n\t\t\tlet {contact} = v;\n\t\t\tif (!contact) return undefined;\n\t\t\tif (typeof contact === 'object') return (contact as any).id;\n\t\t\treturn contact;\n\t\t});\n\t\tawait this.controller.sendNoteTo(noteItem.note, toList);\n\t\tthis.closePage(this.backPageCount);\n\t\tthis.controller.showSentPage();\n\t}\n\n\tprivate onAssign = () => {\n\t\tthis.closePage();\n\t\tthis.controller.showAssignTaskPage();\n\t}\n}\n","import React from 'react';\nimport { observable } from 'mobx';\nimport { observer } from 'mobx-react';\nimport { VBasePage } from './VBasePage';\nimport { List, User, Image, UserView, FA } from 'tonva';\nimport { Contact } from 'model';\nimport { VActions } from './VActions';\n\nexport class VTo extends VBasePage {\n\tprotected backPageCount = 2;\n\n\tinit(param?:any):void {\n\t\tif (param) {\n\t\t\tthis.backPageCount = Number(param);\n\t\t}\t\n\t}\n\n\t@observable private anySelected:boolean = false;\n\tprivate list: List;\n\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\n\theader() {return '收件人'}\n\tright():any {\n\t\tlet c = observer(() => <button className=\"btn btn-sm btn-primary mr-1\" onClick={this.onNext} disabled={!this.anySelected}>\n\t\t\t下一步 <FA name=\"angle-right\" />\n\t\t</button>);\n\t\treturn React.createElement(c);\n\t}\n\tcontent() {\n\t\tlet items = this.controller.cApp.contacts;\n\t\treturn <div className=\"\">\n\t\t\t<List ref={v => this.list = v}\n\t\t\t\titems={items} \n\t\t\t\titem={{render:this.renderContactItem, onSelect:this.onContactSelect}} />\n\t\t</div>\n\t}\n\n/*\n\tprivate renderContact = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <div className=\"px-3 py-2\">\n\t\t\t\t<Image className=\"w-2c h-2c mr-3\" src={icon} />\n\t\t\t\t{name} {nick} {assigned}\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n*/\n\tprivate onContactSelect = (item:Contact, isSelected:boolean, anySelected:boolean):void => {\n\t\tthis.anySelected = anySelected;\n\t}\n\n\tprivate onNext = () => {\n\t\tlet contacts = this.list.selectedItems;\n\t\tthis.controller.contacts = contacts;\n\t\tthis.openVPage(VActions, this.backPageCount + 1); //, {contacts, noteId: this.currentNoteId});\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { observable } from 'mobx';\nimport { VPage, FA, UserView, Image, User } from \"tonva\";\nimport { CTaskNoteItem } from \"./CTaskNoteItem\";\nimport { Contact } from 'model';\nimport { SelectContactOptions } from 'note/views';\n\ninterface Param {\n\tlabel: string;\n\tvalues?: any;\n\tonClick?: () => void;\n}\n\nconst none = <small className=\"text-muted\">[无]</small>;\n\nexport class VTaskParams extends VPage<CTaskNoteItem> {\n\t@observable contacts: Contact[];\n\t@observable checker: Contact;\n\t@observable rater: Contact;\n\n\tprivate point:number = 100;\n\n\tinit(param:{contacts:Contact[]}) {\n\t\tlet {contacts} = param;\n\t\tthis.contacts = contacts;\n\t}\n\n\theader() {return '分派任务'}\n\tget back(): 'close'|'back'|'none' {return 'close';}\n\n\tprivate renderParam(param: Param) {\n\t\tlet {label, values, onClick} = param;\n\t\treturn <div key={label} className=\"px-3 py-2 bg-white d-flex cursor-pointer align-items-center border-bottom\" onClick={onClick}>\n\t\t\t<div className=\"text-muted mr-3 w-5c\">{label}</div>\n\t\t\t<div className=\"flex-fill mr-3 \">{values || none}</div>\n\t\t\t<FA className=\"ml-auto\" name=\"angle-right\" />\n\t\t</div>\n\t}\n\n\tcontent() {\n\t\tlet rows: Param[] = [\n\t\t\t{label: '执行人', values: this.renderContacts(), onClick: this.onClickContacts}, \n\t\t\t{label: '分值', values: this.renderPoint()}, \n\t\t\t{label: '检查人', values: this.renderChecker(), onClick: this.onClickChecker}, \n\t\t\t{label: '评价人', values: this.renderRater(), onClick: this.onClickRater}, \n\t\t];\n\t\tlet {owner} = this.controller;\n\t\treturn <div className=\"py-2\">\n\t\t\t{this.controller.renderBaseItem(0)}\n\t\t\t{rows.map(v => this.renderParam(v))}\n\t\t\t<div className=\"px-3 py-2\"><button className=\"btn btn-primary\" onClick={this.onSendTask}>发送</button></div>\n\t\t</div>;\n\t}\n\n\tprivate onSendTask = async () => {\n\t\tawait this.controller.assignTask({\n\t\t\tcontacts: this.contacts,\n\t\t\tchecker: this.checker,\n\t\t\trater: this.rater,\n\t\t\tpoint: this.point,\n\t\t});\n\t\tthis.closePage(2);\n\t\tthis.controller.owner.showSentPage();\n\t}\n\n\tprivate renderContact = (item:Contact, index?:number) => {\n\t\tif (!item) return none;\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <>\n\t\t\t\t<Image className=\"w-1c h-1c mr-1\" src={icon || '.user-o'} />\n\t\t\t\t<span className=\"mr-3\">{assigned || nick || name}</span>\n\t\t\t</>;\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n\n\tprivate renderContacts() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet contacts = this.contacts;\n\t\t\tif (!contacts || contacts.length === 0) return <small className=\"text-muted\">请选择</small>;\n\t\t\treturn <>{contacts.map((v, index) => {\n\t\t\t\treturn <React.Fragment key={index}>{this.renderContact(v, index)}</React.Fragment>;\n\t\t\t})}</>;\t\n\t\t}));\n\t}\n\n\tprivate onClickContacts = async () => {\n\t\tlet options: SelectContactOptions = undefined; // {title: 'a', action: 'b', single: true};\n\t\tlet contacts = await this.controller.owner.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.contacts = contacts;\n\t}\n\n\tprivate renderPoint() {\n\t\treturn <input className=\"flex-fill form-control border-0\"\n\t\t\t\ttype=\"number\" step=\"1\" min=\"1\" defaultValue={this.point}\n\t\t\t\tonChange={this.onItemChange}\n\t\t\t\tonKeyDown={this.onItemKeyDown}/>;\n\t}\n\n\tprivate onItemChange = (evt:React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.point = Number(evt.currentTarget.value);\n\t}\n\n\tprivate onItemKeyDown = (evt:React.KeyboardEvent<HTMLInputElement>) => {\n\t}\n\n\n\tprivate renderChecker() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.checker)));\n\t}\n\n\tprivate onClickChecker = async () => {\n\t\tlet options: SelectContactOptions = {title: '检查人', single: true};\n\t\tlet contacts = await this.controller.owner.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.checker = contacts[0];\n\n\t}\n\n\tprivate renderRater() {\n\t\treturn React.createElement(observer(() => this.renderContact(this.rater)));\n\t}\n\n\tprivate onClickRater = async () => {\n\t\tlet options: SelectContactOptions = {title: '评价人', single: true};\n\t\tlet contacts = await this.controller.owner.callSelectContact(options);\n\t\tthis.closePage();\n\t\tthis.rater = contacts[0];\n\t}\n}\n","import { tv } from \"tonva\";\nimport { VNoteForm } from '../item/VNoteForm';\nimport { CTaskNoteItem } from \"./CTaskNoteItem\";\n\nexport class VEdit extends VNoteForm<CTaskNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\tcontent() {\n\t\treturn this.renderEdit();\n\t}\n\n\tprotected getSaveDisabled():boolean {\n\t\treturn (this.controller.title === undefined && this.controller.changedNoteContent === undefined);\n\t}\n\n\tprotected async onButtonSave(): Promise<void> {\n\t\tthis.checkInputAdd();\n\t\tawait this.controller.SetNote(true);\n\t\tthis.closePage();\n\t}\n\n\tprotected renderExButtons():JSX.Element {\n\t\treturn;\n\t}\n}\n","import React from 'react';\nimport { observer } from 'mobx-react';\nimport { FA } from \"tonva\";\nimport { CTaskNoteItem, EnumTaskState } from \"../CTaskNoteItem\";\nimport { VNoteView, CheckItem } from '../../item';\nimport { VEdit } from '../VEdit';\n\nexport abstract class VTaskView extends VNoteView<CTaskNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' { return 'close' }\n\theader() { return '任务' }\n\tprotected get allowCheck() { return true; }\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet { title } = this.controller;\n\t\t\tlet allowCheck = this.allowCheck;\n\t\t\tlet divCaption = this.renderCaption(title);\n\t\t\treturn <div className=\"my-2 mx-1 border rounded\">\n\t\t\t\t{this.renderTop()}\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t<div className=\"px-3 py-2 border-bottom\">\n\t\t\t\t\t\t{divCaption}\n\t\t\t\t\t</div>\n\t\t\t\t\t{this.renderContent()}\n\t\t\t\t</div>\n\t\t\t\t{this.renderBottomCommands()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprivate renderCaption(title: string) {\n\t\tlet divCaption = title ? <b className=\"text-primary\">{title}</b> : <span className=\"text-info\">任务</span>;\n\t\treturn <><span className=\"mr-2\">{divCaption}</span> {this.renderState()}</>;\n\t}\n\n\tprotected renderBottomCommands() {\n\t\tlet { owner, state } = this.controller.noteItem;\n\t\tlet right: any;\n\t\tlet isMe = this.isMe(owner);\t\t\n\t\tif (isMe === true && state == EnumTaskState.Start) {\n\t\t\tright = <>{this.renderEditButton()}</>;\n\t\t}\n\t\treturn <div className=\"py-2 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.renderCommentButton()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t}\n/*\n\tprotected renderCheckItem(v: CheckItem, allowCheck: boolean) {\n\t\tlet { key, text, checked } = v;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <div key={key} className=\"d-flex mx-3 my-0 align-items-center form-group form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tonChange={this.onCheckChange}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!allowCheck} />\n\t\t\t<div className={cn}>{content}</div>\n\t\t</div>;\n\t}\n*/\n/*\n\tprotected renderCheckItems(allowCheck: boolean) {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet uncheckedItems: CheckItem[] = [];\n\t\t\tlet checkedItems: CheckItem[] = [];\n\t\t\tfor (let ci of this.controller.items) {\n\t\t\t\tlet { checked } = ci;\n\t\t\t\tif (checked === true) checkedItems.push(ci);\n\t\t\t\telse uncheckedItems.push(ci);\n\t\t\t}\n\t\t\treturn <div className=\"\">\n\t\t\t\t{uncheckedItems.map((v, index) => this.renderCheckItem(v, allowCheck))}\n\t\t\t\t{\n\t\t\t\t\tcheckedItems.length > 0 && <div className=\"border-top mt-2 py-2\">\n\t\t\t\t\t\t<div className=\"px-3 pt-2 small text-muted\">{checkedItems.length}项完成</div>\n\t\t\t\t\t\t{checkedItems.map((v, index) => this.renderCheckItem(v, allowCheck))}\n\t\t\t\t\t</div>\n\t\t\t\t}\n\t\t\t</div>;\n\t\t}));\n\t}\n*/\n\tprivate onCheckChange = async (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet t = evt.currentTarget;\n\t\tlet key = Number(t.getAttribute('data-key'));\n\t\tawait this.controller.onCheckChange(key, t.checked);\n\t}\n\n\tprotected renderState(): JSX.Element {\n\t\treturn <>state</>;\n\t}\n\n\tprotected renderStateSpan(content: string, isEnd: boolean = false) {\n\t\tif (isEnd === true) {\n\t\t\treturn <span className=\"small text-danger\"><FA className=\"small mr-1\" name=\"stop\" />{content}</span>;\n\t\t}\n\t\treturn <span className=\"small text-success border border-success rounded px-2\">{content}</span>;\n\t}\n\n\tprotected onEdit() {\n\t\tthis.openVPage(VEdit);\n\t}\n\n\trenderListItem() {\n\t\tlet { caption } = this.controller.noteItem;\n\t\tlet divCaption = this.renderCaption(caption);\n\t\treturn <div className=\"d-block bg-white\">\n\t\t\t{this.renderTop()}\n\t\t\t<div className=\"px-3 py-2\">\n\t\t\t\t{divCaption}\n\t\t\t</div>\n\t\t\t{this.renderItemContent()}\n\t\t</div>;\n\t}\n}\n\nclass VTaskStart extends VTaskView {\n\tprotected get allowCheck() { return this.isMe(this.controller.noteItem.owner); }\n\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待办');\n\t}\n\n\tprotected renderBottomCommands() {\n\t\tlet { owner } = this.controller.noteItem;\n\t\tlet left: any, right: any;\n\t\tlet isMe = this.isMe(owner);\n\t\tif (isMe === true) {\n\t\t\tleft = <button onClick={this.onDone} className=\"btn btn-primary mx-3\">\n\t\t\t\t完成\n\t\t\t</button>;\n\t\t\tright = <>{this.renderEditButton()}</>;\n\t\t}\n\t\treturn <div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t{left}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t}\n\n\tprivate onDone = async () => {\n\t\tawait this.controller.DoneTask();\n\t\tthis.closePage();\n\t\t//this.openPage(this.resultPage);\n\n\t\t// 这个地方应该要显示，下一步是由谁来做什么。比如谁来验收，或者谁来评价\n\t\t// 这些信息应该在nodeModel里面\n\t\t// 如果没有后续操作，显示成红色，加一个终止标志 #\n\t\t// 如果由后续操作，显示成绿色，并且显示下一步什么操作，由谁来操作\n\t\tlet content = <>任务完成</>;\n\t\tthis.showActionEndPage({ content });\n\t}\n\t/*\n\tprotected resultPage = () => {\n\t\tlet {title} = this.controller;\n\t\treturn <Page header={title} back=\"close\">\n\t\t\t\t完成！\n\t\t</Page>;\n\t}\n\t*/\n}\n\nclass VTaskDone extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { checker } = obj;\n\t\t\tif (checker) {\n\t\t\t\treturn this.renderStateSpan('待验收');\n\t\t\t}\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评分');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('已办', true);\n\t}\n}\n\nclass VTaskPass extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\tprotected renderState() {\n\t\tlet { noteItem } = this.controller;\n\t\tlet obj = noteItem.obj;\n\t\tif (obj) {\n\t\t\tlet { rater } = obj;\n\t\t\tif (rater) {\n\t\t\t\treturn this.renderStateSpan('待评价');\n\t\t\t}\n\t\t}\n\t\treturn this.renderStateSpan('已验收', true);\n\t}\n}\n\nclass VTaskFail extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('拒签', true);\n\t}\n}\n\nclass VTaskRated extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已评价', true);\n\t}\n}\n\nclass VTaskCanceled extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\tprotected renderState() {\n\t\treturn this.renderStateSpan('已取消', true);\n\t}\n}\n\nexport class TaskViewFactory {\n\tprivate stateViews: { [type in EnumTaskState]: new (controller: CTaskNoteItem) => VTaskView } = {\n\t\t[EnumTaskState.Start]: VTaskStart,\n\t\t[EnumTaskState.Done]: VTaskDone,\n\t\t[EnumTaskState.Pass]: VTaskPass,\n\t\t[EnumTaskState.Fail]: VTaskFail,\n\t\t[EnumTaskState.Rated]: VTaskRated,\n\t\t[EnumTaskState.Canceled]: VTaskCanceled,\n\t}\n\n\tgetView = (enumTaskState: EnumTaskState) => {\n\t\tlet TaskView = this.stateViews[enumTaskState];\n\t\tif (!TaskView) {\n\t\t\tTaskView = VTaskStart;\n\t\t}\n\t\treturn TaskView;\n\t}\n}\n","import React from \"react\";\r\nimport { Controller, View, Page } from \"tonva\";\r\nimport { observable } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\n\r\nexport interface EditTextItemProps {\r\n\tonUpdate: (inputContent: string) => Promise<void>;\r\n\tcontent: string;\r\n\theader: string;\r\n}\r\n\r\nexport class VEditTextItemInput<T extends Controller> extends View<T> {\r\n\t@observable private disabled: boolean;\r\n\tprivate inputText: string;\r\n\tprivate props: EditTextItemProps;\r\n\r\n\tconstructor(controller: T, props: EditTextItemProps) {\r\n\t\tsuper(controller);\r\n\t\tthis.props = props;\r\n\t\tthis.inputText = this.props.content;\r\n\t}\r\n\r\n\tonUpdate = () => {\r\n\t\tthis.disabled = true;\r\n\t\tthis.openPageElement(React.createElement(observer(() => {\r\n\t\t\tlet onClickSave = async () => {\r\n\t\t\t\tif (this.disabled === true) return;\r\n\t\t\t\tlet inputText = this.inputText.trim();\r\n\t\t\t\tawait this.props.onUpdate(inputText);\r\n\t\t\t\tthis.closePage();\r\n\t\t\t}\r\n\t\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\t\tif (evt.keyCode === 13) onClickSave();\r\n\t\t\t}\r\n\t\t\tlet onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\t\t\tthis.inputText = evt.target.value;\r\n\t\t\t\tthis.disabled = this.props.content === this.inputText;\r\n\t\t\t}\r\n\t\t\tlet right = <button className=\"btn btn-sm btn-success mr-2\"\r\n\t\t\t\tdisabled={this.disabled}\r\n\t\t\t\tonClick={onClickSave}>保存</button>;\r\n\t\t\treturn <Page header={this.props.header} back=\"close\" right={right}>\r\n\t\t\t\t<div className=\"p-3\">\r\n\t\t\t\t\t<input className=\"form-control\" type=\"text\"\r\n\t\t\t\t\t\tonChange={onInputChange} onKeyDown={onKeyDown}\r\n\t\t\t\t\t\tdefaultValue={this.props.content} />\r\n\t\t\t\t</div>\r\n\t\t\t</Page>;\r\n\t\t})));\r\n\t}\r\n\r\n\trender(props: EditTextItemProps): JSX.Element {\r\n\t\tthis.props = props;\r\n\t\tthis.inputText = this.props.content;\r\n\r\n\t\treturn <></>\r\n\t}\r\n}\r\n","import React from 'react';\nimport { VTaskView } from './VTaskView';\nimport { Page, FA } from 'tonva';\nimport { TaskCheckItem } from '../CTaskNoteItem';\nimport { VEditTextItemInput, EditTextItemProps } from '../VEditTextItem';\n\nexport class VCheckTask extends VTaskView {\n\tprotected get allowCheck() { return false; }\n\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待验收');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem, allowCheck: boolean) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\tlet onUpdate = async (v: string) => {\n\t\t\tawait this.controller.setCheckInfo(item, v);\n\t\t}\n\t\tlet eprops: EditTextItemProps = { onUpdate: onUpdate, content: checkInfo, header: '验收事项说明' }\n\t\tlet vEdit = new VEditTextItemInput(this.controller, eprops);\n\t\treturn <div key={key} className={'d-flex'}>\n\t\t\t<label className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-group form-check\">\n\t\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\t\tdefaultChecked={checked}\n\t\t\t\t\tdata-key={key}\n\t\t\t\t\tdisabled={!allowCheck} />\n\t\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t\t<span className=\"text-info cursor-ponter\" onClick={vEdit.onUpdate}>{checkInfo}</span>\n\t\t\t\t\t</div>}\n\t\t\t\t</div>\n\t\t\t</label>\n\t\t\t<div className=\"p-2 cursor-pointer\" onClick={vEdit.onUpdate}>\n\t\t\t\t<FA name=\"pencil-square-o text-info\" />\n\t\t\t</div>\n\t\t</div>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { checkInfo } = this.controller;\n\t\treturn <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t<div className=\"text-muted mr-1 w-5c\">验收意见</div>\n\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t</div>\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateCheckInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.CheckSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderBottomCommands() {\n\t\tlet left = <div>\n\t\t\t<button onClick={()=>this.onCheck(true)} className=\"btn btn-success mx-3\">\n\t\t\t\t<FA name=\"check\" /> 通过\n\t\t\t</button>\n\t\t\t<button onClick={() => this.onCheck(false)} className=\"btn btn-outline-secondary mx-3\">\n\t\t\t\t<FA name=\"times\" /> 不通过\n\t\t\t</button>\n\t\t</div>;\n\t\treturn <>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</>;\n\t}\n\n\tprotected onCheck = async (pass: boolean) => {\n\t\tawait this.controller.CheckTask(pass);\n\t\tthis.closePage();\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\tthis.showActionEndPage({ content });\n\t\t//this.openPage(this.resultPage, {pass})\n\t}\n\n\tprotected resultPage = ({ pass }: { pass: boolean }) => {\n\t\tlet { title } = this.controller;\n\t\tlet content = pass ?\n\t\t\t<span className=\"text-success\"><FA name=\"check\" /> 验收通过</span>\n\t\t\t:\n\t\t\t<span className=\"text-secondary\"><FA name=\"check\" /> 验收不通过</span>\n\t\treturn <Page header={title} back=\"close\">\n\t\t\t<div className=\"border bg-white rounded m-5\">\n\t\t\t\t<div className=\"py-5 text-center\">\n\t\t\t\t\t{content}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"border-top text-center py-3\">\n\t\t\t\t\t<button className=\"btn btn-outline-info\" onClick={() => this.closePage()}>返回</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Page>;\n\t}\n}","import React from 'react';\nimport { VTaskView } from './VTaskView';\nimport { Page, FA } from 'tonva';\nimport { TaskCheckItem } from '../CTaskNoteItem';\n\nexport class VRateTask extends VTaskView {\n\tprotected rateValue: number = 0;\n\n\tprotected get allowCheck() { return false; }\n\n\tprotected renderState(): JSX.Element {\n\t\treturn this.renderStateSpan('待评价');\n\t}\n\n\tprotected renderCheckItem(item: TaskCheckItem, allowCheck: boolean) {\n\t\tlet { key, text, checked, checkInfo } = item;\n\t\tlet cn = 'form-control-plaintext ml-3 ';\n\t\tlet content: any;\n\t\tif (checked === true) {\n\t\t\tcn += 'text-muted';\n\t\t\tcontent = <del>{text}</del>;\n\t\t}\n\t\telse {\n\t\t\tcontent = text;\n\t\t}\n\t\treturn <label key={key} className=\"flex-grow-1 d-flex mx-3 my-0 align-items-center form-group form-check\">\n\t\t\t<input className=\"form-check-input mr-3 mt-0\" type=\"checkbox\"\n\t\t\t\tdefaultChecked={checked}\n\t\t\t\tdata-key={key}\n\t\t\t\tdisabled={!allowCheck} />\n\t\t\t<div className=\"flex-grow-1\">\n\t\t\t\t<div className={cn}>{content}</div>\n\t\t\t\t{checkInfo && <div className=\"mt-1 ml-3 small\">\n\t\t\t\t\t<FA name=\"comment-o\" className=\"mr-2 text-primary\" />\n\t\t\t\t\t<span className=\"text-info cursor-ponter\" >{checkInfo}</span>\n\t\t\t\t</div>}\n\t\t\t</div>\n\t\t</label>;\n\t}\n\n\tprotected renderOrtherContent() {\n\t\tlet { checkInfo } = this.controller;\n\t\treturn <div className=\"px-3 py-2 d-flex align-items-center border-bottom\" >\n\t\t\t<div className=\"text-muted mr-1 w-5c\">评分意见</div>\n\t\t\t<div className=\"flex-fill mr-3 \">\n\t\t\t\t<input className=\"flex-fill form-control border-0\"\n\t\t\t\t\ttype=\"text\" step=\"1\" min=\"1\"\n\t\t\t\t\tdefaultValue={checkInfo}\n\t\t\t\t\tonChange={this.onDiscribeChange}\n\t\t\t\t\tonKeyDown={this.onDiscribeKeyDown} /></div>\n\t\t</div>\n\t}\n\n\tprivate onDiscribeChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tlet v = evt.target.value;\n\t\tif (v.length <= 0)\n\t\t\tv = undefined;\n\t\tthis.controller.updateRateInfo(v);\n\t}\n\n\tprivate onDiscribeKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\n\t\tif (evt.keyCode === 13) {\n\t\t\tthis.controller.CheckSaveInfo();\n\t\t}\n\t}\n\n\tprotected renderBottomCommands() {\n\t\tlet left: any, right: any;\n\t\tleft =\n\t\t\t<div><button onClick={() => this.onRate()} className=\"btn btn-success mx-3\">\n\t\t\t\t评价\n\t\t</button>\n\t\t\t</div>;\n\n\t\treturn <div>\n\t\t\t{this.renderOrtherContent()}\n\t\t\t{this.renderValueRadio()}\n\t\t\t<div className=\"py-2 bg-light border-top d-flex\">\n\t\t\t\t{left}\n\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t</div>\n\t\t</div>\n\t}\n\n\tprivate onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\n\t\tthis.rateValue = Number(evt.target.value);\n\t};\n\n\tprotected renderValueRadio(): JSX.Element {\n\t\tlet radios = [\n\t\t\t{ val: 2, text: '卓越' },\n\t\t\t{ val: 1, text: '谢谢' },\n\t\t];\n\n\t\treturn <div className=\"my-3\">\n\t\t\t{radios.map((v, index) => {\n\t\t\t\tlet { val, text } = v;\n\t\t\t\treturn <label key={index} className=\"mb-0 mx-3\">\n\t\t\t\t\t<input className=\"mr-1\" type=\"radio\" value={val}\n\t\t\t\t\t\tdefaultChecked={this.rateValue === val} name={'ratevalue'} onChange={this.onChange} />\n\t\t\t\t\t{text}\n\t\t\t\t</label>\n\t\t\t})}\n\t\t</div>;\n\t}\n\n\tprivate onRate = async () => {\n\t\tawait this.controller.RateTask(this.rateValue);\n\t\tthis.closePage();\n\t\tlet content = <>评价完成</>;\n\t\tthis.showActionEndPage({ content });\n\t}\n}","import React from 'react';\nimport { VBasePage } from './VBasePage';\n\nexport class VSent extends VBasePage {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {return '已发送'}\n\tcontent() {\n\t\treturn <div className=\"m-5 border rounded bg-white\">\n\t\t\t<div className=\"p-5 text-center border-bottom\">已发送</div>\n\t\t\t<div className=\"text-center py-3\">\n\t\t\t\t<button className=\"btn btn-outline-info\" onClick={()=>this.backPage()}>返回</button>\n\t\t\t</div>\n\t\t</div>;\n\t}\n}\n","import React from 'react';\nimport { CFolderNoteItem } from './CFolderNoteItem';\nimport { CNoteItem, VNoteView } from \"../item\";\nimport { List, FA } from 'tonva';\n\nexport class VFolder extends VNoteView<CFolderNoteItem> {\n\tafterBack() {\n\t\tthis.controller.owner.popFolder();\n\t}\n\theader() {\n\t\tlet {noteItem} = this.controller;\n\t\tif (noteItem) {\n\t\t\treturn noteItem.caption;\n\t\t}\n\t\treturn this.t('notes')\n\t}\n\n\tright() {\n\t\treturn <button onClick={()=>this.controller.owner.showAddNotePage(this.controller.folderId)} className=\"btn btn-success btn-sm mr-1\">\n\t\t\t<FA name=\"plus\" /> {this.t('notes')}\n\t\t</button>;\n\t}\n\n\tcontent() {\n\t\tlet {noteItem, notesPager} = this.controller;\n\t\tlet top:any;\n\t\tif (noteItem) {\n\t\t\tlet topContent: string;\n\t\t\tlet {content: contentString} = noteItem;\n\t\t\tlet json = JSON.parse(contentString);\n\t\t\tif (json) {\n\t\t\t\tlet {content} = json;\n\t\t\t\ttopContent = (content as string)?.trimEnd();\n\t\t\t}\n\t\t\telse {\n\t\t\t\ttopContent = \"整理小单\";\n\t\t\t}\n\t\t\ttop = <div className=\"d-flex mx-3 py-3\">\n\t\t\t\t<FA className=\"mr-3 text-warning\" name={noteItem.toCount > 0 ? \"folder-open\":\"folder\"} size=\"3x\" />\n\t\t\t\t<div className=\"small text-muted\">{this.renderParagraphs(topContent)}</div>\n\t\t\t</div>;\n\t\t}\n\t\treturn <div>\n\t\t\t{top}\n\t\t\t<List className=\"\" \n\t\t\t\titems={notesPager} \n\t\t\t\titem={{render: this.renderNote, key: this.noteKey, onClick: this.onNoteClick, className:'notes'}} />\n\t\t</div>\n\t}\n\n\trenderListView() {\n\t\treturn this.content();\n\t}\n\n\tprivate noteKey = (item: CNoteItem) => {\n\t\tlet note = item.noteItem.note;\n\t\treturn note;\n\t}\n\n\tprivate renderNote = (item: CNoteItem, index:number) => {\n\t\treturn <div className=\"d-block mb-2 bg-white\">{item.renderItem(index)}</div>;\n\t}\n\n\tprivate onNoteClick = async (item: CNoteItem) => {\n\t\tlet noteItem = item.noteItem;\n\t\tlet noteModel = await this.controller.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\titem.noteModel = noteModel;\n\t\treturn item.onClickItem(noteModel);\n\t}\n}\n","import React from 'react';\nimport { FA } from 'tonva';\nimport { CFolderNoteItem } from './CFolderNoteItem';\nimport { observer } from 'mobx-react';\nimport { VNoteBase } from '../item/VNoteBase';\n\nexport class VFolderNoteItem extends VNoteBase<CFolderNoteItem> {\n\trender() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {noteItem} = this.controller;\n\t\t\tlet divToCount = this.renderToCount();\n\n\t\t\treturn <div className=\"d-block bg-white\"> \n\t\t\t\t<div className=\"d-flex px-3 py-2 align-items-center\">\n\t\t\t\t\t<FA name={noteItem.toCount>0?\"folder-open\":\"folder\"} className=\"text-warning mr-3\" size=\"lg\" />\n\t\t\t\t\t<b className=\"text-primary\">{noteItem.caption}</b>\n\t\t\t\t\t<div className=\"ml-auto align-self-center\" \n\t\t\t\t\t\tonClick={(e)=>{e.stopPropagation(); this.controller.onClickEllipsis()}}>\n\t\t\t\t\t\t<FA name=\"ellipsis-h\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{ divToCount &&\n\t\t\t\t\t\t<div className=\"d-flex align-items-center px-3 mb-1\">\n\t\t\t\t\t\t\t{divToCount}\n\t\t\t\t\t\t\t<div className=\"mr-auto\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t</div>\n\t\t}));\n\t}\n}\n","import { tv } from \"tonva\";\r\nimport { VNoteForm } from '../item/VNoteForm';\r\nimport { CFolderNoteItem } from \"./CFolderNoteItem\";\r\n\r\nexport class VEdit extends VNoteForm<CFolderNoteItem> {\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\r\n\theader() {\r\n\t\treturn '编辑目录';\r\n\t}\r\n\tcontent() {\r\n\t\treturn this.renderEdit();\r\n\t}\r\n\r\n\tprotected getOptions(): {val:number, text:string}[] {\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\r\n\tprotected getSaveDisabled():boolean {\r\n\t\treturn (this.controller.title === undefined && this.controller.changedNoteContent === undefined);\r\n\t}\r\n\r\n\tprotected async onButtonSave(): Promise<void> {\r\n\t\tthis.checkInputAdd();\r\n\t\tawait this.controller.SetNote(true);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tprotected renderExButtons():JSX.Element {\r\n\t\treturn this.renderDeleteButton();\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport { CFolderNoteItem } from \"./CFolderNoteItem\";\r\nimport { VRelatives, RelativeKey } from '../item/VRelatives';\r\n\r\nexport class VFolderRelatives extends VRelatives<CFolderNoteItem> {\r\n\tconstructor(controller: CFolderNoteItem) {\r\n\t\tsuper(controller);\r\n\t\tthis.relativeCur = 'to';\r\n\t}\r\n\tprotected arr:RelativeKey[] = ['to', 'spawn', 'contain'];\r\n}","import React from 'react';\nimport { VEdit } from './VEdit';\nimport { observer } from 'mobx-react';\nimport { VNoteView, CheckItem } from '../item';\nimport { CFolderNoteItem } from './CFolderNoteItem';\nimport { VFolderRelatives } from './VFolderRelatives';\n\nexport class VFolderView extends VNoteView<CFolderNoteItem> {\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\n\theader() {\n\t\tlet {noteItem} = this.controller;\n\t\tif (noteItem) {\n\t\t\treturn noteItem.caption;\n\t\t}\n\t\treturn this.t('notes')\n\t}\n\n\tcontent() {\n\t\treturn React.createElement(observer(() => {\n\t\t\tlet {title} = this.controller;\n\t\t\treturn <div className=\"\">\n\t\t\t\t<div className=\"bg-white\">\n\t\t\t\t\t{this.renderTop()}\n\t\t\t\t\t{title && <div className=\"px-3 py-2 border-bottom\">\n\t\t\t\t\t\t<div><b>{title}</b></div>\n\t\t\t\t\t</div>}\n\t\t\t\t\t{this.renderContent()}\n\t\t\t\t</div>\n\t\t\t\t{this.renderBottomCommands()}\n\t\t\t\t{this.renderRelatives()}\n\t\t\t</div>;\n\t\t}));\n\t}\n\n\tprotected renderRelatives() {\n\t\treturn this.renderVm(VFolderRelatives);\n\t}\n\n\n\tprotected renderBottomCommands() {\n\t\tlet {owner} = this.controller.noteItem;\n\t\tlet isMe = this.isMe(owner);\n\t\tlet right:any;\n\t\tif (isMe === true) {\n\t\t\tright = <>\n\t\t\t\t{this.renderEditButton()}\t\t\t\t\n\t\t\t</>;\n\t\t}\n\t\treturn <div className=\"py-2 pl-3 bg-light border-top d-flex align-items-end\">\n\t\t\t{this.renderSendToButton()}\n\t\t\t<div className=\"mr-auto\" />\n\t\t\t{right}\n\t\t</div>;\n\t}\n\n\tprotected onEdit() {\n\t\tthis.openVPage(VEdit);\n\t}\n}\n","import { CNoteItem } from \"../item\";\nimport { NoteItem, NoteModel, EnumNoteItemType } from '../model';\nimport { QueryPager } from \"tonva\";\nimport { EnumSpecFolder } from \"tapp\";\nimport { VFolder } from \"./VFolder\"\nimport { VFolderNoteItem } from \"./VFolderNoteItem\";\nimport { VFolderView } from \"./VFolderView\";\n\n\nexport class CFolderNoteItem extends CNoteItem {\n\tfolderId: number;\n\tnotesPager: QueryPager<CNoteItem>;\n\n\tinit(param: NoteItem):void {\n\t\tsuper.init(param);\n\t\tif (param) {\n\t\t\tif (!this.title) this.title = param.caption;\n\t\t}\n\n\t\tlet folderId = this.noteItem?.note;\n\t\tif (!folderId) this.folderId = -EnumSpecFolder.notes;\n\t\telse this.folderId = folderId;\n\n\t\tthis.notesPager = new QueryPager<CNoteItem>(this.uqs.notes.GetNotes, undefined, undefined, true);\n\t\tthis.notesPager.setItemConverter(this.owner.noteItemConverter);\n\t}\n\n\tasync load() {\n\t\tawait this.notesPager.first({folderId: this.folderId});\n\t}\n\n\tasync refresh() {\n\t\t//每次刷新取5个。\n\t\tlet newnotes = new QueryPager<NoteItem>(this.uqs.notes.GetNotes, 5, 5, false);\n\t\tawait newnotes.first({folderId: this.folderId});\n\t\tlet newitems = newnotes.items;\n\t\tif (newitems) {\n\t\t\tlet len = newitems.length;\n\t\t\tlet items = this.notesPager.items;\n\t\t\tfor (let i = len - 1; i >= 0; --i) {\n\t\t\t\tlet item = newitems[i];\n\t\t\t\tlet note = item.note;\n\t\t\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\titems.splice(index, 1);\n\t\t\t\t}\n\t\t\t\tlet cNoteItem = this.owner.noteItemConverter(item, undefined);\n\t\t\t\titems.unshift(cNoteItem);\n\t\t\t}\n\t\t}\n\t}\n\n\tasync getNote(id: number): Promise<NoteModel> {\n\t\tlet folderId = this.owner.currentFoldItem?.folderId;\n\t\tlet ret = await this.uqs.notes.GetNote.query({folder: folderId, note: id});\n\t\tlet noteModel:NoteModel = ret.ret[0];\n\t\tnoteModel.to = ret.to;\n\t\tnoteModel.flow = ret.flow;\n\t\tnoteModel.spawn = ret.spawn;\n\t\tnoteModel.contain = ret.contain;\n\t\tnoteModel.comments = ret.comments;\n\t\treturn noteModel;\n\t}\n\n\tshowFolder() {\n\t\tthis.load();\n\t\tthis.openVPage(VFolder);\n\t}\n\n\trenderListView() {\n\t\treturn (new VFolder(this)).renderListView();\n\t}\n\n\tonClickItem(noteModel: NoteModel): void {\n\t\tthis.owner.openFolder(this);\n\t}\n\n\tasync onClickEllipsis() {\n\t\tlet noteItem = this.noteItem;\n\t\tif (!noteItem)\n\t\t\treturn;\n\t\tlet noteModel = await this.getNote(noteItem.note);\n\t\tnoteItem.unread = 0;\n\t\tthis.noteModel = noteModel;\n\t\tthis.openVPage(VFolderView);\n\t}\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type:EnumNoteItemType) {\n\t\tlet sub = 0;\n\t\tlet ret = await this.uqs.notes.AddNote.submit({parent:folder, caption, content, type, sub});\n\t\tlet {note} = ret;\n\t\tlet date = new Date();\n\t\tlet noteItem:NoteItem = {\n\t\t\tseconds: undefined,\n\t\t\towner: this.user.id,\n\t\t\tnote: note as number,\n\t\t\ttype: type,\n\t\t\tcaption,\n\t\t\tcontent,\n\t\t\tassigned: undefined,\n\t\t\tfrom: undefined,\n\t\t\tfromAssigned: undefined,\n\t\t\tstate: undefined,\n\t\t\tunread: 0,\n\t\t\tobj,\n\t\t\t$create: date,\n\t\t\t$update: date,\n\t\t}\n\t\tlet cNoteItem = this.owner.getCNoteItem(type);\n\t\tcNoteItem.init(noteItem);\n\t\tif (folder === this.folderId) {\n\t\t\tthis.notesPager.items.unshift(cNoteItem);\n\t\t}\n\t\treturn cNoteItem;\n\t}\n\n\tasync setNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\tlet {SetNote, Note} = this.uqs.notes;\n\t\tlet {note, type} = noteItem;\n\t\tawait SetNote.submit({note, caption, content, type}, waiting);\n\t\t// Note.resetCache(note); 现在不调用NoteTuid的cache，所以不需要了\n\t\t// noteItem.unread = 1; 自己修改自己的小单，只是移到最前面，并不显示unread\n\t\tlet {items} = this.notesPager;\n\t\tlet index = items.findIndex(v => v.noteItem.note===note);\n\t\tif (index >= 0) {\n\t\t\tlet theItems = items.splice(index, 1);\n\t\t\tlet theItem = theItems[0];\n\t\t\ttheItem.noteItem.caption = caption;\n\t\t\ttheItem.noteItem.content = content;\n\t\t\ttheItem.noteItem.obj = obj;\n\t\t\titems.unshift(theItem);\n\t\t}\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.uqs.notes.HideNote.submit({note, x});\n\t\tlet index = this.notesPager.items.findIndex(v => v.noteItem.note === note);\n\t\tif (index >= 0) this.notesPager.items.splice(index, 1);\n\t}\n\n\trenderItem(index: number): JSX.Element {\n\t\tlet vNoteItem = new VFolderNoteItem(this);\n\t\treturn vNoteItem.render();\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { VSelectContact, SelectContactOptions } from \"./views\";\nimport { CTextNoteItem } from \"./text\";\nimport { EnumNoteItemType, NoteItem, NoteModel } from \"./model\";\nimport { CNoteItem } from \"./item/CNoteItem\";\nimport { VTo } from \"./views/VTo\";\nimport { CTaskNoteItem, EnumTaskState } from \"./task/CTaskNoteItem\";\nimport { Contact } from \"model\";\nimport { observable } from \"mobx\";\nimport { VSent } from \"./views/VSent\";\nimport { CFolderNoteItem } from \"./folder\";\n\nconst cNoteItems: {[key in EnumNoteItemType]: new (...args: any[])=> CNoteItem} = {\n\t[EnumNoteItemType.text]: CTextNoteItem,\n\t[EnumNoteItemType.task]: CTaskNoteItem,\n\t[EnumNoteItemType.folder]: CFolderNoteItem,\n};\n\nexport class CNote extends CUqBase {\n\tprotected foldItemStack: CFolderNoteItem[];\n\tcurrentFoldItem: CFolderNoteItem;\n\n\t@observable contacts: Contact[];\n\tnoteItem: NoteItem;\n\n    protected async internalStart() {\n\t}\n\n\tinit(folderId?: number) {\n\t\tthis.currentFoldItem = this.newSub(CFolderNoteItem);\n\t\tthis.foldItemStack = [];\n\t}\n\n\tnoteItemConverter = (item:NoteItem, queryResults:{[name:string]:any[]}):CNoteItem => {\n\t\tlet cNoteItem = this.getCNoteItem(item.type);\n\t\titem = cNoteItem.convertObj(item);\n\t\tcNoteItem.init(item);\n\t\treturn cNoteItem;\n\t}\n\n\tget items() {\n\t\treturn this.currentFoldItem.notesPager;\n\t}\n\n\topenFolder(foldItem:CFolderNoteItem) {\n\t\tthis.foldItemStack.push(this.currentFoldItem);\n\t\tthis.currentFoldItem = foldItem;\n\t\tthis.currentFoldItem.showFolder();\n\t}\n\n\tpopFolder() {\n\t\tthis.currentFoldItem = this.foldItemStack.pop();\n\t}\n\n\tgetCNoteItem(type: EnumNoteItemType): CNoteItem {\n\t\tlet ret = cNoteItems[type];\n\t\tif (ret === undefined) {\n\t\t\tdebugger;\n\t\t\tthrow new Error(`type ${type} CNoteItem not defined`);\n\t\t}\n\t\treturn this.newSub(ret);\n\t}\n\n\tasync load() {\n\t\tawait this.currentFoldItem.load();\n\t}\n\n\tasync refresh() {\n\t\tawait this.currentFoldItem.refresh();\n\t}\n\n\tasync getNote(id: number): Promise<NoteModel> {\n\t\treturn await this.currentFoldItem.getNote(id);\n\t}\n\n\tasync addNote(folder:number, caption:string, content:string, obj:any, type: EnumNoteItemType) {\n\t\treturn await this.currentFoldItem.addNote(folder, caption, content, obj, type);\n\t}\n\n\tasync setNote(waiting:boolean, noteItem:NoteItem, caption:string, content:string, obj:any) {\n\t\treturn await this.currentFoldItem.setNote(waiting, noteItem, caption, content, obj);\n\t}\n\n\tasync sendNoteTo(note:number, toList:number[]) {\n\t\tlet tos = toList.join('|');\n\t\tawait this.uqs.notes.SendNoteTo.submit({note, tos});\n\t}\n\n\tasync hideNote(note:number, x:number) {\n\t\tawait this.currentFoldItem.hideNote(note, x);\n\t}\n\n\trenderListView() {\n\t\treturn this.currentFoldItem.renderListView();\n\t}\n\n\tshowAddNotePage = (parent: number) => {\n\t\tlet cTextNoteItem = this.newSub(CTextNoteItem);\n\t\tcTextNoteItem.showAddNotePage(parent);\n\t}\n\n\tshowTo(noteItem:NoteItem, backPageCount:Number) {\n\t\tthis.noteItem = noteItem;\n\t\tthis.openVPage(VTo, backPageCount);\n\t}\n\n\tshowSentPage() {\n\t\tthis.openVPage(VSent);\n\t}\n\n\tasync callSelectContact(options: SelectContactOptions): Promise<Contact[]> {\n\t\treturn await this.vCall(VSelectContact, options);\n\t}\n\n\tshowAssignTaskPage() {\n\t\tlet cTaskNoteItem = this.newSub(CTaskNoteItem);\n\t\tcTaskNoteItem.init(this.noteItem);\n\t\tcTaskNoteItem.showAssignTaskPage();\n\t}\n}\n","import React from 'react';\nimport { CHome } from './CHome';\nimport { VPage, Page, FA } from 'tonva';\n//import { notesName } from '../note';\n\nexport class VHome extends VPage<CHome> {\n\trender() {\n\t\tlet {cNode} = this.controller;\n\t\tlet right = <button onClick={()=>cNode.showAddNotePage(cNode.currentFoldItem.folderId)} className=\"btn btn-success btn-sm mr-1\">\n\t\t\t<FA name=\"plus\" /> {this.t('notes')}\n\t\t</button>;\n\t\treturn <Page header={this.t('home')} right={right}>\n\t\t\t{cNode.renderListView()}\n\t\t</Page>;\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { CNote } from \"../note\";\nimport { VHome } from \"./VHome\";\n\nexport class CHome extends CUqBase {\n\tcNode: CNote;\n\n  \tprotected async internalStart() {\n\t}\n\n\tasync refresh() {\n\t\tawait this.cNode.refresh();\n\t}\n\n\tinit() {\n\t\tthis.cNode = this.newC(CNote);\n\t}\n\n\ttab = () => this.renderView(VHome);\n\n\tasync load() {\n\t\tawait this.cNode.load();\n\t}\n}\n","import React from \"react\";\nimport { CRelation } from \"./CRelation\";\nimport { VPage, SearchBox, userApi, Image, FA, Muted } from \"tonva\";\nimport { observable } from \"mobx\";\nimport { observer } from \"mobx-react\";\n\nexport class VAdd extends VPage<CRelation> {\n\t@observable private hasError = false;\n\t@observable private user:{id:number, name:string, nick:string, icon:string};\n\n\theader() {\n\t\treturn <div className=\"w-100 mr-1 d-flex\">\n\t\t\t<SearchBox className=\"flex-fill\" \n\t\t\t\tonSearch={this.onSearch} \n\t\t\t\tonFocus={this.onFocus}\n\t\t\t\tplaceholder=\"搜索联系人\" />\n\t\t\t<button className=\"btn btn-sm btn-outline-info ml-1\" onClick={()=>this.closePage()}>取消</button>\n\t\t</div>;\n\t}\n\n\tprivate onSearch = async (key:string) => {\n\t\tthis.user = await userApi.fromKey(key);\n\t\tif (!this.user) {\n\t\t\tthis.hasError = true;\n\t\t\treturn;\n\t\t}\n\t}\n\n\tprivate onFocus = () => {\n\t\tthis.hasError = false;\n\t}\n\n\tprivate onAddContact = async () => {\n\t\tawait this.controller.AddContact(this.user.id);\n\t\tthis.closePage();\n\t}\n\n\tcontent() {\n\t\tlet c = observer(() => {\n\t\t\tif (this.hasError === true) {\n\t\t\t\treturn <div className=\"p-4\">\n\t\t\t\t\t<FA className=\"text-danger mr-2\" name=\"times-circle\" />\n\t\t\t\t\t<Muted>账号不存在或者不接受邀请</Muted>\n\t\t\t\t</div>\n\t\t\t}\n\t\t\tif (!this.user) return;\n\n\t\t\tlet {name, nick, icon} = this.user;\n\t\t\tlet div:any;\n\t\t\tif (nick) {\n\t\t\t\tdiv =  <div>\n\t\t\t\t\t<div><b>{nick}</b></div>\n\t\t\t\t\t<div>{name}</div>\n\t\t\t\t</div>;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tdiv = <div><b>{name}</b></div>\n\t\t\t}\n\t\t\treturn <div className=\"my-3 mx-3 border rounded\">\n\t\t\t\t<div className=\"p-4 d-flex bg-white rounded-top\">\n\t\t\t\t\t<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t\t{div}\n\t\t\t\t</div>\n\t\t\t\t<div className=\"py-3 px-4\">\n\t\t\t\t\t<button className=\"btn btn-primary\" onClick={this.onAddContact}>增加</button>\n\t\t\t\t</div>\n\t\t\t</div>;\n\t\t});\n\t\treturn React.createElement(c);\n\t}\n}","import React from 'react';\nimport { CRelation } from './CRelation';\nimport { VPage, FA, List, UserView, User, Image } from 'tonva';\nimport { VAdd } from './VAdd';\nimport { Contact } from 'model';\n\nexport class VRelation extends VPage<CRelation> {\n\theader() {return this.t('relation')}\n\n\tright() {\n\t\treturn <button className=\"btn btn-sm btn-primary mr-1\" onClick={()=>this.openVPage(VAdd)}>\n\t\t\t<FA name=\"user-plus\" />\n\t\t</button>;\n\t}\n\n\tcontent() {\n\t\treturn <div className=\"\">\n\t\t\t<List items={this.controller.contacts} item={{render: this.renderContact}} />\n\t\t</div>\n\t}\n\n\tprivate renderContact = (item:Contact, index:number) => {\n\t\tlet {contact, assigned} = item;\n\t\tlet renderUser = (user:User) => {\n\t\t\tlet {name, nick, icon} = user;\n\t\t\treturn <div className=\"px-3 py-2 cursor-pointer\" onClick={()=>this.controller.onShowContact(item)}>\n\t\t\t\t<Image className=\"w-2c h-2c mr-3\" src={icon || '.user-o'} />\n\t\t\t\t{assigned || nick || name}\n\t\t\t</div>\n\t\t}\n\t\treturn <UserView user={contact} render={renderUser} />;\n\t}\n}\n","import React from \"react\";\r\nimport { CContact } from \"./CContact\";\r\nimport { VPage, UserView, Image, FA, Muted, User } from \"tonva\";\r\nimport { observer } from \"mobx-react\";\r\n\r\nexport class VContact extends VPage<CContact> {\r\n\r\n\tinit(param:any) {\r\n\t}\r\n\r\n\theader() {\r\n\t\treturn ' ';\r\n\t}\r\n\r\n\tprivate onEditAlias = () => {\r\n\t\tthis.controller.onEditAssigned();\r\n\t}\r\n\r\n\tcontent() {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {id, name, nick, icon} = user;\r\n\t\t\tlet { assigned } = this.controller.contact;\r\n\t\t\treturn <div className=\"p-3 d-flex\">\r\n\t\t\t\t<Image className=\"w-3c h-3c mr-4\" src={icon || '.user-o'} />\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<div className=\"h6\"><b>{assigned || nick || name}</b></div>\r\n\t\t\t\t\t<div><Muted>id: </Muted>{id}</div>\r\n\t\t\t\t\t<div><Muted>用户名: </Muted>{name}</div>\r\n\t\t\t\t\t{nick && <div><Muted>别名: </Muted>{nick}</div>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t}\r\n\t\tlet { contact } = this.controller.contact;\r\n\t\tlet cn = 'px-3 py-2 bg-white d-flex align-items-center border-bottom cursor-pointer';\r\n\t\treturn <div>\r\n\t\t\t<UserView user={contact as number} render={renderUser} />\r\n\t\t\t{\r\n\t\t\t\tReact.createElement(observer(() =>\r\n\t\t\t\t<div className={cn}  onClick={this.onEditAlias}>\r\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\r\n\t\t\t\t\t<div className=\"flex-fill w-100 border-0 form-control mr-auto\">{this.controller.contact.assigned || <Muted>[无]</Muted>}</div>\r\n\t\t\t\t\t<FA name=\"angle-right\" />\r\n\t\t\t\t</div>))\r\n\t\t\t}\r\n\t\t</div>;\r\n\t}\r\n}","import React from \"react\";\r\nimport { CContact } from \"./CContact\";\r\nimport { VPage, UserView, Image, FA, Muted, User, Page } from \"tonva\";\r\nimport { observable, computed } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\n\r\nexport class VEditAssigned extends VPage<CContact> {\r\n\t@observable private assigned:string;\r\n\r\n\tinit(param?:any) {\r\n\t\tthis.assigned = this.controller.contact?.assigned;\r\n\t}\r\n\r\n\t@computed protected get btnSaveDisabled():boolean {\r\n\t\treturn this.assigned === this.controller.contact.assigned;\r\n\t}\r\n\r\n\theader() {\r\n\t\treturn '编辑';\r\n\t}\r\n\r\n\tright():JSX.Element {\r\n\t\treturn React.createElement(observer(() => <>\r\n\t\t\t<button onClick={() => this.onButtonSave()}\r\n\t\t\t\tclassName=\"btn btn-sm btn-success mr-1\" disabled={this.btnSaveDisabled}>\r\n\t\t\t\t保存\r\n\t\t\t</button>\r\n\t\t</>));\r\n\t}\r\n\r\n\tprotected onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tthis.assigned = evt.target.value.trim();\r\n\t}\r\n\r\n\tprivate onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\tif (evt.keyCode === 13) {\r\n\t\t\tif (!this.btnSaveDisabled) {\r\n\t\t\t\tthis.onButtonSave();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tprotected async onButtonSave(): Promise<void> {\r\n\t\tthis.controller.SaveContactAssign(this.assigned);\r\n\t\tthis.closePage();\r\n\t}\r\n\r\n\tcontent() {\r\n\t\treturn <div className=\"border rounded\">\r\n\t\t\t<div className=\"bg-white\">\r\n\t\t\t\t<div className=\"px-3 py-2 bg-white d-flex align-items-center border-bottom\">\r\n\t\t\t\t\t<div className=\"text-muted mr-3 w-4c\">备注名</div>\r\n\t\t\t\t\t<input type=\"text\" className=\"flex-fill w-100 border-0 form-control\" maxLength={80}\r\n\t\t\t\t\t\tautoFocus={true}\r\n\t\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\t\tonKeyDown={this.onKeyDown}\r\n\t\t\t\t\t\tdefaultValue={this.assigned} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t}\r\n}","import { CUqSub } from \"tapp\"\r\nimport { observable } from \"mobx\";\r\nimport { Contact } from \"model\";\r\nimport { CRelation } from \"../CRelation\";\r\nimport { VContact } from \"./VContact\";\r\nimport { VEditAssigned } from \"./VEditAssigned\";\r\n\r\nexport class CContact extends CUqSub<CRelation> {\r\n\tprotected async internalStart() {}\r\n\t@observable contact: Contact;\r\n\r\n\tinit(param:Contact):void {\r\n\t\tthis.contact = {...param};\r\n\t}\r\n\r\n\tasync SaveContactAssign(value:string) {\r\n\t\tawait this.owner.SaveContactAssign(this.contact, value);\r\n\t\tthis.contact.assigned = value;\r\n\t}\r\n\r\n\tasync showContact() {\r\n\t\tthis.openVPage(VContact);\r\n\t}\r\n\r\n\tasync onEditAssigned() {\r\n\t\tthis.openVPage(VEditAssigned);\r\n\t}\r\n}","import { CUqBase } from \"tapp\";\nimport { VRelation } from \"./VRelation\";\nimport { observable } from \"mobx\";\nimport { Contact } from \"model\";\nimport { CContact } from \"./contact\";\n\nexport class CRelation extends CUqBase {\n\tprivate loaded: boolean = false;\n\t@observable contacts: Contact[] = [];\n\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VRelation);\n\n\tload = async () => {\n\t\tif (this.loaded === true) return;\n\t\tlet ret = await this.uqs.notes.GetMyContacts.page({}, 0, 500, true);\n\t\tthis.contacts.push(...ret['$page']);\n\t\tthis.loaded = true;\n\t}\n\n\tasync AddContact(contact: number) {\n\t\tawait this.uqs.notes.AddContact.submit({contact});\n\t\tthis.contacts.unshift({contact, assigned:undefined});\n\t}\n\n\tasync onShowContact(item:Contact) {\n\t\tlet cc = this.newSub(CContact, item);\n\t\tcc.showContact();\n\t}\n\n\tasync SaveContactAssign(item:Contact, value:string) {\n\t\tlet param = {contact:item.contact, assigned:value};\n\t\tawait this.uqs.notes.SetContactAssinged.submit(param);\n\t\tlet c = this.contacts.find(v=>v.contact === item.contact);\n\t\tif (c !== undefined) {\n\t\t\tc.assigned = value;\n\t\t}\n\t}\n}\n","import * as React from 'react';\nimport { observable } from 'mobx';\nimport {\n    userApi, ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\n    Edit, UiSchema, VPage\n} from 'tonva';\nimport { CMe } from './CMe';\n\nexport class VEditMe extends VPage<CMe>{\n\n    async open(param: any) {\n        this.openPage(this.page);\n    }\n\n    private schema: ItemSchema[] = [\n        { name: 'nick', type: 'string' } as StringSchema,\n        { name: 'icon', type: 'image' } as ImageSchema,\n    ];\n    private uiSchema: UiSchema = {\n        items: {\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\n        }\n    }\n    @observable private data: any;\n\n    constructor(props: any) {\n        super(props);\n        let { nick, icon } = nav.user;\n        this.data = {\n            nick: nick,\n            icon: icon,\n        };\n\n        let { cApp } = this.controller;\n    }\n\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\n        let { name } = itemSchema;\n        await userApi.userSetProp(name, newValue);\n        this.data[name] = newValue;\n        nav.user.name = newValue;\n        nav.saveLocalUser();\n    }\n\n\n    private page = () => {\n        let { schema, uiSchema, data, onItemChanged } = this;\n        return <Page header=\"个人信息\">\n            <Edit schema={schema} uiSchema={uiSchema}\n                data={data}\n                onItemChanged={onItemChanged} />\n        </Page>;\n    }\n}\n\nexport const webUserSchema: ItemSchema[] = [\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\n    { name: 'gender', type: 'string' } as StringSchema,\n    { name: 'salutation', type: 'string' } as StringSchema,\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\n    { name: 'departmentName', type: 'string' } as StringSchema,\n];\n\n","import React from 'react';\nimport { CMe } from './CMe';\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva';\nimport { observer } from 'mobx-react';\nimport { VEditMe } from './VEditMe';\nimport { appConfig } from 'tapp';\n\nexport class VMe extends VPage<CMe> {\n\theader() {return this.t('me')}\n\n\tcontent() {\n        const { user } = nav;\n        let aboutRows: Prop[] = [\n            '',\n            {\n                type: 'component',\n                component: <div className=\"w-100 d-flex justify-content-between\">\n                    <IconText iconClass=\"text-info mr-2\" icon=\"smile-o\" text={this.t('aboutTheApp')} />\n                    <div className=\"py-2 small\">V{appConfig.version}</div>\n                </div>,\n            }\n        ];\n\n        let rows: Prop[];\n        if (user === undefined) {\n            rows = aboutRows;\n            rows.push(\n                {\n                    type: 'component',\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.showLogin(undefined, true)}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\n                    </button>\n                },\n            );\n        }\n        else {\n            let logOutRows: Prop[] = [\n                '',\n                {\n                    type: 'component',\n                    bk: '',\n                    component: <button className=\"btn btn-danger w-100\" onClick={this.onExit}>\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\n                </button>\n                },\n            ];\n\n            rows = [\n                '',\n                {\n                    type: 'component',\n                    component: <this.meInfo />\n                },\n                '',\n                {\n                    type: 'component',\n                    component: <IconText iconClass=\"text-info mr-2\" icon=\"key\" text={this.t('changePassword')} />,\n                    onClick: this.changePassword\n                },\n            ]\n            rows.push(...aboutRows, ...logOutRows);\n        }\n        return <PropGrid rows={[...rows]} values={{}} />;\n\t}\n\n\tprivate onExit = () => {\n        nav.showLogout();\n    }\n\n    private changePassword = async () => {\n        await nav.changePassword();\n    }\n\n    private meInfo = observer(() => {\n        let { user } = nav;\n        if (user === undefined) return null;\n        let { id, name, nick, icon } = user;\n        return <LMR className=\"py-2 cursor-pointer w-100\"\n            left={<Image className=\"w-3c h-3c mr-3\" src={icon || '.user-o'} />}\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\n            onClick={() => {\n                this.openVPage(VEditMe);\n            }}>\n            <div>\n                <div>{userSpan(name, nick)}</div>\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\n            </div>\n        </LMR>;\n    });\n}\n\nfunction userSpan(name: string, nick: string): JSX.Element {\n    return nick ?\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\n        : <b>{name}</b>\n}\n","import { CUqBase } from \"tapp\";\nimport { VMe } from \"./VMe\";\n\nexport class CMe extends CUqBase {\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VMe);\n\n}\n","import { Tuid, Query, Action/*, Map, Sheet, Tag*/ } from \"tonva\";\n\nexport enum EnumSpecFolder {notes=1};\n\nexport interface Notes {\n\tNote: Tuid;\n\n\tAddNote: Action;\n\tSetNote: Action;\n\tSetNoteX: Action;\n\tSendNoteTo: Action;\n\tHideNote: Action;\n\tAddContact: Action;\n\tSetContactAssinged: Action;\n\tAssignTask: Action;\n\n\tDoneTask: Action;\n\tCheckTask: Action;\n\tRateTask: Action;\n\n\tAddComment: Action;\n\n\t$Poked: Query;\n\tGetNotes: Query;\n\tGetMyContacts: Query;\n\tGetNote: Query;\n};\n\nexport interface UQs {\n    notes: Notes\n}\n","import React from 'react';\nimport { CDiscover } from './CDiscover';\nimport { VPage, LMR, FA } from 'tonva';\n\ninterface Item {\n\ticon: string;\n\tcaption: string;\n\tonClick: () => void;\n}\n\nexport class VDiscover extends VPage<CDiscover> {\n\tprivate onTaskReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate onOtherReport = () => {\n\t\talert('实现中');\n\t}\n\n\tprivate items:(Item|string)[] = [\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t\t'-',\n\t\t{icon: undefined, caption: '任务报表', onClick: this.onTaskReport}, \n\t\t{icon: undefined, caption: '其它报表', onClick: this.onOtherReport}, \n\t];\n\n\theader() {return this.t('discover')}\n\tcontent() {\n\t\tlet cn = 'px-3 py-2 cursor-pointer bg-white mb-1';\n\t\tlet right = <FA name=\"angle-right\" />;\n\t\treturn <div className=\"py-3\">\n\t\t\t{this.items.map((v, index) => {\n\t\t\t\tif (typeof v === 'string') {\n\t\t\t\t\treturn <div key={index} className=\"pt-2\" />;\n\t\t\t\t}\n\t\t\t\tlet {icon, caption, onClick} = v;\n\t\t\t\tlet left = <FA name={icon} />;\n\t\t\t\treturn <LMR key={index} className={cn} onClick={onClick} left={left} right={right}>\n\t\t\t\t\t{caption}\n\t\t\t\t</LMR>\n\t\t\t})}\n\t\t</div>;\n\t}\n}\n","import { CUqBase } from \"tapp\";\nimport { VDiscover } from \"./VDiscover\";\n\nexport class CDiscover extends CUqBase {\n    protected async internalStart() {\n\t}\n\n\ttab = () => this.renderView(VDiscover);\n\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"tonva\";\n\nexport class VTestMe extends VPage<CApp> {\n\theader() {return 'VTestMe'}\n\tcontent() {\n\t\treturn <div>VTestMe</div>;\n\t}\n}\n","import React from 'react';\nimport { CApp } from \"./CApp\";\nimport { VPage } from \"tonva\";\nimport { VTestMe } from './VTestMe';\n\nexport class VTestAB extends VPage<CApp> {\n\theader() {return 'VTestAB'}\n\tcontent() {\n\t\treturn <div>\n\t\t\tVTestAB\n\t\t\t<button onClick={()=>this.go(()=>this.openVPage(VTestMe), '/bbbb/cccc')}>To Me</button>\n\t\t</div>;\n\t}\n}\n","import { zh } from \"./zh\";\nimport { en } from \"./en\";\n\nexport const res = {\n\t$zh: zh,\n\t$en: en,\n}\n","export const zh = {\n\thome: '首页',\n\trelation: '关系',\n\tdiscover: '发现',\n\tme: '我',\n\n\tchangePassword: '修改密码',\n\taboutTheApp: '关于本APP',\n\tlogout: '退出登录',\n\n\tnotes: '小单',\n\t\n}\n","export const en = {\n\thome: 'Home',\n\trelation: 'Relation',\n\tdiscover: 'Discover',\n\tme: 'Me',\n\n\tchangePassword: 'Change password',\n\taboutTheApp: 'About the APP',\n\tlogout: 'Logout',\n\tpleaseLogin: 'Login',\n\n\tnotes: 'Notes',\n\t\n}\n","import { CUqApp } from \"./CBase\";\nimport { VMain } from \"./main\";\nimport { CHome } from \"home\";\nimport { CRelation } from \"relation\";\nimport { CMe } from \"me\";\nimport { CDiscover } from \"discover\";\nimport { computed } from \"mobx\";\nimport { Contact } from \"model\";\nimport { nav } from \"tonva\";\nimport { VTestMe } from \"./VTestMe\";\nimport { VTestAB } from \"./VTestAB\";\nimport { res } from \"./res\";\n\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\n\nexport class CApp extends CUqApp {\n\tcHome: CHome;\n\tcRelation: CRelation;\n\tcDiscover: CDiscover;\n\tcMe: CMe;\n\n\tprotected async internalStart() {\n\t\tthis.setRes(res);\n\t\tif (nav.isInAppRouting) return;\n\t\tawait this.startHome();\n\t}\n\n\tprotected async startHome() {\n\t\tthis.cHome = this.newC(CHome);\n\t\tthis.cRelation = this.newC(CRelation);\n\t\tthis.cDiscover = this.newC(CDiscover);\n\t\tthis.cMe = this.newC(CMe);\n\t\tthis.cHome.load();\n\t\tthis.showMain();\n\n\t\tsetInterval(this.callTick, 1000);\n\t}\n\n\tprotected async startMe() {\n\t\tthis.openVPage(VTestMe);\n\t}\n\n\tprotected async startAB() {\n\t\tthis.openVPage(VTestAB);\n\t}\n\n\tprotected onRoute() {\n\t\tthis.on({\n\t\t\t'/a/b': () => {\n\t\t\t\t// renderDom(<div>/a/b <button onClick={()=>nav.navigate('/c/d')}>test</button></div>)\n\t\t\t\tthis.startAB();\n\t\t\t},\n\t\t\t'/c/d': () => {\n\t\t\t\t/*\n\t\t\t\trenderDom(<div>\n\t\t\t\t\t/c/d\n\t\t\t\t\t<button onClick={()=>nav.navigate('/eeee/a/1?c=1 & d=3')}>test</button>\n\t\t\t\t</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/eeee/:action/:id': (params:any, queryStr:any) => {\n\t\t\t\t/*\n\t\t\t\tlet span:any;\n\t\t\t\tif (queryStr) {\n\t\t\t\t\tspan = <span>{queryStr}</span>\n\t\t\t\t}\n\t\t\t\trenderDom(<div>/e query:{span}  params:{JSON.stringify(params)}</div>)\n\t\t\t\t*/\n\t\t\t},\n\t\t\t'/bbbb/cccc': () => {\n\t\t\t\t//renderCApp(new CAppBBBBCCCC());\n\t\t\t\tthis.startMe();\n\t\t\t},\n\t\t});\n\t\tthis.on(() => {\n\t\t\t//renderCApp(new CApp());\n\t\t\tthis.startHome();\n\t\t});\n\t}\n\n\n\t@computed get contacts(): Contact[] {return this.cRelation.contacts;};\n\n\tasync loadRelation() {\n\t\tawait this.cRelation.load();\n\t}\n\n    private showMain(initTabName?: string) {\n        this.openVPage(VMain, initTabName);\n\t}\n\n\tprivate tick = 0;\n\tprivate gapIndex = 0;\n\tprivate callTick = async () => {\n\t\ttry {\n\t\t\tif (!this.user) return;\n\t\t\t++this.tick;\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\n\t\t\t//console.error('tick ', new Date());\n\t\t\tthis.tick = 0;\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\n\t\t\tlet ret = await this.uqs.notes.$Poked.query(undefined, false);\n\t\t\tlet v = ret.ret[0];\n\t\t\tif (v === undefined) return;\n\t\t\tif (!v.poke) return;\n\t\t\tthis.gapIndex = 1;\n\n\t\t\t// uq 里面加入这一句，会让相应的$Poked查询返回poke=1：\n\t\t\t// TUID [$User] ID (member) SET poke=1;\n\t\t\t// 这个地方重新调入的数据\n\t\t\tthis.cHome.refresh();\n\t\t}\n\t\tcatch {\n\t\t}\n\t}\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport './index.css';\n//import App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nimport { NavView, start, startRoute, nav, CAppBase } from 'tonva';\n//import logo from './logo.svg';\nimport './App.css';\nimport { CApp, appConfig } from './tapp';\nimport { CAppAB, CAppCD, CAppBBBBCCCC } from 'tapp/CAppAB';\n\n/*\nlet {location} = document;\nif (location.host) {\n\t(async function() {\n\t\tfunction renderDom(div:any) {\n\t\t\tReactDOM.render(\n\t\t\t\t<React.StrictMode>\n\t\t\t\t\t{div}\n\t\t\t\t</React.StrictMode>,\n\t\t\t\tdocument.getElementById('root')\n\t\t\t);\n\t\t}\n\n\t\tfunction renderCApp(cApp: CAppBase) {\n\t\t\tconst App: React.FC = () => {\n\t\t\t\tconst onLogined = async () => {\n\t\t\t\t\tawait cApp.start();\n\t\t\t\t}\n\t\t\t\treturn <NavView onLogined={onLogined} />;\n\t\t\t}\n\t\t\trenderDom(<App/>);\n\t\t}\n\n\t\tnav.on({\n\t\t\t'/a/b': () => {\n\t\t\t\trenderDom(<div>/a/b <button onClick={()=>nav.navigate('/c/d')}>test</button></div>)\n\t\t\t},\n\t\t\t'/c/d': () => {\n\t\t\t\trenderDom(<div>\n\t\t\t\t\t/c/d\n\t\t\t\t\t<button onClick={()=>nav.navigate('/eeee/a/1?c=1 & d=3')}>test</button>\n\t\t\t\t</div>)\n\t\t\t},\n\t\t\t'/eeee/:action/:id': (params:any, queryStr:any) => {\n\t\t\t\tlet span:any;\n\t\t\t\tif (queryStr) {\n\t\t\t\t\tspan = <span>{queryStr}</span>\n\t\t\t\t}\n\t\t\t\trenderDom(<div>/e query:{span}  params:{JSON.stringify(params)}</div>)\n\t\t\t},\n\t\t\t'/bbbb/cccc': () => {\n\t\t\t\trenderCApp(new CAppBBBBCCCC());\n\t\t\t},\n\t\t});\n\t\tnav.on(() => {\n\t\t\trenderCApp(new CApp());\n\t\t});\n\t\tawait startRoute(appConfig);\n\n\t\t// If you want your app to work offline and load faster, you can change\n\t\t// unregister() to register() below. Note this comes with some pitfalls.\n\t\t// Learn more about service workers: https://bit.ly/CRA-PWA\n\t\tserviceWorker.unregister();\n\t})();\n}\nelse {\n*/\n\t(async function() {\n\t\tnav.setSettings(appConfig);\n\t\tconst App: React.FC = () => {\n\t\t\tconst onLogined = async () => {\n\t\t\t\tawait start(CApp, appConfig);\n\t\t\t}\n\t\t\treturn <NavView onLogined={onLogined} />;\n\t\t}\n\n\t\tReactDOM.render(\n\t\t<React.StrictMode>\n\t\t\t<App />\n\t\t</React.StrictMode>,\n\t\tdocument.getElementById('root')\n\t\t);\n\n\t\t// If you want your app to work offline and load faster, you can change\n\t\t// unregister() to register() below. Note this comes with some pitfalls.\n\t\t// Learn more about service workers: https://bit.ly/CRA-PWA\n\t\tserviceWorker.unregister();\n\t})();\n//}"],"sourceRoot":""}